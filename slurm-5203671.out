Container llamafactory already exists.

=============
== PyTorch ==
=============

NVIDIA Release 24.07 (build 100464919)
PyTorch Version 2.4.0a0+3bcc3cd
Container image Copyright (c) 2024, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
Copyright (c) 2014-2024 Facebook Inc.
Copyright (c) 2011-2014 Idiap Research Institute (Ronan Collobert)
Copyright (c) 2012-2014 Deepmind Technologies    (Koray Kavukcuoglu)
Copyright (c) 2011-2012 NEC Laboratories America (Koray Kavukcuoglu)
Copyright (c) 2011-2013 NYU                      (Clement Farabet)
Copyright (c) 2006-2010 NEC Laboratories America (Ronan Collobert, Leon Bottou, Iain Melvin, Jason Weston)
Copyright (c) 2006      Idiap Research Institute (Samy Bengio)
Copyright (c) 2001-2004 Idiap Research Institute (Ronan Collobert, Samy Bengio, Johnny Mariethoz)
Copyright (c) 2015      Google Inc.
Copyright (c) 2015      Yangqing Jia
Copyright (c) 2013-2016 The Caffe contributors
All rights reserved.

Various files include modifications (c) NVIDIA CORPORATION & AFFILIATES.  All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

ERROR: This container was built for NVIDIA Driver Release 555.42 or later, but
       version 535.247.01 was detected and compatibility mode is UNAVAILABLE.

       [[]]

NOTE: Mellanox network driver detected, but NVIDIA peer memory driver not
      detected.  Multi-node communication performance may be reduced.

File descriptor limit set to: 8192
Mon Jun 30 22:40:31 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.247.01             Driver Version: 535.247.01   CUDA Version: 12.5     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-40GB          On  | 00000000:B7:00.0 Off |                    0 |
| N/A   34C    P0              55W / 400W |      0MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Checkpoint directory: saves/qwen2_vl-3b/vindr_sft_base
Output directory: ./evaluate_outputs/train_results/vinder_adkg_test/vindr_sft_base/qwen2_vl-3b
Processing model: qwen2_vl-3b
Debugging file descriptor limits:
=== File Descriptor Limit Debug ===
Python version: 3.11.8 (main, Feb 26 2024, 21:39:34) [GCC 11.2.0]
Process ID: 369424

1. Current limits:
File descriptor limits:
  Soft limit: 8192
  Hard limit: 8192
  Currently open files: 4

2. System limits:
System-wide file handles:
  Allocated: 8192
  Unused: 0
  Maximum: 9223372036854775807

3. Trying to increase limit:
Soft limit 8192 is already at or above target 8192

4. Final limits:
File descriptor limits:
  Soft limit: 8192
  Hard limit: 8192
  Currently open files: 4
Running inference on checkpoint: checkpoint-126
INFO 06-30 22:40:39 [__init__.py:239] Automatically detected platform cuda.
[INFO|training_args.py:2135] 2025-06-30 22:40:41,504 >> PyTorch: setting up devices
[INFO|training_args.py:1812] 2025-06-30 22:40:41,561 >> The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,577 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,577 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,578 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,578 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,578 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,578 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,578 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:40:41,970 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:378] 2025-06-30 22:40:41,971 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126/preprocessor_config.json
[INFO|image_processing_base.py:378] 2025-06-30 22:40:41,976 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:40:41,982 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,983 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,983 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,983 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,983 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,983 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,983 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:41,983 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:40:42,352 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 22:40:42,354 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 22:40:42,575 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 22:40:43,044 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}

[INFO|configuration_utils.py:696] 2025-06-30 22:40:43,091 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126/config.json
[INFO|configuration_utils.py:696] 2025-06-30 22:40:43,091 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126/config.json
[INFO|configuration_utils.py:770] 2025-06-30 22:40:43,093 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "text_config": {
    "architectures": [
      "Qwen2VLForConditionalGeneration"
    ],
    "attention_dropout": 0.0,
    "bos_token_id": 151643,
    "eos_token_id": 151645,
    "hidden_act": "silu",
    "hidden_size": 1536,
    "image_token_id": null,
    "initializer_range": 0.02,
    "intermediate_size": 8960,
    "max_position_embeddings": 32768,
    "max_window_layers": 28,
    "model_type": "qwen2_vl_text",
    "num_attention_heads": 12,
    "num_hidden_layers": 28,
    "num_key_value_heads": 2,
    "rms_norm_eps": 1e-06,
    "rope_scaling": {
      "mrope_section": [
        16,
        24,
        24
      ],
      "rope_type": "default",
      "type": "default"
    },
    "rope_theta": 1000000.0,
    "sliding_window": 32768,
    "tie_word_embeddings": true,
    "torch_dtype": "float32",
    "use_cache": false,
    "use_sliding_window": false,
    "video_token_id": null,
    "vision_end_token_id": 151653,
    "vision_start_token_id": 151652,
    "vision_token_id": 151654,
    "vocab_size": 151936
  },
  "torch_dtype": "bfloat16",
  "transformers_version": "4.52.4",
  "use_cache": false,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "depth": 32,
    "embed_dim": 1280,
    "hidden_act": "quick_gelu",
    "hidden_size": 1536,
    "in_channels": 3,
    "in_chans": 3,
    "initializer_range": 0.02,
    "mlp_ratio": 4,
    "model_type": "qwen2_vl",
    "num_heads": 16,
    "patch_size": 14,
    "spatial_merge_size": 2,
    "spatial_patch_size": 14,
    "temporal_patch_size": 2,
    "torch_dtype": "float32"
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 151936
}

INFO 06-30 22:40:54 [config.py:689] This model supports multiple tasks: {'score', 'classify', 'generate', 'embed', 'reward'}. Defaulting to 'generate'.
INFO 06-30 22:40:54 [config.py:1901] Chunked prefill is enabled with max_num_batched_tokens=8192.
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:55,900 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:55,901 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:55,901 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:55,901 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:55,901 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:55,901 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:40:55,901 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:40:56,256 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:1088] 2025-06-30 22:40:56,359 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126/generation_config.json
[INFO|configuration_utils.py:1135] 2025-06-30 22:40:56,362 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

WARNING 06-30 22:40:56 [utils.py:2304] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/getting_started/troubleshooting.html#python-multiprocessing for more information. Reason: CUDA is initialized
INFO 06-30 22:41:04 [__init__.py:239] Automatically detected platform cuda.
INFO 06-30 22:41:07 [core.py:61] Initializing a V1 LLM engine (v0.8.4) with config: model='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126', speculative_config=None, tokenizer='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-30 22:41:07 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fc69c0cb9d0>
INFO 06-30 22:41:08 [parallel_state.py:959] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-30 22:41:08 [cuda.py:221] Using Flash Attention backend on V1 engine.
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:41:11 [gpu_model_runner.py:1276] Starting to load model saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126...
WARNING 06-30 22:41:11 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-30 22:41:11 [config.py:3466] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
WARNING 06-30 22:41:11 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.64s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.64s/it]

INFO 06-30 22:41:14 [loader.py:458] Loading weights took 2.86 seconds
INFO 06-30 22:41:14 [gpu_model_runner.py:1291] Model loading took 4.1513 GiB and 3.108506 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:41:15 [gpu_model_runner.py:1560] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-30 22:41:30 [backends.py:416] Using cache directory: /root/.cache/vllm/torch_compile_cache/746c31169e/rank_0_0 for vLLM's torch.compile
INFO 06-30 22:41:30 [backends.py:426] Dynamo bytecode transform time: 7.65 s
INFO 06-30 22:41:30 [backends.py:115] Directly load the compiled graph for shape None from the cache
INFO 06-30 22:41:37 [monitor.py:33] torch.compile takes 7.65 s in total
INFO 06-30 22:41:38 [kv_cache_utils.py:634] GPU KV cache size: 1,006,016 tokens
INFO 06-30 22:41:38 [kv_cache_utils.py:637] Maximum concurrency for 6,144 tokens per request: 163.74x
INFO 06-30 22:41:58 [gpu_model_runner.py:1626] Graph capturing finished in 20 secs, took 0.47 GiB
INFO 06-30 22:41:58 [core.py:163] init engine (profile, create kv cache, warmup model) took 43.53 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:41:59 [core_client.py:435] Core engine process 0 ready.
[INFO|2025-06-30 22:41:59] llamafactory.data.loader:143 >> Loading dataset ./0_my_dataset/vindr/qwen2_vindr_input_test_len_2108.json...
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151653, 198, 5598, 30618, 14697, 315, 364, 47, 811, 372, 8767, 269, 706, 6, 5671, 438, 4718, 3561, 510, 73594, 2236, 198, 9640, 4913, 58456, 62, 17, 67, 788, 508, 87, 16, 11, 379, 16, 11, 856, 17, 11, 379, 17, 1125, 330, 1502, 788, 330, 1502, 7115, 9338, 921, 73594, 151645, 198, 151644, 77091, 198]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|vision_end|>
Return bounding boxes of 'Pneumothorax' areas as JSON format:
```json
[
{"bbox_2d": [x1, y1, x2, y2], "label": "label"},
...
]
```<|im_end|>
<|im_start|>assistant

label_ids:
[27, 9217, 397, 9640, 220, 341, 262, 330, 58456, 62, 17, 67, 788, 2278, 414, 220, 16, 22, 20, 345, 414, 220, 17, 22, 24, 345, 414, 220, 18, 15, 17, 345, 414, 220, 21, 23, 16, 198, 262, 3211, 262, 330, 1502, 788, 330, 47, 811, 372, 8767, 269, 706, 698, 220, 456, 921, 522, 9217, 29, 151645, 198]
labels:
<answer>
[
  {
    "bbox_2d": [
      175,
      279,
      302,
      681
    ],
    "label": "Pneumothorax"
  }
]
</answer><|im_end|>

Current file descriptor limits: soft=8192, hard=8192
Initial resource status:
Open files: 0
Memory usage: 951.02 MB
Using effective batch size: 16
Processing batched inference:   0%|          | 0/132 [00:00<?, ?it/s][INFO|image_processing_base.py:378] 2025-06-30 22:42:00,703 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:42:00,704 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|image_processing_base.py:378] 2025-06-30 22:42:00,705 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:42:00,705 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:42:00,705 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:42:00,706 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:42:00,706 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:42:00,706 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:42:00,706 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:42:00,706 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:42:00,706 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:42:01,519 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 22:42:01,520 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 22:42:01,521 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 22:42:02,007 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: CachedQwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-126', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='left', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}


Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:01<00:17,  1.14s/it, est. speed input: 341.40 toks/s, output: 47.27 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.03it/s, est. speed input: 4535.18 toks/s, output: 692.06 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 11.53it/s, est. speed input: 4535.18 toks/s, output: 692.06 toks/s]
Processing batched inference:   1%|          | 1/132 [00:04<09:05,  4.17s/it]Resource status after batch 0:
Open files: 0
Memory usage: 1093.07 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 87.76it/s, est. speed input: 34446.70 toks/s, output: 5609.80 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.05it/s, est. speed input: 16912.79 toks/s, output: 2815.11 toks/s]
Processing batched inference:   2%|▏         | 2/132 [00:06<06:55,  3.20s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 70.79it/s, est. speed input: 27778.62 toks/s, output: 4341.96 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 37.53it/s, est. speed input: 14741.64 toks/s, output: 2348.57 toks/s]
Processing batched inference:   2%|▏         | 3/132 [00:09<06:19,  2.94s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 83.55it/s, est. speed input: 32817.02 toks/s, output: 5818.44 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.89it/s, est. speed input: 17240.27 toks/s, output: 3015.03 toks/s]
Processing batched inference:   3%|▎         | 4/132 [00:12<06:05,  2.85s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 52.23it/s, est. speed input: 20540.54 toks/s, output: 3273.05 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 37.97it/s, est. speed input: 15690.48 toks/s, output: 2401.55 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 37.13it/s, est. speed input: 14581.31 toks/s, output: 2323.00 toks/s]
Processing batched inference:   4%|▍         | 5/132 [00:14<05:32,  2.62s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 83.61it/s, est. speed input: 32884.83 toks/s, output: 5469.90 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.08it/s, est. speed input: 16945.53 toks/s, output: 2857.73 toks/s]
Processing batched inference:   5%|▍         | 6/132 [00:16<05:34,  2.65s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 92.47it/s, est. speed input: 36244.51 toks/s, output: 5811.45 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.32it/s, est. speed input: 11880.66 toks/s, output: 1948.16 toks/s]
Processing batched inference:   5%|▌         | 7/132 [00:19<05:35,  2.69s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 90.97it/s, est. speed input: 35745.44 toks/s, output: 5171.69 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.34it/s, est. speed input: 17033.76 toks/s, output: 2468.15 toks/s]
Processing batched inference:   6%|▌         | 8/132 [00:22<05:18,  2.57s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 105.13it/s, est. speed input: 41295.22 toks/s, output: 6413.43 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.81it/s, est. speed input: 10919.41 toks/s, output: 1903.59 toks/s] 
Processing batched inference:   7%|▋         | 9/132 [00:24<05:22,  2.62s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 44.22it/s, est. speed input: 17362.68 toks/s, output: 2927.27 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 27.37it/s, est. speed input: 11396.26 toks/s, output: 1910.43 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 23.98it/s, est. speed input: 10092.51 toks/s, output: 1692.89 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.10it/s, est. speed input: 9073.94 toks/s, output: 1581.12 toks/s] 
Processing batched inference:   8%|▊         | 10/132 [00:27<05:19,  2.62s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 89.79it/s, est. speed input: 35202.89 toks/s, output: 5339.44 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.10it/s, est. speed input: 16898.13 toks/s, output: 2535.17 toks/s]
Processing batched inference:   8%|▊         | 11/132 [00:29<05:08,  2.55s/it]Resource status after batch 10:
Open files: 0
Memory usage: 2342.92 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 74.67it/s, est. speed input: 29322.16 toks/s, output: 4229.22 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.32it/s, est. speed input: 15834.33 toks/s, output: 2396.97 toks/s]
Processing batched inference:   9%|▉         | 12/132 [00:32<04:59,  2.50s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 101.99it/s, est. speed input: 40076.09 toks/s, output: 6512.16 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.83it/s, est. speed input: 17216.16 toks/s, output: 2736.85 toks/s] 
Processing batched inference:  10%|▉         | 13/132 [00:34<04:56,  2.49s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 94.62it/s, est. speed input: 37123.74 toks/s, output: 5677.62 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.39it/s, est. speed input: 12712.15 toks/s, output: 2109.53 toks/s]
Processing batched inference:  11%|█         | 14/132 [00:37<05:09,  2.62s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 87.74it/s, est. speed input: 34449.91 toks/s, output: 5905.47 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.15it/s, est. speed input: 16953.89 toks/s, output: 2826.91 toks/s]
Processing batched inference:  11%|█▏        | 15/132 [00:39<04:53,  2.51s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 85.85it/s, est. speed input: 33778.09 toks/s, output: 5351.91 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.81it/s, est. speed input: 16817.31 toks/s, output: 2791.11 toks/s]
Processing batched inference:  12%|█▏        | 16/132 [00:42<04:51,  2.51s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 83.61it/s, est. speed input: 32807.05 toks/s, output: 5128.16 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.81it/s, est. speed input: 16800.37 toks/s, output: 2654.57 toks/s]
Processing batched inference:  13%|█▎        | 17/132 [00:44<04:44,  2.47s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 62.93it/s, est. speed input: 24721.78 toks/s, output: 3573.30 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.08it/s, est. speed input: 9316.81 toks/s, output: 1470.90 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.71it/s, est. speed input: 9316.81 toks/s, output: 1470.90 toks/s]
Processing batched inference:  14%|█▎        | 18/132 [00:46<04:29,  2.36s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 92.72it/s, est. speed input: 36413.29 toks/s, output: 5577.46 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.42it/s, est. speed input: 17448.89 toks/s, output: 2646.12 toks/s]
Processing batched inference:  14%|█▍        | 19/132 [00:49<04:34,  2.43s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 40.84it/s, est. speed input: 16052.84 toks/s, output: 2321.12 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 43.91it/s, est. speed input: 17040.48 toks/s, output: 2831.43 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.60it/s, est. speed input: 9483.57 toks/s, output: 1644.23 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.15it/s, est. speed input: 9483.57 toks/s, output: 1644.23 toks/s]
Processing batched inference:  15%|█▌        | 20/132 [00:51<04:25,  2.37s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 95.05it/s, est. speed input: 37272.46 toks/s, output: 6017.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.96it/s, est. speed input: 13701.28 toks/s, output: 2257.26 toks/s]
Processing batched inference:  16%|█▌        | 21/132 [00:54<04:35,  2.48s/it]Resource status after batch 20:
Open files: 0
Memory usage: 3489.11 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 94.47it/s, est. speed input: 37115.23 toks/s, output: 5754.94 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.01it/s, est. speed input: 17285.63 toks/s, output: 2753.84 toks/s]
Processing batched inference:  17%|█▋        | 22/132 [00:56<04:33,  2.49s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 70.91it/s, est. speed input: 27817.02 toks/s, output: 4280.23 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.88it/s, est. speed input: 16453.16 toks/s, output: 2753.88 toks/s]
Processing batched inference:  17%|█▋        | 23/132 [00:59<04:22,  2.41s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 84.79it/s, est. speed input: 33357.90 toks/s, output: 4861.40 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.88it/s, est. speed input: 17244.89 toks/s, output: 2619.43 toks/s]
Processing batched inference:  18%|█▊        | 24/132 [01:01<04:15,  2.37s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 36.05it/s, est. speed input: 14180.38 toks/s, output: 2066.83 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 29.10it/s, est. speed input: 11845.04 toks/s, output: 1998.72 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 27.39it/s, est. speed input: 11262.81 toks/s, output: 1838.88 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.43it/s, est. speed input: 8677.90 toks/s, output: 1525.85 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.07it/s, est. speed input: 8677.90 toks/s, output: 1525.85 toks/s]
Processing batched inference:  19%|█▉        | 25/132 [01:03<04:18,  2.42s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 71.19it/s, est. speed input: 27932.29 toks/s, output: 4291.22 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.75it/s, est. speed input: 16785.91 toks/s, output: 2538.38 toks/s]
Processing batched inference:  20%|█▉        | 26/132 [01:06<04:08,  2.34s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 32.53it/s, est. speed input: 12789.30 toks/s, output: 1854.58 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 25.70it/s, est. speed input: 10429.73 toks/s, output: 1512.65 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 31.67it/s, est. speed input: 12029.29 toks/s, output: 2179.16 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.06it/s, est. speed input: 11790.79 toks/s, output: 2295.74 toks/s]
Processing batched inference:  20%|██        | 27/132 [01:08<03:53,  2.23s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 56.23it/s, est. speed input: 22071.79 toks/s, output: 3176.84 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.15it/s, est. speed input: 9802.83 toks/s, output: 1546.31 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.98it/s, est. speed input: 9802.83 toks/s, output: 1546.31 toks/s]
Processing batched inference:  21%|██        | 28/132 [01:10<03:59,  2.30s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 52.90it/s, est. speed input: 20770.43 toks/s, output: 2992.85 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 42.12it/s, est. speed input: 17102.01 toks/s, output: 2777.63 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.02it/s, est. speed input: 10218.15 toks/s, output: 1850.97 toks/s]
Processing batched inference:  22%|██▏       | 29/132 [01:12<03:53,  2.27s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 67.02it/s, est. speed input: 26311.26 toks/s, output: 4125.45 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.08it/s, est. speed input: 11006.42 toks/s, output: 1826.47 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.99it/s, est. speed input: 11006.42 toks/s, output: 1826.47 toks/s]
Processing batched inference:  23%|██▎       | 30/132 [01:14<03:51,  2.27s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 32.91it/s, est. speed input: 12935.21 toks/s, output: 2122.82 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 31.83it/s, est. speed input: 12593.14 toks/s, output: 1978.71 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 28.64it/s, est. speed input: 11627.77 toks/s, output: 1960.60 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.21it/s, est. speed input: 10688.65 toks/s, output: 1858.78 toks/s]
Processing batched inference:  23%|██▎       | 31/132 [01:17<03:51,  2.30s/it]Resource status after batch 30:
Open files: 0
Memory usage: 4448.98 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 65.82it/s, est. speed input: 25861.56 toks/s, output: 3744.32 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.37it/s, est. speed input: 10306.00 toks/s, output: 1648.80 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.22it/s, est. speed input: 10306.00 toks/s, output: 1648.80 toks/s]
Processing batched inference:  24%|██▍       | 32/132 [01:19<03:58,  2.38s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 14.00it/s, est. speed input: 5497.59 toks/s, output: 794.29 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 13.26it/s, est. speed input: 5262.85 toks/s, output: 759.47 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 34.72it/s, est. speed input: 10706.77 toks/s, output: 1633.60 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.66it/s, est. speed input: 7726.17 toks/s, output: 1236.45 toks/s] 
Processing batched inference:  25%|██▌       | 33/132 [01:22<03:47,  2.30s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 54.12it/s, est. speed input: 21230.15 toks/s, output: 3040.02 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 25.58it/s, est. speed input: 10905.71 toks/s, output: 1573.78 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.36it/s, est. speed input: 11509.00 toks/s, output: 1828.94 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.26it/s, est. speed input: 11509.00 toks/s, output: 1828.94 toks/s]
Processing batched inference:  26%|██▌       | 34/132 [01:24<03:37,  2.22s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 39.27it/s, est. speed input: 15441.59 toks/s, output: 2244.27 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 40.95it/s, est. speed input: 15968.93 toks/s, output: 2310.21 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.74it/s, est. speed input: 13242.13 toks/s, output: 1999.24 toks/s]
Processing batched inference:  27%|██▋       | 35/132 [01:26<03:30,  2.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 66.72it/s, est. speed input: 26224.59 toks/s, output: 4232.07 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 37.68it/s, est. speed input: 15828.99 toks/s, output: 2542.53 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.99it/s, est. speed input: 16492.15 toks/s, output: 2619.14 toks/s]
Processing batched inference:  27%|██▋       | 36/132 [01:28<03:27,  2.16s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 62.84it/s, est. speed input: 24675.43 toks/s, output: 3558.40 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 33.40it/s, est. speed input: 14171.74 toks/s, output: 2149.28 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 37.03it/s, est. speed input: 14532.34 toks/s, output: 2296.22 toks/s]
Processing batched inference:  28%|██▊       | 37/132 [01:30<03:25,  2.16s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 71.91it/s, est. speed input: 28307.17 toks/s, output: 4139.21 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.16it/s, est. speed input: 15793.31 toks/s, output: 2296.93 toks/s]
Processing batched inference:  29%|██▉       | 38/132 [01:32<03:23,  2.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 68.50it/s, est. speed input: 26916.21 toks/s, output: 3890.84 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.42it/s, est. speed input: 14322.30 toks/s, output: 2190.35 toks/s]
Processing batched inference:  30%|██▉       | 39/132 [01:34<03:12,  2.07s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.86it/s, est. speed input: 1513.59 toks/s, output: 216.21 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 30.82it/s, est. speed input: 9809.18 toks/s, output: 1408.36 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.64it/s, est. speed input: 11634.11 toks/s, output: 1773.31 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.61it/s, est. speed input: 11634.11 toks/s, output: 1773.31 toks/s]
Processing batched inference:  30%|███       | 40/132 [01:36<03:00,  1.96s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 33.97it/s, est. speed input: 13354.33 toks/s, output: 1936.51 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 27.90it/s, est. speed input: 11253.73 toks/s, output: 1781.17 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.86it/s, est. speed input: 12610.83 toks/s, output: 1920.43 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.69it/s, est. speed input: 14409.17 toks/s, output: 2183.23 toks/s]
Processing batched inference:  31%|███       | 41/132 [01:37<02:53,  1.91s/it]Resource status after batch 40:
Open files: 0
Memory usage: 5327.40 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 73.43it/s, est. speed input: 28882.42 toks/s, output: 4204.28 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.73it/s, est. speed input: 11189.43 toks/s, output: 1936.73 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.45it/s, est. speed input: 11189.43 toks/s, output: 1936.73 toks/s]
Processing batched inference:  32%|███▏      | 42/132 [01:40<03:03,  2.04s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 86.22it/s, est. speed input: 33870.58 toks/s, output: 5319.81 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.85it/s, est. speed input: 17203.42 toks/s, output: 2847.81 toks/s]
Processing batched inference:  33%|███▎      | 43/132 [01:42<03:01,  2.04s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 28.80it/s, est. speed input: 11325.98 toks/s, output: 1646.71 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 26.18it/s, est. speed input: 10453.37 toks/s, output: 1642.72 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.67it/s, est. speed input: 10817.97 toks/s, output: 1978.12 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.47it/s, est. speed input: 10817.97 toks/s, output: 1978.12 toks/s]
Processing batched inference:  33%|███▎      | 44/132 [01:44<02:57,  2.02s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 15.96it/s, est. speed input: 6261.59 toks/s, output: 899.02 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 43.49it/s, est. speed input: 15137.73 toks/s, output: 2198.12 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.54it/s, est. speed input: 13178.66 toks/s, output: 2103.03 toks/s]
Processing batched inference:  34%|███▍      | 45/132 [01:46<02:50,  1.96s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 33.65it/s, est. speed input: 13226.62 toks/s, output: 1918.10 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 27.23it/s, est. speed input: 11000.36 toks/s, output: 1738.04 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 38.69it/s, est. speed input: 14134.11 toks/s, output: 2389.91 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.47it/s, est. speed input: 9988.27 toks/s, output: 1794.16 toks/s] 
Processing batched inference:  35%|███▍      | 46/132 [01:47<02:47,  1.94s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.41it/s, est. speed input: 1340.60 toks/s, output: 194.43 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:01, 11.32it/s, est. speed input: 3786.65 toks/s, output: 547.11 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.86it/s, est. speed input: 9757.79 toks/s, output: 1548.35 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.84it/s, est. speed input: 9757.79 toks/s, output: 1548.35 toks/s]
Processing batched inference:  36%|███▌      | 47/132 [01:49<02:41,  1.90s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 78.32it/s, est. speed input: 30735.63 toks/s, output: 4412.39 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.52it/s, est. speed input: 11583.99 toks/s, output: 1919.24 toks/s]
Processing batched inference:  36%|███▋      | 48/132 [01:51<02:45,  1.97s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.04it/s, est. speed input: 2360.40 toks/s, output: 332.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 15.57it/s, est. speed input: 5465.69 toks/s, output: 786.74 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 27.83it/s, est. speed input: 9139.10 toks/s, output: 1317.52 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 28.14it/s, est. speed input: 9560.52 toks/s, output: 1554.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.87it/s, est. speed input: 10152.34 toks/s, output: 1835.40 toks/s]
Processing batched inference:  37%|███▋      | 49/132 [01:53<02:39,  1.92s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 57.10it/s, est. speed input: 22443.43 toks/s, output: 3254.67 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 60.47it/s, est. speed input: 23579.79 toks/s, output: 3412.44 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.76it/s, est. speed input: 16800.60 toks/s, output: 2429.78 toks/s]
Processing batched inference:  38%|███▊      | 50/132 [01:55<02:35,  1.90s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.09it/s, est. speed input: 1600.80 toks/s, output: 225.16 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 49.81it/s, est. speed input: 15802.13 toks/s, output: 2296.74 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.43it/s, est. speed input: 15115.64 toks/s, output: 2200.51 toks/s]
Processing batched inference:  39%|███▊      | 51/132 [01:57<02:23,  1.77s/it]Resource status after batch 50:
Open files: 0
Memory usage: 6060.46 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 35.42it/s, est. speed input: 13880.42 toks/s, output: 2295.40 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 36.22it/s, est. speed input: 14161.71 toks/s, output: 2194.73 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.81it/s, est. speed input: 13218.28 toks/s, output: 2136.88 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.58it/s, est. speed input: 13193.22 toks/s, output: 2210.00 toks/s]
Processing batched inference:  39%|███▉      | 52/132 [01:59<02:29,  1.87s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.44it/s, est. speed input: 1751.21 toks/s, output: 257.77 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  8.70it/s, est. speed input: 3118.04 toks/s, output: 449.94 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 26.62it/s, est. speed input: 8626.39 toks/s, output: 1307.04 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.05it/s, est. speed input: 8655.99 toks/s, output: 1376.70 toks/s]
Processing batched inference:  40%|████      | 53/132 [02:00<02:25,  1.84s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01,  8.49it/s, est. speed input: 3331.71 toks/s, output: 479.53 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 23.33it/s, est. speed input: 8104.83 toks/s, output: 1175.43 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 22.78it/s, est. speed input: 8228.60 toks/s, output: 1188.52 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.18it/s, est. speed input: 8295.13 toks/s, output: 1312.71 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.12it/s, est. speed input: 8295.13 toks/s, output: 1312.71 toks/s]
Processing batched inference:  41%|████      | 54/132 [02:02<02:24,  1.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  8.06it/s, est. speed input: 3176.88 toks/s, output: 467.59 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 15.18it/s, est. speed input: 5659.26 toks/s, output: 815.82 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 29.23it/s, est. speed input: 9646.55 toks/s, output: 1495.70 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 29.63it/s, est. speed input: 10162.46 toks/s, output: 1633.06 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.08it/s, est. speed input: 9065.10 toks/s, output: 1509.14 toks/s] 
Processing batched inference:  42%|████▏     | 55/132 [02:04<02:24,  1.87s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.73it/s, est. speed input: 2652.25 toks/s, output: 390.40 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 22.64it/s, est. speed input: 7801.63 toks/s, output: 1138.26 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 49.78it/s, est. speed input: 15555.34 toks/s, output: 2383.27 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.11it/s, est. speed input: 10650.05 toks/s, output: 1696.18 toks/s]
Processing batched inference:  42%|████▏     | 56/132 [02:06<02:23,  1.89s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:08,  1.78it/s, est. speed input: 696.17 toks/s, output: 97.92 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 21.13it/s, est. speed input: 6818.26 toks/s, output: 1042.63 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s, est. speed input: 7226.56 toks/s, output: 1158.81 toks/s]
Processing batched inference:  43%|████▎     | 57/132 [02:08<02:11,  1.75s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 27.99it/s, est. speed input: 10996.84 toks/s, output: 1864.40 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 28.22it/s, est. speed input: 11072.79 toks/s, output: 1756.67 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.05it/s, est. speed input: 9125.93 toks/s, output: 1528.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.22it/s, est. speed input: 9125.93 toks/s, output: 1528.68 toks/s]
Processing batched inference:  44%|████▍     | 58/132 [02:10<02:20,  1.89s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.30it/s, est. speed input: 2066.04 toks/s, output: 286.02 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 27.32it/s, est. speed input: 9266.11 toks/s, output: 1323.68 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 35.38it/s, est. speed input: 12080.18 toks/s, output: 1820.54 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.78it/s, est. speed input: 12080.18 toks/s, output: 1820.54 toks/s]
Processing batched inference:  45%|████▍     | 59/132 [02:11<02:12,  1.81s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.42it/s, est. speed input: 1337.69 toks/s, output: 188.16 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 24.14it/s, est. speed input: 7743.55 toks/s, output: 1133.55 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 26.90it/s, est. speed input: 9157.21 toks/s, output: 1400.65 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.42it/s, est. speed input: 8810.15 toks/s, output: 1402.70 toks/s]
Processing batched inference:  45%|████▌     | 60/132 [02:13<02:07,  1.77s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.37it/s, est. speed input: 931.90 toks/s, output: 137.18 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 19.22it/s, est. speed input: 5942.34 toks/s, output: 843.73 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.01it/s, est. speed input: 8450.20 toks/s, output: 1270.99 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.53it/s, est. speed input: 8450.20 toks/s, output: 1270.99 toks/s]
Processing batched inference:  46%|████▌     | 61/132 [02:15<02:05,  1.76s/it]Resource status after batch 60:
Open files: 0
Memory usage: 6601.57 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.49it/s, est. speed input: 1754.50 toks/s, output: 246.78 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 20.50it/s, est. speed input: 6977.34 toks/s, output: 1003.23 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 38.41it/s, est. speed input: 11884.47 toks/s, output: 1798.98 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.28it/s, est. speed input: 12676.63 toks/s, output: 1915.58 toks/s]
Processing batched inference:  47%|████▋     | 62/132 [02:16<01:59,  1.70s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.67it/s, est. speed input: 1832.53 toks/s, output: 261.76 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 41.93it/s, est. speed input: 13509.55 toks/s, output: 1935.23 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.94it/s, est. speed input: 10562.82 toks/s, output: 1665.57 toks/s]
Processing batched inference:  48%|████▊     | 63/132 [02:18<01:57,  1.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.46it/s, est. speed input: 1358.24 toks/s, output: 194.02 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 36.02it/s, est. speed input: 11453.37 toks/s, output: 1652.76 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.33it/s, est. speed input: 10342.11 toks/s, output: 1729.68 toks/s]
Processing batched inference:  48%|████▊     | 64/132 [02:20<01:55,  1.70s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 18.41it/s, est. speed input: 7234.49 toks/s, output: 1049.17 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 27.43it/s, est. speed input: 10276.27 toks/s, output: 1490.37 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 41.18it/s, est. speed input: 14450.26 toks/s, output: 2218.18 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.34it/s, est. speed input: 9175.40 toks/s, output: 1469.12 toks/s] 
Processing batched inference:  49%|████▉     | 65/132 [02:22<01:59,  1.79s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.83it/s, est. speed input: 1896.93 toks/s, output: 275.09 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 24.69it/s, est. speed input: 8247.16 toks/s, output: 1193.50 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 34.58it/s, est. speed input: 11425.37 toks/s, output: 1756.43 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.08it/s, est. speed input: 11826.01 toks/s, output: 1989.10 toks/s]
Processing batched inference:  50%|█████     | 66/132 [02:24<01:56,  1.77s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 104.71it/s, est. speed input: 41244.02 toks/s, output: 6045.04 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.94it/s, est. speed input: 16509.02 toks/s, output: 2411.90 toks/s] 
Processing batched inference:  51%|█████     | 67/132 [02:26<02:01,  1.87s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 48.00it/s, est. speed input: 18868.02 toks/s, output: 2736.26 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 26.28it/s, est. speed input: 11206.23 toks/s, output: 1614.78 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.92it/s, est. speed input: 9580.18 toks/s, output: 1512.23 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.41it/s, est. speed input: 9580.18 toks/s, output: 1512.23 toks/s]
Processing batched inference:  52%|█████▏    | 68/132 [02:28<02:02,  1.92s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.73it/s, est. speed input: 1464.71 toks/s, output: 212.42 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 35.94it/s, est. speed input: 11410.04 toks/s, output: 1636.74 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.94it/s, est. speed input: 10952.62 toks/s, output: 1800.33 toks/s]
Processing batched inference:  52%|█████▏    | 69/132 [02:29<01:54,  1.81s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.10it/s, est. speed input: 2397.33 toks/s, output: 347.64 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 16.76it/s, est. speed input: 5811.63 toks/s, output: 833.37 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 18.71it/s, est. speed input: 6635.12 toks/s, output: 956.12 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 34.83it/s, est. speed input: 10611.23 toks/s, output: 1622.51 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.63it/s, est. speed input: 9676.58 toks/s, output: 1612.19 toks/s] 
Processing batched inference:  53%|█████▎    | 70/132 [02:31<01:54,  1.84s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.42it/s, est. speed input: 942.76 toks/s, output: 130.53 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 25.40it/s, est. speed input: 8287.45 toks/s, output: 1264.65 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.63it/s, est. speed input: 8887.55 toks/s, output: 1475.55 toks/s]
Processing batched inference:  54%|█████▍    | 71/132 [02:33<01:48,  1.77s/it]Resource status after batch 70:
Open files: 0
Memory usage: 7131.11 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 21.33it/s, est. speed input: 8384.70 toks/s, output: 1215.94 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 19.85it/s, est. speed input: 7875.95 toks/s, output: 1136.56 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 29.38it/s, est. speed input: 10576.06 toks/s, output: 1514.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.22it/s, est. speed input: 12252.16 toks/s, output: 1857.58 toks/s]
Processing batched inference:  55%|█████▍    | 72/132 [02:35<01:46,  1.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.55it/s, est. speed input: 997.91 toks/s, output: 142.55 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 20.27it/s, est. speed input: 6687.21 toks/s, output: 1032.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.93it/s, est. speed input: 8998.28 toks/s, output: 1695.30 toks/s]
Processing batched inference:  55%|█████▌    | 73/132 [02:36<01:40,  1.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.46it/s, est. speed input: 962.27 toks/s, output: 135.35 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 26.43it/s, est. speed input: 8684.64 toks/s, output: 1317.13 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.39it/s, est. speed input: 9179.95 toks/s, output: 1450.52 toks/s]
Processing batched inference:  56%|█████▌    | 74/132 [02:38<01:39,  1.71s/it]ERROR 06-30 22:44:39 [core.py:387] EngineCore hit an exception: Traceback (most recent call last):
ERROR 06-30 22:44:39 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 68, in __getitem__
ERROR 06-30 22:44:39 [core.py:387]     return self.__data[key]
ERROR 06-30 22:44:39 [core.py:387]            ~~~~~~~~~~~^^^^^
ERROR 06-30 22:44:39 [core.py:387] KeyError: 'abe773fa13da73c5d2b55ece1228a00f7661e7b5d1e4374d26fe6ed184c0b72d'
ERROR 06-30 22:44:39 [core.py:387] 
ERROR 06-30 22:44:39 [core.py:387] During handling of the above exception, another exception occurred:
ERROR 06-30 22:44:39 [core.py:387] 
ERROR 06-30 22:44:39 [core.py:387] Traceback (most recent call last):
ERROR 06-30 22:44:39 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 380, in run_engine_core
ERROR 06-30 22:44:39 [core.py:387]     engine_core.run_busy_loop()
ERROR 06-30 22:44:39 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 400, in run_busy_loop
ERROR 06-30 22:44:39 [core.py:387]     self._process_input_queue()
ERROR 06-30 22:44:39 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 425, in _process_input_queue
ERROR 06-30 22:44:39 [core.py:387]     self._handle_client_request(*req)
ERROR 06-30 22:44:39 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 441, in _handle_client_request
ERROR 06-30 22:44:39 [core.py:387]     self.add_request(request)
ERROR 06-30 22:44:39 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 177, in add_request
ERROR 06-30 22:44:39 [core.py:387]     request.mm_inputs = self.mm_input_cache_server.get_and_update_p1(
ERROR 06-30 22:44:39 [core.py:387]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 22:44:39 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/mm_input_cache.py", line 76, in get_and_update_p1
ERROR 06-30 22:44:39 [core.py:387]     mm_input = self.mm_cache[mm_hash]
ERROR 06-30 22:44:39 [core.py:387]                ~~~~~~~~~~~~~^^^^^^^^^
ERROR 06-30 22:44:39 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 211, in __getitem__
ERROR 06-30 22:44:39 [core.py:387]     value = cache_getitem(self, key)
ERROR 06-30 22:44:39 [core.py:387]             ^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 22:44:39 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 70, in __getitem__
ERROR 06-30 22:44:39 [core.py:387]     return self.__missing__(key)
ERROR 06-30 22:44:39 [core.py:387]            ^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 22:44:39 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 97, in __missing__
ERROR 06-30 22:44:39 [core.py:387]     raise KeyError(key)
ERROR 06-30 22:44:39 [core.py:387] KeyError: 'abe773fa13da73c5d2b55ece1228a00f7661e7b5d1e4374d26fe6ed184c0b72d'
ERROR 06-30 22:44:39 [core.py:387] 
CRITICAL 06-30 22:44:39 [core_client.py:359] Got fatal signal from worker processes, shutting down. See stack trace above for root cause issue.
batch_inference.sh: line 23: 369431 Killed                  python scripts/vllm_infer_new.py --model_name_or_path "$ckpt" --dataset $EVAL_DATASET --template qwen2_vl --save_name "$save_path/generated_predictions.jsonl" --max_new_tokens 4096 --temperature 0.0 --top_p 1.0 --top_k -1 --repetition_penalty 1.0 --batch_size 16 --seed 42
Running inference on checkpoint: checkpoint-189
INFO 06-30 22:44:48 [__init__.py:239] Automatically detected platform cuda.
[INFO|training_args.py:2135] 2025-06-30 22:44:50,493 >> PyTorch: setting up devices
[INFO|training_args.py:1812] 2025-06-30 22:44:50,563 >> The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,580 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,580 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,580 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,580 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,580 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,580 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,580 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:44:50,970 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:378] 2025-06-30 22:44:50,971 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189/preprocessor_config.json
[INFO|image_processing_base.py:378] 2025-06-30 22:44:50,976 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:44:50,982 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,983 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,983 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,983 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,983 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,983 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,983 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:44:50,983 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:44:51,359 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 22:44:51,361 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 22:44:51,559 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 22:44:52,006 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}

[INFO|configuration_utils.py:696] 2025-06-30 22:44:52,062 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189/config.json
[INFO|configuration_utils.py:696] 2025-06-30 22:44:52,062 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189/config.json
[INFO|configuration_utils.py:770] 2025-06-30 22:44:52,064 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "text_config": {
    "architectures": [
      "Qwen2VLForConditionalGeneration"
    ],
    "attention_dropout": 0.0,
    "bos_token_id": 151643,
    "eos_token_id": 151645,
    "hidden_act": "silu",
    "hidden_size": 1536,
    "image_token_id": null,
    "initializer_range": 0.02,
    "intermediate_size": 8960,
    "max_position_embeddings": 32768,
    "max_window_layers": 28,
    "model_type": "qwen2_vl_text",
    "num_attention_heads": 12,
    "num_hidden_layers": 28,
    "num_key_value_heads": 2,
    "rms_norm_eps": 1e-06,
    "rope_scaling": {
      "mrope_section": [
        16,
        24,
        24
      ],
      "rope_type": "default",
      "type": "default"
    },
    "rope_theta": 1000000.0,
    "sliding_window": 32768,
    "tie_word_embeddings": true,
    "torch_dtype": "float32",
    "use_cache": false,
    "use_sliding_window": false,
    "video_token_id": null,
    "vision_end_token_id": 151653,
    "vision_start_token_id": 151652,
    "vision_token_id": 151654,
    "vocab_size": 151936
  },
  "torch_dtype": "bfloat16",
  "transformers_version": "4.52.4",
  "use_cache": false,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "depth": 32,
    "embed_dim": 1280,
    "hidden_act": "quick_gelu",
    "hidden_size": 1536,
    "in_channels": 3,
    "in_chans": 3,
    "initializer_range": 0.02,
    "mlp_ratio": 4,
    "model_type": "qwen2_vl",
    "num_heads": 16,
    "patch_size": 14,
    "spatial_merge_size": 2,
    "spatial_patch_size": 14,
    "temporal_patch_size": 2,
    "torch_dtype": "float32"
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 151936
}

INFO 06-30 22:45:03 [config.py:689] This model supports multiple tasks: {'score', 'classify', 'reward', 'embed', 'generate'}. Defaulting to 'generate'.
INFO 06-30 22:45:03 [config.py:1901] Chunked prefill is enabled with max_num_batched_tokens=8192.
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:45:04,717 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:45:04,717 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:45:04,717 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:45:04,717 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:45:04,717 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:45:04,717 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:45:04,717 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:45:05,070 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:1088] 2025-06-30 22:45:05,163 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189/generation_config.json
[INFO|configuration_utils.py:1135] 2025-06-30 22:45:05,164 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

WARNING 06-30 22:45:05 [utils.py:2304] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/getting_started/troubleshooting.html#python-multiprocessing for more information. Reason: CUDA is initialized
INFO 06-30 22:45:12 [__init__.py:239] Automatically detected platform cuda.
INFO 06-30 22:45:15 [core.py:61] Initializing a V1 LLM engine (v0.8.4) with config: model='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189', speculative_config=None, tokenizer='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-30 22:45:16 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f5fae402f90>
INFO 06-30 22:45:16 [parallel_state.py:959] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-30 22:45:16 [cuda.py:221] Using Flash Attention backend on V1 engine.
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:45:19 [gpu_model_runner.py:1276] Starting to load model saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189...
WARNING 06-30 22:45:19 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-30 22:45:20 [config.py:3466] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
WARNING 06-30 22:45:20 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.59s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.59s/it]

INFO 06-30 22:45:22 [loader.py:458] Loading weights took 2.81 seconds
INFO 06-30 22:45:23 [gpu_model_runner.py:1291] Model loading took 4.1513 GiB and 3.009549 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:45:24 [gpu_model_runner.py:1560] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-30 22:45:38 [backends.py:416] Using cache directory: /root/.cache/vllm/torch_compile_cache/c6c942b80a/rank_0_0 for vLLM's torch.compile
INFO 06-30 22:45:38 [backends.py:426] Dynamo bytecode transform time: 7.40 s
INFO 06-30 22:45:38 [backends.py:115] Directly load the compiled graph for shape None from the cache
INFO 06-30 22:45:45 [monitor.py:33] torch.compile takes 7.40 s in total
INFO 06-30 22:45:45 [kv_cache_utils.py:634] GPU KV cache size: 1,006,016 tokens
INFO 06-30 22:45:45 [kv_cache_utils.py:637] Maximum concurrency for 6,144 tokens per request: 163.74x
INFO 06-30 22:46:06 [gpu_model_runner.py:1626] Graph capturing finished in 20 secs, took 0.47 GiB
INFO 06-30 22:46:06 [core.py:163] init engine (profile, create kv cache, warmup model) took 42.98 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:46:07 [core_client.py:435] Core engine process 0 ready.
[INFO|2025-06-30 22:46:07] llamafactory.data.loader:143 >> Loading dataset ./0_my_dataset/vindr/qwen2_vindr_input_test_len_2108.json...
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151653, 198, 5598, 30618, 14697, 315, 364, 47, 811, 372, 8767, 269, 706, 6, 5671, 438, 4718, 3561, 510, 73594, 2236, 198, 9640, 4913, 58456, 62, 17, 67, 788, 508, 87, 16, 11, 379, 16, 11, 856, 17, 11, 379, 17, 1125, 330, 1502, 788, 330, 1502, 7115, 9338, 921, 73594, 151645, 198, 151644, 77091, 198]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|vision_end|>
Return bounding boxes of 'Pneumothorax' areas as JSON format:
```json
[
{"bbox_2d": [x1, y1, x2, y2], "label": "label"},
...
]
```<|im_end|>
<|im_start|>assistant

label_ids:
[27, 9217, 397, 9640, 220, 341, 262, 330, 58456, 62, 17, 67, 788, 2278, 414, 220, 16, 22, 20, 345, 414, 220, 17, 22, 24, 345, 414, 220, 18, 15, 17, 345, 414, 220, 21, 23, 16, 198, 262, 3211, 262, 330, 1502, 788, 330, 47, 811, 372, 8767, 269, 706, 698, 220, 456, 921, 522, 9217, 29, 151645, 198]
labels:
<answer>
[
  {
    "bbox_2d": [
      175,
      279,
      302,
      681
    ],
    "label": "Pneumothorax"
  }
]
</answer><|im_end|>

Current file descriptor limits: soft=8192, hard=8192
Initial resource status:
Open files: 0
Memory usage: 932.50 MB
Using effective batch size: 16
Processing batched inference:   0%|          | 0/132 [00:00<?, ?it/s][INFO|image_processing_base.py:378] 2025-06-30 22:46:08,420 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:46:08,420 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|image_processing_base.py:378] 2025-06-30 22:46:08,421 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:46:08,421 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:46:08,422 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:46:08,422 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:46:08,422 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:46:08,422 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:46:08,422 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:46:08,422 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:46:08,422 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:46:09,267 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 22:46:09,267 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 22:46:09,267 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 22:46:09,759 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: CachedQwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-189', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='left', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}


Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 60.59it/s, est. speed input: 23840.07 toks/s, output: 3998.75 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.52it/s, est. speed input: 15146.47 toks/s, output: 2655.56 toks/s]
Processing batched inference:   1%|          | 1/132 [00:04<10:13,  4.68s/it]Resource status after batch 0:
Open files: 0
Memory usage: 1082.88 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 103.51it/s, est. speed input: 40645.84 toks/s, output: 6709.32 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.74it/s, est. speed input: 16789.72 toks/s, output: 2794.55 toks/s] 
Processing batched inference:   2%|▏         | 2/132 [00:07<07:34,  3.50s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 80.07it/s, est. speed input: 31429.60 toks/s, output: 4824.19 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.85it/s, est. speed input: 9758.24 toks/s, output: 1551.53 toks/s] 
Processing batched inference:   2%|▏         | 3/132 [00:10<06:53,  3.21s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 94.58it/s, est. speed input: 37134.83 toks/s, output: 6478.87 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.02it/s, est. speed input: 17290.21 toks/s, output: 3026.51 toks/s]
Processing batched inference:   3%|▎         | 4/132 [00:12<06:27,  3.03s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 82.73it/s, est. speed input: 32538.42 toks/s, output: 5445.14 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.39it/s, est. speed input: 16651.35 toks/s, output: 2896.52 toks/s]
Processing batched inference:   4%|▍         | 5/132 [00:15<06:07,  2.90s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 92.88it/s, est. speed input: 36530.44 toks/s, output: 5317.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.10it/s, est. speed input: 16948.33 toks/s, output: 2596.99 toks/s]
Processing batched inference:   5%|▍         | 6/132 [00:18<05:53,  2.81s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 78.37it/s, est. speed input: 30717.67 toks/s, output: 4970.10 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.13it/s, est. speed input: 10239.81 toks/s, output: 1752.61 toks/s]
Processing batched inference:   5%|▌         | 7/132 [00:20<05:47,  2.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 43.61it/s, est. speed input: 17150.58 toks/s, output: 2496.63 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 25.16it/s, est. speed input: 10723.09 toks/s, output: 1551.63 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.14it/s, est. speed input: 8661.77 toks/s, output: 1319.82 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.03it/s, est. speed input: 8661.77 toks/s, output: 1319.82 toks/s]
Processing batched inference:   6%|▌         | 8/132 [00:23<05:36,  2.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 86.60it/s, est. speed input: 34005.61 toks/s, output: 5246.96 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.75it/s, est. speed input: 12464.54 toks/s, output: 2077.71 toks/s]
Processing batched inference:   7%|▋         | 9/132 [00:25<05:22,  2.62s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 109.21it/s, est. speed input: 42892.25 toks/s, output: 6632.75 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.86it/s, est. speed input: 9373.74 toks/s, output: 1560.27 toks/s]  
Processing batched inference:   8%|▊         | 10/132 [00:28<05:24,  2.66s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 94.39it/s, est. speed input: 37019.86 toks/s, output: 5655.44 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.37it/s, est. speed input: 11907.38 toks/s, output: 1957.27 toks/s]
Processing batched inference:   8%|▊         | 11/132 [00:31<05:22,  2.67s/it]Resource status after batch 10:
Open files: 0
Memory usage: 2773.04 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 77.58it/s, est. speed input: 30464.25 toks/s, output: 4732.56 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.96it/s, est. speed input: 15298.84 toks/s, output: 2432.78 toks/s]
Processing batched inference:   9%|▉         | 12/132 [00:34<05:20,  2.67s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 92.54it/s, est. speed input: 36347.67 toks/s, output: 5606.29 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.02it/s, est. speed input: 17295.67 toks/s, output: 2760.38 toks/s]
Processing batched inference:  10%|▉         | 13/132 [00:36<05:08,  2.59s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 92.21it/s, est. speed input: 36172.57 toks/s, output: 5878.42 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.29it/s, est. speed input: 10712.39 toks/s, output: 1938.01 toks/s]
Processing batched inference:  11%|█         | 14/132 [00:39<05:19,  2.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 57.00it/s, est. speed input: 22403.72 toks/s, output: 3676.56 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 59.69it/s, est. speed input: 23285.32 toks/s, output: 3768.16 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.66it/s, est. speed input: 16369.18 toks/s, output: 2601.73 toks/s]
Processing batched inference:  11%|█▏        | 15/132 [00:41<04:59,  2.56s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 78.89it/s, est. speed input: 31028.44 toks/s, output: 5443.68 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.65it/s, est. speed input: 14461.78 toks/s, output: 2625.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.81it/s, est. speed input: 14461.78 toks/s, output: 2625.78 toks/s]
Processing batched inference:  12%|█▏        | 16/132 [00:44<04:54,  2.54s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 77.39it/s, est. speed input: 30368.89 toks/s, output: 4747.02 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.43it/s, est. speed input: 16652.11 toks/s, output: 2631.14 toks/s]
Processing batched inference:  13%|█▎        | 17/132 [00:46<04:48,  2.51s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 69.98it/s, est. speed input: 27488.41 toks/s, output: 3973.21 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.36it/s, est. speed input: 9492.93 toks/s, output: 1430.64 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.19it/s, est. speed input: 9492.93 toks/s, output: 1430.64 toks/s]
Processing batched inference:  14%|█▎        | 18/132 [00:48<04:36,  2.42s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 96.95it/s, est. speed input: 38074.84 toks/s, output: 5831.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.44it/s, est. speed input: 17457.20 toks/s, output: 2647.30 toks/s]
Processing batched inference:  14%|█▍        | 19/132 [00:51<04:40,  2.48s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 35.77it/s, est. speed input: 14060.54 toks/s, output: 2033.22 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 37.30it/s, est. speed input: 14536.78 toks/s, output: 2442.96 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.58it/s, est. speed input: 13239.19 toks/s, output: 2133.82 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.67it/s, est. speed input: 12040.81 toks/s, output: 2085.68 toks/s]
Processing batched inference:  15%|█▌        | 20/132 [00:53<04:23,  2.35s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 87.41it/s, est. speed input: 34275.64 toks/s, output: 5836.57 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.71it/s, est. speed input: 13605.49 toks/s, output: 2339.12 toks/s]
Processing batched inference:  16%|█▌        | 21/132 [00:56<04:26,  2.40s/it]Resource status after batch 20:
Open files: 0
Memory usage: 4296.96 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 87.07it/s, est. speed input: 34205.99 toks/s, output: 5303.87 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.42it/s, est. speed input: 17054.82 toks/s, output: 2717.06 toks/s]
Processing batched inference:  17%|█▋        | 22/132 [00:58<04:30,  2.46s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 65.91it/s, est. speed input: 25874.18 toks/s, output: 3724.23 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 36.71it/s, est. speed input: 15518.41 toks/s, output: 2615.74 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.92it/s, est. speed input: 16077.61 toks/s, output: 2688.47 toks/s]
Processing batched inference:  17%|█▋        | 23/132 [01:00<04:21,  2.40s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 68.65it/s, est. speed input: 27001.17 toks/s, output: 3930.51 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 37.86it/s, est. speed input: 16032.12 toks/s, output: 2583.11 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.81it/s, est. speed input: 16823.94 toks/s, output: 2689.28 toks/s]
Processing batched inference:  18%|█▊        | 24/132 [01:03<04:13,  2.35s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 44.97it/s, est. speed input: 17674.60 toks/s, output: 2563.23 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 25.80it/s, est. speed input: 11008.76 toks/s, output: 1701.91 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.98it/s, est. speed input: 7959.89 toks/s, output: 1341.38 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.24it/s, est. speed input: 7959.89 toks/s, output: 1341.38 toks/s]
Processing batched inference:  19%|█▉        | 25/132 [01:05<04:17,  2.41s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 95.92it/s, est. speed input: 37645.38 toks/s, output: 5841.85 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.35it/s, est. speed input: 16628.14 toks/s, output: 2517.17 toks/s]
Processing batched inference:  20%|█▉        | 26/132 [01:07<04:06,  2.32s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01, 13.04it/s, est. speed input: 5126.47 toks/s, output: 743.45 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 13.40it/s, est. speed input: 5244.69 toks/s, output: 760.65 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 21.52it/s, est. speed input: 7510.84 toks/s, output: 1089.33 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 21.71it/s, est. speed input: 7788.98 toks/s, output: 1297.54 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.61it/s, est. speed input: 10048.84 toks/s, output: 1958.15 toks/s]
Processing batched inference:  20%|██        | 27/132 [01:09<03:50,  2.19s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 65.22it/s, est. speed input: 25596.43 toks/s, output: 3948.56 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.23it/s, est. speed input: 10683.54 toks/s, output: 1761.83 toks/s]
Processing batched inference:  21%|██        | 28/132 [01:12<03:54,  2.26s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 55.81it/s, est. speed input: 21920.96 toks/s, output: 3149.27 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 41.17it/s, est. speed input: 16881.07 toks/s, output: 2576.38 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.33it/s, est. speed input: 10338.29 toks/s, output: 1797.07 toks/s]
Processing batched inference:  22%|██▏       | 29/132 [01:14<03:47,  2.21s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 59.56it/s, est. speed input: 23372.30 toks/s, output: 3692.77 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 25.12it/s, est. speed input: 10943.02 toks/s, output: 1949.58 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.38it/s, est. speed input: 9175.42 toks/s, output: 1731.57 toks/s] 
Processing batched inference:  23%|██▎       | 30/132 [01:16<03:56,  2.31s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 64.75it/s, est. speed input: 25476.28 toks/s, output: 4560.92 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.15it/s, est. speed input: 13665.60 toks/s, output: 2320.12 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.93it/s, est. speed input: 10185.17 toks/s, output: 1844.15 toks/s]
Processing batched inference:  23%|██▎       | 31/132 [01:19<03:58,  2.36s/it]Resource status after batch 30:
Open files: 0
Memory usage: 5576.63 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 51.50it/s, est. speed input: 20217.87 toks/s, output: 2913.24 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 35.75it/s, est. speed input: 14784.18 toks/s, output: 2571.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.68it/s, est. speed input: 10093.67 toks/s, output: 1926.23 toks/s]
Processing batched inference:  24%|██▍       | 32/132 [01:21<04:05,  2.45s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 18.48it/s, est. speed input: 7259.59 toks/s, output: 1048.82 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 15.50it/s, est. speed input: 6291.35 toks/s, output: 907.86 toks/s] [A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 35.43it/s, est. speed input: 11491.86 toks/s, output: 1753.58 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.61it/s, est. speed input: 12812.70 toks/s, output: 1946.51 toks/s]
Processing batched inference:  25%|██▌       | 33/132 [01:23<03:44,  2.27s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 79.79it/s, est. speed input: 31327.51 toks/s, output: 4512.93 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.07it/s, est. speed input: 16907.96 toks/s, output: 2686.89 toks/s]
Processing batched inference:  26%|██▌       | 34/132 [01:25<03:39,  2.24s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 34.25it/s, est. speed input: 13443.63 toks/s, output: 1935.05 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 32.72it/s, est. speed input: 12935.04 toks/s, output: 1857.63 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.18it/s, est. speed input: 14383.46 toks/s, output: 2393.74 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.63it/s, est. speed input: 14383.46 toks/s, output: 2393.74 toks/s]
Processing batched inference:  27%|██▋       | 35/132 [01:27<03:24,  2.11s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 47.82it/s, est. speed input: 18820.94 toks/s, output: 3132.53 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 38.37it/s, est. speed input: 15568.82 toks/s, output: 2743.07 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.26it/s, est. speed input: 16525.36 toks/s, output: 2750.64 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.06it/s, est. speed input: 16525.36 toks/s, output: 2750.64 toks/s]
Processing batched inference:  27%|██▋       | 36/132 [01:29<03:24,  2.13s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 27.29it/s, est. speed input: 10714.68 toks/s, output: 1542.19 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 30.75it/s, est. speed input: 11849.73 toks/s, output: 1893.75 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 30.37it/s, est. speed input: 11817.34 toks/s, output: 1941.07 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.72it/s, est. speed input: 11164.34 toks/s, output: 1851.19 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.44it/s, est. speed input: 11164.34 toks/s, output: 1851.19 toks/s]
Processing batched inference:  28%|██▊       | 37/132 [01:31<03:22,  2.13s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 47.73it/s, est. speed input: 18782.77 toks/s, output: 3036.78 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 41.05it/s, est. speed input: 16546.07 toks/s, output: 2707.00 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.33it/s, est. speed input: 15468.66 toks/s, output: 2490.67 toks/s]
Processing batched inference:  29%|██▉       | 38/132 [01:34<03:21,  2.14s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 85.40it/s, est. speed input: 33561.13 toks/s, output: 4859.48 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.82it/s, est. speed input: 15264.84 toks/s, output: 2336.98 toks/s]
Processing batched inference:  30%|██▉       | 39/132 [01:36<03:13,  2.08s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 46.79it/s, est. speed input: 18352.01 toks/s, output: 2628.14 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 34.47it/s, est. speed input: 14145.48 toks/s, output: 2194.30 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 20.97it/s, est. speed input: 9556.96 toks/s, output: 1536.29 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.67it/s, est. speed input: 9298.47 toks/s, output: 1559.33 toks/s]
Processing batched inference:  30%|███       | 40/132 [01:38<03:13,  2.10s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 36.63it/s, est. speed input: 14397.72 toks/s, output: 2087.99 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 29.69it/s, est. speed input: 12058.82 toks/s, output: 1868.86 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.05it/s, est. speed input: 12605.37 toks/s, output: 1917.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.19it/s, est. speed input: 14213.94 toks/s, output: 2153.65 toks/s]
Processing batched inference:  31%|███       | 41/132 [01:40<03:05,  2.03s/it]Resource status after batch 40:
Open files: 0
Memory usage: 6763.22 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 48.56it/s, est. speed input: 19105.59 toks/s, output: 3020.57 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 26.13it/s, est. speed input: 11304.50 toks/s, output: 1896.18 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.11it/s, est. speed input: 11032.83 toks/s, output: 1909.62 toks/s]
Processing batched inference:  32%|███▏      | 42/132 [01:42<03:12,  2.14s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01, 11.08it/s, est. speed input: 4342.05 toks/s, output: 620.25 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:01,  9.91it/s, est. speed input: 3956.64 toks/s, output: 820.50 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 18.44it/s, est. speed input: 6241.82 toks/s, output: 1182.74 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 27.45it/s, est. speed input: 8668.86 toks/s, output: 1584.30 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.19it/s, est. speed input: 8702.82 toks/s, output: 1639.03 toks/s]
Processing batched inference:  33%|███▎      | 43/132 [01:44<03:11,  2.15s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 21.77it/s, est. speed input: 8557.86 toks/s, output: 1241.14 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 24.21it/s, est. speed input: 9365.65 toks/s, output: 1597.75 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 28.03it/s, est. speed input: 10402.13 toks/s, output: 1968.89 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.00it/s, est. speed input: 10614.35 toks/s, output: 2106.29 toks/s]
Processing batched inference:  33%|███▎      | 44/132 [01:46<03:06,  2.12s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 20.11it/s, est. speed input: 7890.70 toks/s, output: 1132.78 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 42.36it/s, est. speed input: 15278.66 toks/s, output: 2224.83 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.13it/s, est. speed input: 13955.58 toks/s, output: 2227.03 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 35.51it/s, est. speed input: 13955.58 toks/s, output: 2227.03 toks/s]
Processing batched inference:  34%|███▍      | 45/132 [01:48<02:57,  2.04s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 18.24it/s, est. speed input: 7145.77 toks/s, output: 1015.50 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 20.13it/s, est. speed input: 7763.57 toks/s, output: 1252.03 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 41.06it/s, est. speed input: 13637.70 toks/s, output: 2507.73 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.97it/s, est. speed input: 10968.33 toks/s, output: 2064.56 toks/s]
Processing batched inference:  35%|███▍      | 46/132 [01:50<02:50,  1.98s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.35it/s, est. speed input: 2098.70 toks/s, output: 299.78 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 13.10it/s, est. speed input: 4636.00 toks/s, output: 797.72 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 31.19it/s, est. speed input: 10215.76 toks/s, output: 1628.87 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.28it/s, est. speed input: 10320.49 toks/s, output: 1714.84 toks/s]
Processing batched inference:  36%|███▌      | 47/132 [01:52<02:45,  1.95s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 53.34it/s, est. speed input: 20947.40 toks/s, output: 3022.77 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 38.46it/s, est. speed input: 15894.67 toks/s, output: 2664.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.47it/s, est. speed input: 11561.18 toks/s, output: 2000.18 toks/s]
Processing batched inference:  36%|███▋      | 48/132 [01:54<02:52,  2.06s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 17.73it/s, est. speed input: 6952.68 toks/s, output: 993.14 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 16.45it/s, est. speed input: 6529.55 toks/s, output: 939.86 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 38.05it/s, est. speed input: 12608.16 toks/s, output: 1811.11 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.55it/s, est. speed input: 11450.25 toks/s, output: 1898.56 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.16it/s, est. speed input: 11450.25 toks/s, output: 1898.56 toks/s]
Processing batched inference:  37%|███▋      | 49/132 [01:56<02:42,  1.96s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 56.56it/s, est. speed input: 22229.69 toks/s, output: 3223.81 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 52.98it/s, est. speed input: 20992.41 toks/s, output: 3034.00 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.34it/s, est. speed input: 13099.60 toks/s, output: 1996.62 toks/s]
Processing batched inference:  38%|███▊      | 50/132 [01:58<02:40,  1.96s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.20it/s, est. speed input: 1250.77 toks/s, output: 175.93 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 41.60it/s, est. speed input: 13007.81 toks/s, output: 1890.61 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.34it/s, est. speed input: 10360.10 toks/s, output: 1588.88 toks/s]
Processing batched inference:  39%|███▊      | 51/132 [01:59<02:30,  1.86s/it]Resource status after batch 50:
Open files: 0
Memory usage: 7734.67 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 16.29it/s, est. speed input: 6381.45 toks/s, output: 906.87 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 20.81it/s, est. speed input: 7824.83 toks/s, output: 1261.86 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 30.11it/s, est. speed input: 10443.53 toks/s, output: 1611.06 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 29.65it/s, est. speed input: 10686.66 toks/s, output: 1715.72 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.13it/s, est. speed input: 9087.11 toks/s, output: 1522.20 toks/s] 
Processing batched inference:  39%|███▉      | 52/132 [02:02<02:37,  1.97s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.99it/s, est. speed input: 1572.51 toks/s, output: 231.46 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  8.40it/s, est. speed input: 2971.06 toks/s, output: 428.73 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 27.24it/s, est. speed input: 7891.67 toks/s, output: 1142.83 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 21.96it/s, est. speed input: 7474.14 toks/s, output: 1323.91 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.36it/s, est. speed input: 7991.66 toks/s, output: 1510.26 toks/s]
Processing batched inference:  40%|████      | 53/132 [02:04<02:37,  2.00s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 18.39it/s, est. speed input: 7214.68 toks/s, output: 1035.83 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 21.65it/s, est. speed input: 8285.71 toks/s, output: 1198.68 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 21.70it/s, est. speed input: 8376.01 toks/s, output: 1216.79 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.73it/s, est. speed input: 8715.38 toks/s, output: 1379.21 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.20it/s, est. speed input: 8715.38 toks/s, output: 1379.21 toks/s]
Processing batched inference:  41%|████      | 54/132 [02:06<02:32,  1.96s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 16.24it/s, est. speed input: 6398.87 toks/s, output: 941.88 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 23.09it/s, est. speed input: 8625.82 toks/s, output: 1239.73 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 17.10it/s, est. speed input: 6984.37 toks/s, output: 1005.37 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 22.75it/s, est. speed input: 8403.23 toks/s, output: 1293.79 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.18it/s, est. speed input: 8375.64 toks/s, output: 1465.01 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.32it/s, est. speed input: 8375.64 toks/s, output: 1465.01 toks/s]
Processing batched inference:  42%|████▏     | 55/132 [02:08<02:30,  1.96s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 39.00it/s, est. speed input: 15360.14 toks/s, output: 2252.57 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 31.61it/s, est. speed input: 12765.59 toks/s, output: 2017.02 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 45.66it/s, est. speed input: 16770.56 toks/s, output: 2545.45 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.67it/s, est. speed input: 16770.56 toks/s, output: 2545.45 toks/s]
Processing batched inference:  42%|████▏     | 56/132 [02:09<02:25,  1.91s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.25it/s, est. speed input: 878.71 toks/s, output: 123.60 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 24.16it/s, est. speed input: 7941.25 toks/s, output: 1211.65 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.37it/s, est. speed input: 8003.18 toks/s, output: 1280.79 toks/s]
Processing batched inference:  43%|████▎     | 57/132 [02:11<02:13,  1.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 19.90it/s, est. speed input: 7802.86 toks/s, output: 1114.56 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 17.22it/s, est. speed input: 6899.59 toks/s, output: 993.13 toks/s] [A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 25.41it/s, est. speed input: 9231.45 toks/s, output: 1480.26 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 37.90it/s, est. speed input: 14891.24 toks/s, output: 2494.45 toks/s]
Processing batched inference:  44%|████▍     | 58/132 [02:13<02:13,  1.80s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.59it/s, est. speed input: 1795.15 toks/s, output: 252.49 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 22.25it/s, est. speed input: 7505.37 toks/s, output: 1086.16 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 33.46it/s, est. speed input: 10741.60 toks/s, output: 1643.58 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.31it/s, est. speed input: 9540.08 toks/s, output: 1647.44 toks/s] 
Processing batched inference:  45%|████▍     | 59/132 [02:14<02:11,  1.80s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.25it/s, est. speed input: 1662.41 toks/s, output: 233.82 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 28.83it/s, est. speed input: 9327.09 toks/s, output: 1365.39 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 36.09it/s, est. speed input: 11659.02 toks/s, output: 1698.77 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.92it/s, est. speed input: 9401.68 toks/s, output: 1496.88 toks/s] 
Processing batched inference:  45%|████▌     | 60/132 [02:16<02:06,  1.76s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.08it/s, est. speed input: 1214.53 toks/s, output: 178.78 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 13.04it/s, est. speed input: 4289.91 toks/s, output: 620.32 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 22.87it/s, est. speed input: 7183.73 toks/s, output: 1100.12 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.27it/s, est. speed input: 8007.33 toks/s, output: 1442.98 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.41it/s, est. speed input: 8007.33 toks/s, output: 1442.98 toks/s]
Processing batched inference:  46%|████▌     | 61/132 [02:18<02:03,  1.74s/it]Resource status after batch 60:
Open files: 0
Memory usage: 8456.00 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.56it/s, est. speed input: 1781.88 toks/s, output: 250.63 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 21.55it/s, est. speed input: 7291.35 toks/s, output: 1048.38 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 27.23it/s, est. speed input: 9032.50 toks/s, output: 1304.64 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.56it/s, est. speed input: 9121.82 toks/s, output: 1443.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.24it/s, est. speed input: 9121.82 toks/s, output: 1443.78 toks/s]
Processing batched inference:  47%|████▋     | 62/132 [02:20<02:01,  1.74s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.52it/s, est. speed input: 2560.84 toks/s, output: 371.38 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 33.45it/s, est. speed input: 11359.17 toks/s, output: 1628.87 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 34.72it/s, est. speed input: 12301.70 toks/s, output: 1759.40 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.07it/s, est. speed input: 11006.00 toks/s, output: 1737.20 toks/s]
Processing batched inference:  48%|████▊     | 63/132 [02:21<02:01,  1.77s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.84it/s, est. speed input: 1114.29 toks/s, output: 159.18 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 24.73it/s, est. speed input: 8336.10 toks/s, output: 1276.82 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.05it/s, est. speed input: 9444.77 toks/s, output: 1584.12 toks/s]
Processing batched inference:  48%|████▊     | 64/132 [02:23<01:56,  1.72s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 18.74it/s, est. speed input: 7366.90 toks/s, output: 1068.37 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 25.26it/s, est. speed input: 9594.36 toks/s, output: 1391.47 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 38.32it/s, est. speed input: 13414.49 toks/s, output: 2066.32 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.90it/s, est. speed input: 9093.51 toks/s, output: 1526.88 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.13it/s, est. speed input: 9093.51 toks/s, output: 1526.88 toks/s]
Processing batched inference:  49%|████▉     | 65/132 [02:25<02:02,  1.82s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.28it/s, est. speed input: 1682.76 toks/s, output: 244.05 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 28.87it/s, est. speed input: 9328.94 toks/s, output: 1347.93 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 28.68it/s, est. speed input: 9971.11 toks/s, output: 1537.88 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.08it/s, est. speed input: 11041.37 toks/s, output: 1936.14 toks/s]
Processing batched inference:  50%|█████     | 66/132 [02:27<01:57,  1.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 80.05it/s, est. speed input: 31527.75 toks/s, output: 4628.33 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.56it/s, est. speed input: 9666.41 toks/s, output: 1562.68 toks/s] 
Processing batched inference:  51%|█████     | 67/132 [02:29<02:04,  1.91s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 61.80it/s, est. speed input: 24293.38 toks/s, output: 3514.12 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 25.86it/s, est. speed input: 11121.59 toks/s, output: 1790.82 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.73it/s, est. speed input: 9703.16 toks/s, output: 1679.98 toks/s] 
Processing batched inference:  52%|█████▏    | 68/132 [02:31<02:06,  1.98s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.01it/s, est. speed input: 1577.00 toks/s, output: 228.71 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 16.85it/s, est. speed input: 5544.05 toks/s, output: 794.40 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 33.60it/s, est. speed input: 10318.78 toks/s, output: 1575.48 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.58it/s, est. speed input: 10030.07 toks/s, output: 1720.68 toks/s]
Processing batched inference:  52%|█████▏    | 69/132 [02:33<01:58,  1.88s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.97it/s, est. speed input: 1561.07 toks/s, output: 226.40 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 21.09it/s, est. speed input: 6994.37 toks/s, output: 1012.24 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 30.54it/s, est. speed input: 10052.20 toks/s, output: 1533.18 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.71it/s, est. speed input: 8920.78 toks/s, output: 1416.74 toks/s] 
Processing batched inference:  53%|█████▎    | 70/132 [02:35<01:53,  1.84s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.31it/s, est. speed input: 902.58 toks/s, output: 124.96 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 23.26it/s, est. speed input: 7555.50 toks/s, output: 1153.14 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.49it/s, est. speed input: 8437.43 toks/s, output: 1463.95 toks/s]
Processing batched inference:  54%|█████▍    | 71/132 [02:36<01:47,  1.76s/it]Resource status after batch 70:
Open files: 0
Memory usage: 8977.73 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 14.95it/s, est. speed input: 5883.47 toks/s, output: 859.64 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 19.18it/s, est. speed input: 7294.45 toks/s, output: 1061.05 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 30.90it/s, est. speed input: 10722.65 toks/s, output: 1546.65 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 26.42it/s, est. speed input: 9989.53 toks/s, output: 1510.67 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.41it/s, est. speed input: 8402.41 toks/s, output: 1334.14 toks/s]
Processing batched inference:  55%|█████▍    | 72/132 [02:38<01:51,  1.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.88it/s, est. speed input: 1127.92 toks/s, output: 158.65 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 27.46it/s, est. speed input: 9113.16 toks/s, output: 1386.42 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.91it/s, est. speed input: 9777.56 toks/s, output: 1622.55 toks/s]
Processing batched inference:  55%|█████▌    | 73/132 [02:40<01:45,  1.79s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.29it/s, est. speed input: 895.07 toks/s, output: 125.90 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 13.92it/s, est. speed input: 4354.01 toks/s, output: 623.57 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 22.00it/s, est. speed input: 6877.56 toks/s, output: 1045.26 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.97it/s, est. speed input: 7443.64 toks/s, output: 1234.27 toks/s]
Processing batched inference:  56%|█████▌    | 74/132 [02:42<01:42,  1.76s/it]ERROR 06-30 22:48:50 [core.py:387] EngineCore hit an exception: Traceback (most recent call last):
ERROR 06-30 22:48:50 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 68, in __getitem__
ERROR 06-30 22:48:50 [core.py:387]     return self.__data[key]
ERROR 06-30 22:48:50 [core.py:387]            ~~~~~~~~~~~^^^^^
ERROR 06-30 22:48:50 [core.py:387] KeyError: '1ec007c256916d72e00681199e5e467a489a2b307e30b6dbbf168dc8d54f85bd'
ERROR 06-30 22:48:50 [core.py:387] 
ERROR 06-30 22:48:50 [core.py:387] During handling of the above exception, another exception occurred:
ERROR 06-30 22:48:50 [core.py:387] 
ERROR 06-30 22:48:50 [core.py:387] Traceback (most recent call last):
ERROR 06-30 22:48:50 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 380, in run_engine_core
ERROR 06-30 22:48:50 [core.py:387]     engine_core.run_busy_loop()
ERROR 06-30 22:48:50 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 400, in run_busy_loop
ERROR 06-30 22:48:50 [core.py:387]     self._process_input_queue()
ERROR 06-30 22:48:50 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 425, in _process_input_queue
ERROR 06-30 22:48:50 [core.py:387]     self._handle_client_request(*req)
ERROR 06-30 22:48:50 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 441, in _handle_client_request
ERROR 06-30 22:48:50 [core.py:387]     self.add_request(request)
ERROR 06-30 22:48:50 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 177, in add_request
ERROR 06-30 22:48:50 [core.py:387]     request.mm_inputs = self.mm_input_cache_server.get_and_update_p1(
ERROR 06-30 22:48:50 [core.py:387]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 22:48:50 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/mm_input_cache.py", line 76, in get_and_update_p1
ERROR 06-30 22:48:50 [core.py:387]     mm_input = self.mm_cache[mm_hash]
ERROR 06-30 22:48:50 [core.py:387]                ~~~~~~~~~~~~~^^^^^^^^^
ERROR 06-30 22:48:50 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 211, in __getitem__
ERROR 06-30 22:48:50 [core.py:387]     value = cache_getitem(self, key)
ERROR 06-30 22:48:50 [core.py:387]             ^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 22:48:50 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 70, in __getitem__
ERROR 06-30 22:48:50 [core.py:387]     return self.__missing__(key)
ERROR 06-30 22:48:50 [core.py:387]            ^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 22:48:50 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 97, in __missing__
ERROR 06-30 22:48:50 [core.py:387]     raise KeyError(key)
ERROR 06-30 22:48:50 [core.py:387] KeyError: '1ec007c256916d72e00681199e5e467a489a2b307e30b6dbbf168dc8d54f85bd'
ERROR 06-30 22:48:50 [core.py:387] 
CRITICAL 06-30 22:48:50 [core_client.py:359] Got fatal signal from worker processes, shutting down. See stack trace above for root cause issue.
batch_inference.sh: line 23: 408746 Killed                  python scripts/vllm_infer_new.py --model_name_or_path "$ckpt" --dataset $EVAL_DATASET --template qwen2_vl --save_name "$save_path/generated_predictions.jsonl" --max_new_tokens 4096 --temperature 0.0 --top_p 1.0 --top_k -1 --repetition_penalty 1.0 --batch_size 16 --seed 42
Running inference on checkpoint: checkpoint-252
INFO 06-30 22:49:01 [__init__.py:239] Automatically detected platform cuda.
[INFO|training_args.py:2135] 2025-06-30 22:49:03,458 >> PyTorch: setting up devices
[INFO|training_args.py:1812] 2025-06-30 22:49:03,501 >> The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,517 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,517 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,517 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,517 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,517 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,517 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,518 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:49:03,903 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:378] 2025-06-30 22:49:03,903 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252/preprocessor_config.json
[INFO|image_processing_base.py:378] 2025-06-30 22:49:03,908 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:49:03,914 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,915 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,915 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,915 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,915 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,915 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,915 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:03,915 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:49:04,295 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 22:49:04,297 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 22:49:04,487 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 22:49:04,937 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}

[INFO|configuration_utils.py:696] 2025-06-30 22:49:04,998 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252/config.json
[INFO|configuration_utils.py:696] 2025-06-30 22:49:04,998 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252/config.json
[INFO|configuration_utils.py:770] 2025-06-30 22:49:05,000 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "text_config": {
    "architectures": [
      "Qwen2VLForConditionalGeneration"
    ],
    "attention_dropout": 0.0,
    "bos_token_id": 151643,
    "eos_token_id": 151645,
    "hidden_act": "silu",
    "hidden_size": 1536,
    "image_token_id": null,
    "initializer_range": 0.02,
    "intermediate_size": 8960,
    "max_position_embeddings": 32768,
    "max_window_layers": 28,
    "model_type": "qwen2_vl_text",
    "num_attention_heads": 12,
    "num_hidden_layers": 28,
    "num_key_value_heads": 2,
    "rms_norm_eps": 1e-06,
    "rope_scaling": {
      "mrope_section": [
        16,
        24,
        24
      ],
      "rope_type": "default",
      "type": "default"
    },
    "rope_theta": 1000000.0,
    "sliding_window": 32768,
    "tie_word_embeddings": true,
    "torch_dtype": "float32",
    "use_cache": false,
    "use_sliding_window": false,
    "video_token_id": null,
    "vision_end_token_id": 151653,
    "vision_start_token_id": 151652,
    "vision_token_id": 151654,
    "vocab_size": 151936
  },
  "torch_dtype": "bfloat16",
  "transformers_version": "4.52.4",
  "use_cache": false,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "depth": 32,
    "embed_dim": 1280,
    "hidden_act": "quick_gelu",
    "hidden_size": 1536,
    "in_channels": 3,
    "in_chans": 3,
    "initializer_range": 0.02,
    "mlp_ratio": 4,
    "model_type": "qwen2_vl",
    "num_heads": 16,
    "patch_size": 14,
    "spatial_merge_size": 2,
    "spatial_patch_size": 14,
    "temporal_patch_size": 2,
    "torch_dtype": "float32"
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 151936
}

INFO 06-30 22:49:16 [config.py:689] This model supports multiple tasks: {'embed', 'generate', 'score', 'classify', 'reward'}. Defaulting to 'generate'.
INFO 06-30 22:49:16 [config.py:1901] Chunked prefill is enabled with max_num_batched_tokens=8192.
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:17,559 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:17,559 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:17,559 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:17,559 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:17,559 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:17,559 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:49:17,559 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:49:17,917 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:1088] 2025-06-30 22:49:18,006 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252/generation_config.json
[INFO|configuration_utils.py:1135] 2025-06-30 22:49:18,006 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

WARNING 06-30 22:49:18 [utils.py:2304] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/getting_started/troubleshooting.html#python-multiprocessing for more information. Reason: CUDA is initialized
INFO 06-30 22:49:25 [__init__.py:239] Automatically detected platform cuda.
INFO 06-30 22:49:28 [core.py:61] Initializing a V1 LLM engine (v0.8.4) with config: model='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252', speculative_config=None, tokenizer='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-30 22:49:29 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7ff11fb91010>
INFO 06-30 22:49:29 [parallel_state.py:959] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-30 22:49:29 [cuda.py:221] Using Flash Attention backend on V1 engine.
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:49:33 [gpu_model_runner.py:1276] Starting to load model saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252...
WARNING 06-30 22:49:33 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-30 22:49:33 [config.py:3466] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
WARNING 06-30 22:49:33 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.57s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:02<00:00,  2.57s/it]

INFO 06-30 22:49:36 [loader.py:458] Loading weights took 2.78 seconds
INFO 06-30 22:49:36 [gpu_model_runner.py:1291] Model loading took 4.1513 GiB and 3.011654 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:49:37 [gpu_model_runner.py:1560] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-30 22:49:51 [backends.py:416] Using cache directory: /root/.cache/vllm/torch_compile_cache/f97c2c3d76/rank_0_0 for vLLM's torch.compile
INFO 06-30 22:49:51 [backends.py:426] Dynamo bytecode transform time: 7.53 s
INFO 06-30 22:49:52 [backends.py:115] Directly load the compiled graph for shape None from the cache
INFO 06-30 22:49:59 [monitor.py:33] torch.compile takes 7.53 s in total
INFO 06-30 22:49:59 [kv_cache_utils.py:634] GPU KV cache size: 1,006,016 tokens
INFO 06-30 22:49:59 [kv_cache_utils.py:637] Maximum concurrency for 6,144 tokens per request: 163.74x
INFO 06-30 22:50:20 [gpu_model_runner.py:1626] Graph capturing finished in 20 secs, took 0.47 GiB
INFO 06-30 22:50:20 [core.py:163] init engine (profile, create kv cache, warmup model) took 44.09 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:50:21 [core_client.py:435] Core engine process 0 ready.
[INFO|2025-06-30 22:50:21] llamafactory.data.loader:143 >> Loading dataset ./0_my_dataset/vindr/qwen2_vindr_input_test_len_2108.json...
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151653, 198, 5598, 30618, 14697, 315, 364, 47, 811, 372, 8767, 269, 706, 6, 5671, 438, 4718, 3561, 510, 73594, 2236, 198, 9640, 4913, 58456, 62, 17, 67, 788, 508, 87, 16, 11, 379, 16, 11, 856, 17, 11, 379, 17, 1125, 330, 1502, 788, 330, 1502, 7115, 9338, 921, 73594, 151645, 198, 151644, 77091, 198]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|vision_end|>
Return bounding boxes of 'Pneumothorax' areas as JSON format:
```json
[
{"bbox_2d": [x1, y1, x2, y2], "label": "label"},
...
]
```<|im_end|>
<|im_start|>assistant

label_ids:
[27, 9217, 397, 9640, 220, 341, 262, 330, 58456, 62, 17, 67, 788, 2278, 414, 220, 16, 22, 20, 345, 414, 220, 17, 22, 24, 345, 414, 220, 18, 15, 17, 345, 414, 220, 21, 23, 16, 198, 262, 3211, 262, 330, 1502, 788, 330, 47, 811, 372, 8767, 269, 706, 698, 220, 456, 921, 522, 9217, 29, 151645, 198]
labels:
<answer>
[
  {
    "bbox_2d": [
      175,
      279,
      302,
      681
    ],
    "label": "Pneumothorax"
  }
]
</answer><|im_end|>

Current file descriptor limits: soft=8192, hard=8192
Initial resource status:
Open files: 0
Memory usage: 944.87 MB
Using effective batch size: 16
Processing batched inference:   0%|          | 0/132 [00:00<?, ?it/s][INFO|image_processing_base.py:378] 2025-06-30 22:50:22,788 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:50:22,789 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|image_processing_base.py:378] 2025-06-30 22:50:22,789 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:50:22,789 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:50:22,790 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:50:22,790 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:50:22,790 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:50:22,790 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:50:22,790 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:50:22,790 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:50:22,790 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:50:23,607 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 22:50:23,608 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 22:50:23,608 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 22:50:24,100 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: CachedQwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-252', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='left', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}


Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 89.42it/s, est. speed input: 35192.68 toks/s, output: 5536.47 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.73it/s, est. speed input: 17198.10 toks/s, output: 2769.21 toks/s]
Processing batched inference:   1%|          | 1/132 [00:04<10:09,  4.65s/it]Resource status after batch 0:
Open files: 0
Memory usage: 1118.72 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 62.44it/s, est. speed input: 24524.53 toks/s, output: 4032.54 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.04it/s, est. speed input: 16515.38 toks/s, output: 2748.98 toks/s]
Processing batched inference:   2%|▏         | 2/132 [00:07<07:44,  3.57s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 76.87it/s, est. speed input: 30176.46 toks/s, output: 4343.28 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.09it/s, est. speed input: 9462.14 toks/s, output: 1436.69 toks/s] 
Processing batched inference:   2%|▏         | 3/132 [00:10<06:58,  3.24s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 103.82it/s, est. speed input: 40778.86 toks/s, output: 6776.82 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.36it/s, est. speed input: 17035.03 toks/s, output: 2848.99 toks/s] 
Processing batched inference:   3%|▎         | 4/132 [00:13<06:34,  3.09s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 86.32it/s, est. speed input: 33921.75 toks/s, output: 4913.56 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.28it/s, est. speed input: 17391.68 toks/s, output: 2510.54 toks/s]
Processing batched inference:   4%|▍         | 5/132 [00:15<06:12,  2.93s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 83.89it/s, est. speed input: 32992.33 toks/s, output: 5145.21 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.61it/s, est. speed input: 16758.40 toks/s, output: 2698.39 toks/s]
Processing batched inference:   5%|▍         | 6/132 [00:18<05:56,  2.83s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 91.51it/s, est. speed input: 35867.10 toks/s, output: 5757.98 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.82it/s, est. speed input: 17564.22 toks/s, output: 2756.82 toks/s]
Processing batched inference:   5%|▌         | 7/132 [00:21<05:46,  2.77s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 95.24it/s, est. speed input: 37419.12 toks/s, output: 5765.92 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.44it/s, est. speed input: 17072.44 toks/s, output: 2604.09 toks/s]
Processing batched inference:   6%|▌         | 8/132 [00:23<05:32,  2.68s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 92.12it/s, est. speed input: 36169.71 toks/s, output: 5934.35 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.85it/s, est. speed input: 8184.17 toks/s, output: 1488.01 toks/s] 
Processing batched inference:   7%|▋         | 9/132 [00:26<05:42,  2.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 82.34it/s, est. speed input: 32335.25 toks/s, output: 5525.85 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.21it/s, est. speed input: 9116.37 toks/s, output: 1798.87 toks/s]
Processing batched inference:   8%|▊         | 10/132 [00:29<05:42,  2.80s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 86.98it/s, est. speed input: 34100.98 toks/s, output: 5197.34 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.39it/s, est. speed input: 16619.11 toks/s, output: 2617.85 toks/s]
Processing batched inference:   8%|▊         | 11/132 [00:31<05:29,  2.72s/it]Resource status after batch 10:
Open files: 0
Memory usage: 2785.20 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 72.61it/s, est. speed input: 28515.07 toks/s, output: 4436.12 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.58it/s, est. speed input: 15544.13 toks/s, output: 2474.34 toks/s]
Processing batched inference:   9%|▉         | 12/132 [00:34<05:19,  2.66s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 89.41it/s, est. speed input: 35129.03 toks/s, output: 5399.05 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.76it/s, est. speed input: 17189.41 toks/s, output: 2609.46 toks/s]
Processing batched inference:  10%|▉         | 13/132 [00:36<05:08,  2.60s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 76.52it/s, est. speed input: 30016.98 toks/s, output: 4878.11 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.37it/s, est. speed input: 10741.87 toks/s, output: 1859.55 toks/s]
Processing batched inference:  11%|█         | 14/132 [00:39<05:17,  2.69s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 74.66it/s, est. speed input: 29316.34 toks/s, output: 4485.62 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.28it/s, est. speed input: 17003.91 toks/s, output: 2580.94 toks/s]
Processing batched inference:  11%|█▏        | 15/132 [00:41<04:54,  2.52s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 68.53it/s, est. speed input: 26929.67 toks/s, output: 4879.72 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.17it/s, est. speed input: 11852.86 toks/s, output: 2246.35 toks/s]
Processing batched inference:  12%|█▏        | 16/132 [00:44<04:57,  2.56s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 69.43it/s, est. speed input: 27220.78 toks/s, output: 3888.40 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.97it/s, est. speed input: 16864.75 toks/s, output: 2422.98 toks/s]
Processing batched inference:  13%|█▎        | 17/132 [00:47<04:53,  2.55s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 55.41it/s, est. speed input: 21761.94 toks/s, output: 3137.93 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 30.84it/s, est. speed input: 13097.60 toks/s, output: 2000.06 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:11<00:00, 30.84it/s, est. speed input: 8721.51 toks/s, output: 1390.32 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.21s/it, est. speed input: 278.72 toks/s, output: 223.53 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.41s/it, est. speed input: 278.72 toks/s, output: 223.53 toks/s]
Processing batched inference:  14%|█▎        | 18/132 [01:11<17:05,  8.99s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 92.27it/s, est. speed input: 36238.51 toks/s, output: 5550.69 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.68it/s, est. speed input: 17552.22 toks/s, output: 2661.80 toks/s]
Processing batched inference:  14%|█▍        | 19/132 [01:13<13:18,  7.06s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 52.34it/s, est. speed input: 20573.36 toks/s, output: 3402.38 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 37.32it/s, est. speed input: 15300.34 toks/s, output: 2658.27 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.43it/s, est. speed input: 9492.47 toks/s, output: 1796.89 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.17it/s, est. speed input: 9492.47 toks/s, output: 1796.89 toks/s]
Processing batched inference:  15%|█▌        | 20/132 [01:16<10:31,  5.64s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 62.53it/s, est. speed input: 24506.99 toks/s, output: 3708.85 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.56it/s, est. speed input: 15112.22 toks/s, output: 2378.84 toks/s]
Processing batched inference:  16%|█▌        | 21/132 [01:18<08:46,  4.74s/it]Resource status after batch 20:
Open files: 0
Memory usage: 4291.70 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 111.36it/s, est. speed input: 43753.03 toks/s, output: 6784.05 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.69it/s, est. speed input: 17158.80 toks/s, output: 2733.63 toks/s] 
Processing batched inference:  17%|█▋        | 22/132 [01:21<07:36,  4.15s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 79.49it/s, est. speed input: 31194.20 toks/s, output: 5160.06 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.30it/s, est. speed input: 16619.85 toks/s, output: 2781.72 toks/s]
Processing batched inference:  17%|█▋        | 23/132 [01:23<06:32,  3.60s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 73.53it/s, est. speed input: 28899.00 toks/s, output: 4551.41 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.73it/s, est. speed input: 17183.79 toks/s, output: 2623.82 toks/s]
Processing batched inference:  18%|█▊        | 24/132 [01:26<05:48,  3.22s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 36.38it/s, est. speed input: 14312.22 toks/s, output: 2086.03 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 25.33it/s, est. speed input: 10530.28 toks/s, output: 1776.83 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 30.79it/s, est. speed input: 11901.95 toks/s, output: 2115.50 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.20it/s, est. speed input: 8729.12 toks/s, output: 1602.86 toks/s] 
Processing batched inference:  19%|█▉        | 25/132 [01:28<05:19,  2.99s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 62.72it/s, est. speed input: 24607.37 toks/s, output: 3529.64 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.65it/s, est. speed input: 11642.89 toks/s, output: 1769.93 toks/s]
Processing batched inference:  20%|█▉        | 26/132 [01:30<04:57,  2.81s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 36.70it/s, est. speed input: 14419.19 toks/s, output: 2087.29 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 33.35it/s, est. speed input: 13340.51 toks/s, output: 2329.98 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.56it/s, est. speed input: 13587.08 toks/s, output: 2550.23 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.63it/s, est. speed input: 13587.08 toks/s, output: 2550.23 toks/s]
Processing batched inference:  20%|██        | 27/132 [01:33<04:32,  2.60s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 101.95it/s, est. speed input: 40016.91 toks/s, output: 5755.80 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.37it/s, est. speed input: 9560.49 toks/s, output: 1582.72 toks/s]  
Processing batched inference:  21%|██        | 28/132 [01:36<04:43,  2.73s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 84.35it/s, est. speed input: 33102.27 toks/s, output: 4757.38 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.07it/s, est. speed input: 10236.40 toks/s, output: 1702.74 toks/s]
Processing batched inference:  22%|██▏       | 29/132 [01:38<04:25,  2.58s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 48.34it/s, est. speed input: 18955.52 toks/s, output: 2954.06 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 33.05it/s, est. speed input: 13815.61 toks/s, output: 2224.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.79it/s, est. speed input: 11299.07 toks/s, output: 1875.00 toks/s]
Processing batched inference:  23%|██▎       | 30/132 [01:40<04:22,  2.58s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 42.42it/s, est. speed input: 16664.64 toks/s, output: 2409.52 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 33.43it/s, est. speed input: 13580.14 toks/s, output: 2140.69 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 35.24it/s, est. speed input: 13961.15 toks/s, output: 2254.03 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.29it/s, est. speed input: 10719.13 toks/s, output: 1869.20 toks/s]
Processing batched inference:  23%|██▎       | 31/132 [01:42<04:04,  2.42s/it]Resource status after batch 30:
Open files: 0
Memory usage: 5571.36 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 69.03it/s, est. speed input: 27115.55 toks/s, output: 3919.33 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.86it/s, est. speed input: 10127.78 toks/s, output: 1855.44 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.76it/s, est. speed input: 10127.78 toks/s, output: 1855.44 toks/s]
Processing batched inference:  24%|██▍       | 32/132 [01:45<04:11,  2.52s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 39.22it/s, est. speed input: 15409.76 toks/s, output: 2227.91 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 27.97it/s, est. speed input: 11531.17 toks/s, output: 1808.05 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 23.12it/s, est. speed input: 9734.31 toks/s, output: 1562.88 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.89it/s, est. speed input: 9385.04 toks/s, output: 1572.11 toks/s]
Processing batched inference:  25%|██▌       | 33/132 [01:48<04:06,  2.49s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 72.20it/s, est. speed input: 28351.34 toks/s, output: 4089.25 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:04<00:00,  3.85it/s, est. speed input: 1511.01 toks/s, output: 428.52 toks/s]  
Processing batched inference:  26%|██▌       | 34/132 [01:54<05:45,  3.53s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 93.10it/s, est. speed input: 36575.53 toks/s, output: 5735.24 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.24it/s, est. speed input: 17365.04 toks/s, output: 3019.91 toks/s]
Processing batched inference:  27%|██▋       | 35/132 [01:56<05:11,  3.21s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 78.28it/s, est. speed input: 30751.11 toks/s, output: 5253.69 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.43it/s, est. speed input: 16667.16 toks/s, output: 2654.89 toks/s]
Processing batched inference:  27%|██▋       | 36/132 [01:59<04:48,  3.01s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 77.89it/s, est. speed input: 30572.58 toks/s, output: 5210.29 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.96it/s, est. speed input: 14504.66 toks/s, output: 2518.27 toks/s]
Processing batched inference:  28%|██▊       | 37/132 [02:01<04:30,  2.84s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 98.41it/s, est. speed input: 38723.04 toks/s, output: 6613.71 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.32it/s, est. speed input: 15855.55 toks/s, output: 2553.05 toks/s]
Processing batched inference:  29%|██▉       | 38/132 [02:03<04:11,  2.67s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 94.73it/s, est. speed input: 37251.54 toks/s, output: 5409.11 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.54it/s, est. speed input: 15939.95 toks/s, output: 2554.38 toks/s]
Processing batched inference:  30%|██▉       | 39/132 [02:05<03:49,  2.47s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 57.27it/s, est. speed input: 22463.48 toks/s, output: 3216.83 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 34.33it/s, est. speed input: 14349.61 toks/s, output: 2219.02 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.94it/s, est. speed input: 9255.11 toks/s, output: 1547.61 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.55it/s, est. speed input: 9255.11 toks/s, output: 1547.61 toks/s]
Processing batched inference:  30%|███       | 40/132 [02:08<03:42,  2.41s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 29.41it/s, est. speed input: 11552.85 toks/s, output: 1670.45 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 23.24it/s, est. speed input: 9487.07 toks/s, output: 1493.92 toks/s] [A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 33.94it/s, est. speed input: 12330.90 toks/s, output: 1987.79 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 35.88it/s, est. speed input: 14091.86 toks/s, output: 2245.05 toks/s]
Processing batched inference:  31%|███       | 41/132 [02:09<03:25,  2.26s/it]Resource status after batch 40:
Open files: 0
Memory usage: 6746.34 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 64.20it/s, est. speed input: 25222.93 toks/s, output: 3911.08 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.17it/s, est. speed input: 16552.78 toks/s, output: 2511.83 toks/s]
Processing batched inference:  32%|███▏      | 42/132 [02:12<03:30,  2.33s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 116.86it/s, est. speed input: 45852.36 toks/s, output: 7425.54 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.99it/s, est. speed input: 10195.68 toks/s, output: 1691.12 toks/s] 
Processing batched inference:  33%|███▎      | 43/132 [02:15<03:36,  2.43s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 59.75it/s, est. speed input: 23509.83 toks/s, output: 4082.87 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 26.66it/s, est. speed input: 11646.86 toks/s, output: 2171.76 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.63it/s, est. speed input: 11647.00 toks/s, output: 2220.45 toks/s]
Processing batched inference:  33%|███▎      | 44/132 [02:17<03:31,  2.41s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 13.03it/s, est. speed input: 5111.59 toks/s, output: 733.91 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 41.17it/s, est. speed input: 13928.93 toks/s, output: 2022.64 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.30it/s, est. speed input: 11903.93 toks/s, output: 1899.61 toks/s]
Processing batched inference:  34%|███▍      | 45/132 [02:19<03:17,  2.27s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 43.72it/s, est. speed input: 17134.96 toks/s, output: 2439.87 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 36.23it/s, est. speed input: 14577.53 toks/s, output: 2431.90 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.98it/s, est. speed input: 13508.38 toks/s, output: 2285.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.58it/s, est. speed input: 11208.64 toks/s, output: 2027.65 toks/s]
Processing batched inference:  35%|███▍      | 46/132 [02:21<03:06,  2.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 21.51it/s, est. speed input: 8453.48 toks/s, output: 1225.95 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 40.89it/s, est. speed input: 15039.71 toks/s, output: 2313.96 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.00it/s, est. speed input: 12491.21 toks/s, output: 2075.50 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.80it/s, est. speed input: 12491.21 toks/s, output: 2075.50 toks/s]
Processing batched inference:  36%|███▌      | 47/132 [02:23<02:58,  2.09s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 69.74it/s, est. speed input: 27404.12 toks/s, output: 4393.99 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 37.68it/s, est. speed input: 15959.38 toks/s, output: 2673.37 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.33it/s, est. speed input: 11506.25 toks/s, output: 2161.15 toks/s]
Processing batched inference:  36%|███▋      | 48/132 [02:25<03:04,  2.20s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 23.12it/s, est. speed input: 9073.91 toks/s, output: 1306.10 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 34.85it/s, est. speed input: 12802.58 toks/s, output: 1835.05 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 31.23it/s, est. speed input: 12086.81 toks/s, output: 1957.55 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.04it/s, est. speed input: 7862.37 toks/s, output: 1426.42 toks/s] 
Processing batched inference:  37%|███▋      | 49/132 [02:27<03:01,  2.18s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 66.51it/s, est. speed input: 26143.19 toks/s, output: 4247.42 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 44.22it/s, est. speed input: 18292.69 toks/s, output: 2806.89 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:10<00:00, 44.22it/s, est. speed input: 15737.01 toks/s, output: 2403.65 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.14s/it, est. speed input: 283.50 toks/s, output: 225.35 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.39s/it, est. speed input: 283.50 toks/s, output: 225.35 toks/s]
Processing batched inference:  38%|███▊      | 50/132 [02:51<11:48,  8.64s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 78.68it/s, est. speed input: 30929.52 toks/s, output: 4485.11 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.26it/s, est. speed input: 9149.53 toks/s, output: 1545.74 toks/s]
Processing batched inference:  39%|███▊      | 51/132 [02:53<09:03,  6.71s/it]Resource status after batch 50:
Open files: 0
Memory usage: 7741.13 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 50.91it/s, est. speed input: 19942.81 toks/s, output: 3215.98 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 33.80it/s, est. speed input: 13974.58 toks/s, output: 2292.91 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.82it/s, est. speed input: 15254.00 toks/s, output: 2436.23 toks/s]
Processing batched inference:  39%|███▉      | 52/132 [02:56<07:09,  5.37s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.98it/s, est. speed input: 2356.98 toks/s, output: 346.93 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  9.37it/s, est. speed input: 3480.68 toks/s, output: 502.29 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 21.37it/s, est. speed input: 6840.85 toks/s, output: 984.71 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 23.61it/s, est. speed input: 7863.91 toks/s, output: 1213.36 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.17it/s, est. speed input: 8191.38 toks/s, output: 1425.42 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.86it/s, est. speed input: 8191.38 toks/s, output: 1425.42 toks/s]
Processing batched inference:  40%|████      | 53/132 [02:58<05:46,  4.38s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01, 11.24it/s, est. speed input: 4413.80 toks/s, output: 635.31 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 28.25it/s, est. speed input: 9970.77 toks/s, output: 1446.08 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 27.07it/s, est. speed input: 9999.43 toks/s, output: 1534.87 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.24it/s, est. speed input: 8942.35 toks/s, output: 1415.15 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.77it/s, est. speed input: 8942.35 toks/s, output: 1415.15 toks/s]
Processing batched inference:  41%|████      | 54/132 [02:59<04:42,  3.62s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 32.32it/s, est. speed input: 12677.86 toks/s, output: 1817.87 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 17.70it/s, est. speed input: 7453.70 toks/s, output: 1072.92 toks/s] [A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 22.12it/s, est. speed input: 8599.09 toks/s, output: 1323.94 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.60it/s, est. speed input: 8491.37 toks/s, output: 1485.26 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.62it/s, est. speed input: 8491.37 toks/s, output: 1485.26 toks/s]
Processing batched inference:  42%|████▏     | 55/132 [03:02<04:03,  3.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 34.66it/s, est. speed input: 13620.91 toks/s, output: 1975.40 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 27.80it/s, est. speed input: 11283.13 toks/s, output: 1622.77 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 24.14it/s, est. speed input: 9980.46 toks/s, output: 1521.31 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.36it/s, est. speed input: 10355.80 toks/s, output: 1655.90 toks/s]
Processing batched inference:  42%|████▏     | 56/132 [03:04<03:37,  2.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.32it/s, est. speed input: 905.38 toks/s, output: 127.35 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 24.52it/s, est. speed input: 8081.54 toks/s, output: 1233.06 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.42it/s, est. speed input: 8024.00 toks/s, output: 1284.13 toks/s]
Processing batched inference:  43%|████▎     | 57/132 [03:05<03:07,  2.50s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 41.98it/s, est. speed input: 16487.14 toks/s, output: 2378.93 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 35.60it/s, est. speed input: 14301.12 toks/s, output: 2343.96 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.19it/s, est. speed input: 9237.23 toks/s, output: 1547.35 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.51it/s, est. speed input: 9237.23 toks/s, output: 1547.35 toks/s]
Processing batched inference:  44%|████▍     | 58/132 [03:08<03:04,  2.49s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 42.41it/s, est. speed input: 16639.71 toks/s, output: 2387.17 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 34.45it/s, est. speed input: 13976.10 toks/s, output: 2006.71 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.37it/s, est. speed input: 9699.29 toks/s, output: 1535.90 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.72it/s, est. speed input: 9699.29 toks/s, output: 1535.90 toks/s]
Processing batched inference:  45%|████▍     | 59/132 [03:10<02:48,  2.31s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.31it/s, est. speed input: 1684.98 toks/s, output: 237.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 27.70it/s, est. speed input: 9060.72 toks/s, output: 1326.36 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 26.31it/s, est. speed input: 9397.09 toks/s, output: 1445.54 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:18<00:00, 26.31it/s, est. speed input: 8930.02 toks/s, output: 1432.75 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.24s/it, est. speed input: 278.30 toks/s, output: 223.19 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.41s/it, est. speed input: 278.30 toks/s, output: 223.19 toks/s]
Processing batched inference:  45%|████▌     | 60/132 [03:33<10:25,  8.69s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.84it/s, est. speed input: 1511.93 toks/s, output: 222.55 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 12.58it/s, est. speed input: 4212.08 toks/s, output: 601.71 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 24.71it/s, est. speed input: 7456.58 toks/s, output: 1070.63 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 25.82it/s, est. speed input: 8233.74 toks/s, output: 1251.65 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.14it/s, est. speed input: 8293.22 toks/s, output: 1435.04 toks/s]
Processing batched inference:  46%|████▌     | 61/132 [03:35<07:50,  6.62s/it]Resource status after batch 60:
Open files: 0
Memory usage: 8428.23 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 16.80it/s, est. speed input: 6578.63 toks/s, output: 932.51 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 24.18it/s, est. speed input: 9146.49 toks/s, output: 1315.15 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 35.27it/s, est. speed input: 12467.01 toks/s, output: 1892.81 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 35.43it/s, est. speed input: 13906.08 toks/s, output: 2101.36 toks/s]
Processing batched inference:  47%|████▋     | 62/132 [03:37<05:58,  5.12s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 23.51it/s, est. speed input: 9218.47 toks/s, output: 1316.80 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 31.46it/s, est. speed input: 11935.47 toks/s, output: 1710.79 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 37.60it/s, est. speed input: 13743.05 toks/s, output: 2073.80 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.45it/s, est. speed input: 12328.97 toks/s, output: 1946.01 toks/s]
Processing batched inference:  48%|████▊     | 63/132 [03:38<04:43,  4.11s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.74it/s, est. speed input: 1074.30 toks/s, output: 153.47 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 26.21it/s, est. speed input: 8694.51 toks/s, output: 1324.06 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.97it/s, est. speed input: 9415.47 toks/s, output: 1574.72 toks/s]
Processing batched inference:  48%|████▊     | 64/132 [03:40<03:46,  3.33s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 37.53it/s, est. speed input: 14749.71 toks/s, output: 2139.03 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 29.03it/s, est. speed input: 11795.72 toks/s, output: 1866.97 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 35.00it/s, est. speed input: 13427.08 toks/s, output: 2055.13 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.40it/s, est. speed input: 9200.51 toks/s, output: 1544.84 toks/s] 
Processing batched inference:  49%|████▉     | 65/132 [03:42<03:19,  2.98s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.05it/s, est. speed input: 2379.23 toks/s, output: 345.05 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 18.76it/s, est. speed input: 6539.46 toks/s, output: 939.88 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 24.09it/s, est. speed input: 8272.52 toks/s, output: 1195.80 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 35.44it/s, est. speed input: 11149.64 toks/s, output: 2068.77 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.71it/s, est. speed input: 10501.96 toks/s, output: 2005.17 toks/s]
Processing batched inference:  50%|█████     | 66/132 [03:44<02:54,  2.65s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 59.35it/s, est. speed input: 23369.68 toks/s, output: 3422.64 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 29.19it/s, est. speed input: 12431.56 toks/s, output: 1943.26 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.97it/s, est. speed input: 9448.72 toks/s, output: 1749.56 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.00it/s, est. speed input: 9448.72 toks/s, output: 1749.56 toks/s]
Processing batched inference:  51%|█████     | 67/132 [03:46<02:44,  2.53s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 53.03it/s, est. speed input: 20845.51 toks/s, output: 3022.94 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 33.25it/s, est. speed input: 13882.01 toks/s, output: 2120.35 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.84it/s, est. speed input: 10138.79 toks/s, output: 1608.48 toks/s]
Processing batched inference:  52%|█████▏    | 68/132 [03:48<02:33,  2.39s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01, 11.58it/s, est. speed input: 4550.46 toks/s, output: 659.94 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 14.74it/s, est. speed input: 5544.96 toks/s, output: 945.36 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 31.55it/s, est. speed input: 10310.50 toks/s, output: 1582.49 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 30.98it/s, est. speed input: 10668.54 toks/s, output: 1859.38 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:03<00:00,  4.35it/s, est. speed input: 1706.17 toks/s, output: 468.98 toks/s]  
Processing batched inference:  52%|█████▏    | 69/132 [03:53<03:19,  3.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.22it/s, est. speed input: 2052.56 toks/s, output: 297.65 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01, 11.22it/s, est. speed input: 3960.05 toks/s, output: 577.18 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 17.57it/s, est. speed input: 5783.22 toks/s, output: 840.83 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 34.41it/s, est. speed input: 10095.75 toks/s, output: 1548.33 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.45it/s, est. speed input: 8817.16 toks/s, output: 1464.81 toks/s] 
Processing batched inference:  53%|█████▎    | 70/132 [03:55<02:52,  2.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.99it/s, est. speed input: 1164.78 toks/s, output: 161.26 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 25.88it/s, est. speed input: 8632.48 toks/s, output: 1320.89 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.88it/s, est. speed input: 9769.31 toks/s, output: 1698.17 toks/s]
Processing batched inference:  54%|█████▍    | 71/132 [03:57<02:29,  2.46s/it]Resource status after batch 70:
Open files: 0
Memory usage: 8934.59 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 30.86it/s, est. speed input: 12138.04 toks/s, output: 1765.51 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 34.83it/s, est. speed input: 13386.00 toks/s, output: 1928.37 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 26.79it/s, est. speed input: 11129.65 toks/s, output: 1601.13 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.18it/s, est. speed input: 11846.82 toks/s, output: 1788.58 toks/s]
Processing batched inference:  55%|█████▍    | 72/132 [03:59<02:20,  2.35s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.07it/s, est. speed input: 1597.55 toks/s, output: 228.20 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 29.14it/s, est. speed input: 9663.42 toks/s, output: 1397.31 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 29.87it/s, est. speed input: 10270.31 toks/s, output: 1814.24 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.94it/s, est. speed input: 11357.48 toks/s, output: 2141.58 toks/s]
Processing batched inference:  55%|█████▌    | 73/132 [04:01<02:05,  2.12s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.24it/s, est. speed input: 2049.68 toks/s, output: 288.30 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 18.03it/s, est. speed input: 6169.55 toks/s, output: 884.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 34.95it/s, est. speed input: 10958.43 toks/s, output: 1577.41 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.81it/s, est. speed input: 8780.89 toks/s, output: 1524.53 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.37it/s, est. speed input: 8780.89 toks/s, output: 1524.53 toks/s]
Processing batched inference:  56%|█████▌    | 74/132 [04:02<01:59,  2.05s/it]ERROR 06-30 22:54:26 [core.py:387] EngineCore hit an exception: Traceback (most recent call last):
ERROR 06-30 22:54:26 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 68, in __getitem__
ERROR 06-30 22:54:26 [core.py:387]     return self.__data[key]
ERROR 06-30 22:54:26 [core.py:387]            ~~~~~~~~~~~^^^^^
ERROR 06-30 22:54:26 [core.py:387] KeyError: '6dbdee3cd08910062fe158451e8b377cb53f6abd78a4d22790d067e6af1da47e'
ERROR 06-30 22:54:26 [core.py:387] 
ERROR 06-30 22:54:26 [core.py:387] During handling of the above exception, another exception occurred:
ERROR 06-30 22:54:26 [core.py:387] 
ERROR 06-30 22:54:26 [core.py:387] Traceback (most recent call last):
ERROR 06-30 22:54:26 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 380, in run_engine_core
ERROR 06-30 22:54:26 [core.py:387]     engine_core.run_busy_loop()
ERROR 06-30 22:54:26 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 400, in run_busy_loop
ERROR 06-30 22:54:26 [core.py:387]     self._process_input_queue()
ERROR 06-30 22:54:26 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 425, in _process_input_queue
ERROR 06-30 22:54:26 [core.py:387]     self._handle_client_request(*req)
ERROR 06-30 22:54:26 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 441, in _handle_client_request
ERROR 06-30 22:54:26 [core.py:387]     self.add_request(request)
ERROR 06-30 22:54:26 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 177, in add_request
ERROR 06-30 22:54:26 [core.py:387]     request.mm_inputs = self.mm_input_cache_server.get_and_update_p1(
ERROR 06-30 22:54:26 [core.py:387]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 22:54:26 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/mm_input_cache.py", line 76, in get_and_update_p1
ERROR 06-30 22:54:26 [core.py:387]     mm_input = self.mm_cache[mm_hash]
ERROR 06-30 22:54:26 [core.py:387]                ~~~~~~~~~~~~~^^^^^^^^^
ERROR 06-30 22:54:26 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 211, in __getitem__
ERROR 06-30 22:54:26 [core.py:387]     value = cache_getitem(self, key)
ERROR 06-30 22:54:26 [core.py:387]             ^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 22:54:26 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 70, in __getitem__
ERROR 06-30 22:54:26 [core.py:387]     return self.__missing__(key)
ERROR 06-30 22:54:26 [core.py:387]            ^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 22:54:26 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 97, in __missing__
ERROR 06-30 22:54:26 [core.py:387]     raise KeyError(key)
ERROR 06-30 22:54:26 [core.py:387] KeyError: '6dbdee3cd08910062fe158451e8b377cb53f6abd78a4d22790d067e6af1da47e'
ERROR 06-30 22:54:26 [core.py:387] 
CRITICAL 06-30 22:54:26 [core_client.py:359] Got fatal signal from worker processes, shutting down. See stack trace above for root cause issue.
batch_inference.sh: line 23: 453704 Killed                  python scripts/vllm_infer_new.py --model_name_or_path "$ckpt" --dataset $EVAL_DATASET --template qwen2_vl --save_name "$save_path/generated_predictions.jsonl" --max_new_tokens 4096 --temperature 0.0 --top_p 1.0 --top_k -1 --repetition_penalty 1.0 --batch_size 16 --seed 42
Running inference on checkpoint: checkpoint-315
INFO 06-30 22:54:35 [__init__.py:239] Automatically detected platform cuda.
[INFO|training_args.py:2135] 2025-06-30 22:54:37,300 >> PyTorch: setting up devices
[INFO|training_args.py:1812] 2025-06-30 22:54:37,348 >> The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,365 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,365 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,365 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,365 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,365 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,365 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,365 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:54:37,757 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:378] 2025-06-30 22:54:37,758 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315/preprocessor_config.json
[INFO|image_processing_base.py:378] 2025-06-30 22:54:37,763 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:54:37,770 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,770 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,770 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,770 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,770 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,770 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,770 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:37,770 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:54:38,150 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 22:54:38,151 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 22:54:38,349 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 22:54:38,784 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}

[INFO|configuration_utils.py:696] 2025-06-30 22:54:38,838 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315/config.json
[INFO|configuration_utils.py:696] 2025-06-30 22:54:38,839 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315/config.json
[INFO|configuration_utils.py:770] 2025-06-30 22:54:38,841 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "text_config": {
    "architectures": [
      "Qwen2VLForConditionalGeneration"
    ],
    "attention_dropout": 0.0,
    "bos_token_id": 151643,
    "eos_token_id": 151645,
    "hidden_act": "silu",
    "hidden_size": 1536,
    "image_token_id": null,
    "initializer_range": 0.02,
    "intermediate_size": 8960,
    "max_position_embeddings": 32768,
    "max_window_layers": 28,
    "model_type": "qwen2_vl_text",
    "num_attention_heads": 12,
    "num_hidden_layers": 28,
    "num_key_value_heads": 2,
    "rms_norm_eps": 1e-06,
    "rope_scaling": {
      "mrope_section": [
        16,
        24,
        24
      ],
      "rope_type": "default",
      "type": "default"
    },
    "rope_theta": 1000000.0,
    "sliding_window": 32768,
    "tie_word_embeddings": true,
    "torch_dtype": "float32",
    "use_cache": false,
    "use_sliding_window": false,
    "video_token_id": null,
    "vision_end_token_id": 151653,
    "vision_start_token_id": 151652,
    "vision_token_id": 151654,
    "vocab_size": 151936
  },
  "torch_dtype": "bfloat16",
  "transformers_version": "4.52.4",
  "use_cache": false,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "depth": 32,
    "embed_dim": 1280,
    "hidden_act": "quick_gelu",
    "hidden_size": 1536,
    "in_channels": 3,
    "in_chans": 3,
    "initializer_range": 0.02,
    "mlp_ratio": 4,
    "model_type": "qwen2_vl",
    "num_heads": 16,
    "patch_size": 14,
    "spatial_merge_size": 2,
    "spatial_patch_size": 14,
    "temporal_patch_size": 2,
    "torch_dtype": "float32"
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 151936
}

INFO 06-30 22:54:50 [config.py:689] This model supports multiple tasks: {'score', 'embed', 'generate', 'reward', 'classify'}. Defaulting to 'generate'.
INFO 06-30 22:54:50 [config.py:1901] Chunked prefill is enabled with max_num_batched_tokens=8192.
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:51,373 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:51,373 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:51,373 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:51,374 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:51,374 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:51,374 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:54:51,374 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:54:51,720 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:1088] 2025-06-30 22:54:51,809 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315/generation_config.json
[INFO|configuration_utils.py:1135] 2025-06-30 22:54:51,810 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

WARNING 06-30 22:54:51 [utils.py:2304] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/getting_started/troubleshooting.html#python-multiprocessing for more information. Reason: CUDA is initialized
INFO 06-30 22:54:59 [__init__.py:239] Automatically detected platform cuda.
INFO 06-30 22:55:02 [core.py:61] Initializing a V1 LLM engine (v0.8.4) with config: model='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315', speculative_config=None, tokenizer='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-30 22:55:03 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fd72d32f710>
INFO 06-30 22:55:03 [parallel_state.py:959] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-30 22:55:03 [cuda.py:221] Using Flash Attention backend on V1 engine.
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:55:06 [gpu_model_runner.py:1276] Starting to load model saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315...
WARNING 06-30 22:55:06 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-30 22:55:06 [config.py:3466] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
WARNING 06-30 22:55:07 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.33s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.33s/it]

INFO 06-30 22:55:14 [loader.py:458] Loading weights took 7.54 seconds
INFO 06-30 22:55:14 [gpu_model_runner.py:1291] Model loading took 4.1513 GiB and 7.727549 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:55:15 [gpu_model_runner.py:1560] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-30 22:55:30 [backends.py:416] Using cache directory: /root/.cache/vllm/torch_compile_cache/64740082b7/rank_0_0 for vLLM's torch.compile
INFO 06-30 22:55:30 [backends.py:426] Dynamo bytecode transform time: 7.57 s
INFO 06-30 22:55:30 [backends.py:115] Directly load the compiled graph for shape None from the cache
INFO 06-30 22:55:38 [monitor.py:33] torch.compile takes 7.57 s in total
INFO 06-30 22:55:38 [kv_cache_utils.py:634] GPU KV cache size: 1,006,016 tokens
INFO 06-30 22:55:38 [kv_cache_utils.py:637] Maximum concurrency for 6,144 tokens per request: 163.74x
INFO 06-30 22:55:58 [gpu_model_runner.py:1626] Graph capturing finished in 20 secs, took 0.47 GiB
INFO 06-30 22:55:58 [core.py:163] init engine (profile, create kv cache, warmup model) took 43.92 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 22:55:59 [core_client.py:435] Core engine process 0 ready.
[INFO|2025-06-30 22:55:59] llamafactory.data.loader:143 >> Loading dataset ./0_my_dataset/vindr/qwen2_vindr_input_test_len_2108.json...
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151653, 198, 5598, 30618, 14697, 315, 364, 47, 811, 372, 8767, 269, 706, 6, 5671, 438, 4718, 3561, 510, 73594, 2236, 198, 9640, 4913, 58456, 62, 17, 67, 788, 508, 87, 16, 11, 379, 16, 11, 856, 17, 11, 379, 17, 1125, 330, 1502, 788, 330, 1502, 7115, 9338, 921, 73594, 151645, 198, 151644, 77091, 198]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|vision_end|>
Return bounding boxes of 'Pneumothorax' areas as JSON format:
```json
[
{"bbox_2d": [x1, y1, x2, y2], "label": "label"},
...
]
```<|im_end|>
<|im_start|>assistant

label_ids:
[27, 9217, 397, 9640, 220, 341, 262, 330, 58456, 62, 17, 67, 788, 2278, 414, 220, 16, 22, 20, 345, 414, 220, 17, 22, 24, 345, 414, 220, 18, 15, 17, 345, 414, 220, 21, 23, 16, 198, 262, 3211, 262, 330, 1502, 788, 330, 47, 811, 372, 8767, 269, 706, 698, 220, 456, 921, 522, 9217, 29, 151645, 198]
labels:
<answer>
[
  {
    "bbox_2d": [
      175,
      279,
      302,
      681
    ],
    "label": "Pneumothorax"
  }
]
</answer><|im_end|>

Current file descriptor limits: soft=8192, hard=8192
Initial resource status:
Open files: 0
Memory usage: 928.41 MB
Using effective batch size: 16
Processing batched inference:   0%|          | 0/132 [00:00<?, ?it/s][INFO|image_processing_base.py:378] 2025-06-30 22:56:01,276 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:56:01,276 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|image_processing_base.py:378] 2025-06-30 22:56:01,276 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 22:56:01,277 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:56:01,277 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:56:01,277 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:56:01,277 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:56:01,277 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:56:01,277 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:56:01,277 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 22:56:01,277 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 22:56:02,091 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 22:56:02,092 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 22:56:02,092 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 22:56:02,585 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: CachedQwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-315', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='left', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}


Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 92.16it/s, est. speed input: 36268.10 toks/s, output: 5675.50 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.97it/s, est. speed input: 16506.19 toks/s, output: 2647.30 toks/s]
Processing batched inference:   1%|          | 1/132 [00:04<09:39,  4.42s/it]Resource status after batch 0:
Open files: 0
Memory usage: 1056.55 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 53.60it/s, est. speed input: 21054.41 toks/s, output: 3461.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.37it/s, est. speed input: 15465.21 toks/s, output: 2576.63 toks/s]
Processing batched inference:   2%|▏         | 2/132 [00:07<07:26,  3.43s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 74.35it/s, est. speed input: 29179.84 toks/s, output: 4191.13 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.59it/s, est. speed input: 9656.34 toks/s, output: 1541.46 toks/s] 
Processing batched inference:   2%|▏         | 3/132 [00:09<06:43,  3.13s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 100.18it/s, est. speed input: 39353.63 toks/s, output: 6976.66 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.88it/s, est. speed input: 11737.72 toks/s, output: 2144.27 toks/s] 
Processing batched inference:   3%|▎         | 4/132 [00:12<06:25,  3.01s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 72.93it/s, est. speed input: 28682.42 toks/s, output: 4501.60 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.52it/s, est. speed input: 17094.71 toks/s, output: 2851.30 toks/s]
Processing batched inference:   4%|▍         | 5/132 [00:15<06:06,  2.88s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 101.77it/s, est. speed input: 40046.30 toks/s, output: 6744.59 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.74it/s, est. speed input: 16810.23 toks/s, output: 2834.95 toks/s] 
Processing batched inference:   5%|▍         | 6/132 [00:18<05:52,  2.80s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 65.51it/s, est. speed input: 25675.78 toks/s, output: 4553.00 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.94it/s, est. speed input: 9382.23 toks/s, output: 1607.32 toks/s] 
Processing batched inference:   5%|▌         | 7/132 [00:20<05:44,  2.75s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 101.08it/s, est. speed input: 39731.39 toks/s, output: 5752.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.74it/s, est. speed input: 10116.83 toks/s, output: 1539.93 toks/s] 
Processing batched inference:   6%|▌         | 8/132 [00:23<05:33,  2.69s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 64.88it/s, est. speed input: 25474.14 toks/s, output: 3990.16 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.37it/s, est. speed input: 10352.49 toks/s, output: 1969.59 toks/s]
Processing batched inference:   7%|▋         | 9/132 [00:25<05:30,  2.69s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 84.01it/s, est. speed input: 32980.56 toks/s, output: 5536.75 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.33it/s, est. speed input: 10343.80 toks/s, output: 1884.65 toks/s]
Processing batched inference:   8%|▊         | 10/132 [00:28<05:24,  2.66s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 88.98it/s, est. speed input: 34884.19 toks/s, output: 5291.05 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:19<00:00, 88.98it/s, est. speed input: 19794.28 toks/s, output: 2976.24 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.87s/it, est. speed input: 277.33 toks/s, output: 220.20 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.41s/it, est. speed input: 277.33 toks/s, output: 220.20 toks/s]
Processing batched inference:   8%|▊         | 11/132 [00:53<18:56,  9.39s/it]Resource status after batch 10:
Open files: 0
Memory usage: 2603.94 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 62.48it/s, est. speed input: 24533.01 toks/s, output: 4089.45 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.49it/s, est. speed input: 15113.10 toks/s, output: 2518.78 toks/s]
Processing batched inference:   9%|▉         | 12/132 [00:55<14:33,  7.28s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 69.45it/s, est. speed input: 27276.34 toks/s, output: 4223.88 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.17it/s, est. speed input: 16959.22 toks/s, output: 2839.01 toks/s]
Processing batched inference:  10%|▉         | 13/132 [00:58<11:32,  5.82s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 60.86it/s, est. speed input: 23877.57 toks/s, output: 3816.90 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 33.57it/s, est. speed input: 14115.42 toks/s, output: 2370.00 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.84it/s, est. speed input: 10535.83 toks/s, output: 1904.43 toks/s]
Processing batched inference:  11%|█         | 14/132 [01:00<09:27,  4.81s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 63.26it/s, est. speed input: 24831.20 toks/s, output: 4112.05 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:17<00:00, 63.26it/s, est. speed input: 5716.95 toks/s, output: 1108.03 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.76s/it, est. speed input: 280.73 toks/s, output: 233.96 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.40s/it, est. speed input: 280.73 toks/s, output: 233.96 toks/s]
Processing batched inference:  11%|█▏        | 15/132 [01:24<20:48, 10.67s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 61.65it/s, est. speed input: 24225.54 toks/s, output: 4389.75 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.50it/s, est. speed input: 11192.74 toks/s, output: 2294.07 toks/s]
Processing batched inference:  12%|█▏        | 16/132 [01:27<15:58,  8.26s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 77.52it/s, est. speed input: 30415.98 toks/s, output: 4754.45 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.30it/s, est. speed input: 13066.36 toks/s, output: 2166.57 toks/s]
Processing batched inference:  13%|█▎        | 17/132 [01:30<12:30,  6.53s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 52.59it/s, est. speed input: 20639.35 toks/s, output: 3313.12 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 29.78it/s, est. speed input: 12574.55 toks/s, output: 2167.96 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:18<00:00, 29.78it/s, est. speed input: 8804.22 toks/s, output: 1612.98 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:20<00:00,  1.96s/it, est. speed input: 299.27 toks/s, output: 232.61 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:20<00:00,  1.31s/it, est. speed input: 299.27 toks/s, output: 232.61 toks/s]
Processing batched inference:  14%|█▎        | 18/132 [01:52<21:35, 11.37s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 95.81it/s, est. speed input: 37614.80 toks/s, output: 5844.66 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:15<00:00, 95.81it/s, est. speed input: 9289.08 toks/s, output: 1485.34 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.70s/it, est. speed input: 284.61 toks/s, output: 228.17 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.38s/it, est. speed input: 284.61 toks/s, output: 228.17 toks/s]
Processing batched inference:  14%|█▍        | 19/132 [02:16<28:32, 15.15s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.31it/s, est. speed input: 1296.01 toks/s, output: 185.13 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  7.62it/s, est. speed input: 2650.19 toks/s, output: 379.54 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 25.94it/s, est. speed input: 7635.86 toks/s, output: 1173.73 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 24.78it/s, est. speed input: 7832.39 toks/s, output: 1376.77 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.98it/s, est. speed input: 8237.97 toks/s, output: 1495.17 toks/s]
Processing batched inference:  15%|█▌        | 20/132 [02:18<20:48, 11.15s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 68.97it/s, est. speed input: 27037.22 toks/s, output: 4402.44 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.89it/s, est. speed input: 10539.07 toks/s, output: 1820.35 toks/s]
Processing batched inference:  16%|█▌        | 21/132 [02:21<15:53,  8.59s/it]Resource status after batch 20:
Open files: 0
Memory usage: 4081.33 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 92.16it/s, est. speed input: 36214.05 toks/s, output: 6580.31 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.83it/s, est. speed input: 16822.29 toks/s, output: 3068.23 toks/s]
Processing batched inference:  17%|█▋        | 22/132 [02:23<12:23,  6.76s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 69.40it/s, est. speed input: 27224.64 toks/s, output: 3905.19 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.98it/s, est. speed input: 9814.33 toks/s, output: 1647.39 toks/s] 
Processing batched inference:  17%|█▋        | 23/132 [02:26<09:59,  5.50s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 45.45it/s, est. speed input: 17872.60 toks/s, output: 2969.45 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 31.77it/s, est. speed input: 13138.10 toks/s, output: 2493.86 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:11<00:00, 31.77it/s, est. speed input: 15697.69 toks/s, output: 2785.69 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.92s/it, est. speed input: 285.08 toks/s, output: 233.16 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.38s/it, est. speed input: 285.08 toks/s, output: 233.16 toks/s]
Processing batched inference:  18%|█▊        | 24/132 [02:49<19:49, 11.01s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 38.27it/s, est. speed input: 15053.63 toks/s, output: 2194.09 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 24.41it/s, est. speed input: 10260.28 toks/s, output: 1728.70 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 29.78it/s, est. speed input: 11595.19 toks/s, output: 2059.00 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.36it/s, est. speed input: 8789.35 toks/s, output: 1612.51 toks/s] 
Processing batched inference:  19%|█▉        | 25/132 [02:52<15:03,  8.45s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 82.14it/s, est. speed input: 32247.87 toks/s, output: 5056.09 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.54it/s, est. speed input: 11993.93 toks/s, output: 1997.03 toks/s]
Processing batched inference:  20%|█▉        | 26/132 [02:54<11:37,  6.58s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 30.97it/s, est. speed input: 12173.25 toks/s, output: 1757.55 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 19.95it/s, est. speed input: 8284.34 toks/s, output: 1330.19 toks/s] [A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 28.31it/s, est. speed input: 10504.20 toks/s, output: 1988.40 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:13<00:00, 28.31it/s, est. speed input: 10627.82 toks/s, output: 2100.95 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.26s/it, est. speed input: 279.67 toks/s, output: 234.35 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.40s/it, est. speed input: 279.67 toks/s, output: 234.35 toks/s]
Processing batched inference:  20%|██        | 27/132 [03:18<20:34, 11.76s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 65.21it/s, est. speed input: 25593.85 toks/s, output: 3680.76 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:04<00:00,  2.92it/s, est. speed input: 1367.51 toks/s, output: 403.98 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:04<00:00,  3.49it/s, est. speed input: 1367.51 toks/s, output: 403.98 toks/s]
Processing batched inference:  21%|██        | 28/132 [03:25<17:41, 10.20s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 46.09it/s, est. speed input: 18107.74 toks/s, output: 2619.51 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 45.22it/s, est. speed input: 17819.90 toks/s, output: 2758.82 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.85it/s, est. speed input: 10074.64 toks/s, output: 1901.98 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.65it/s, est. speed input: 10074.64 toks/s, output: 1901.98 toks/s]
Processing batched inference:  22%|██▏       | 29/132 [03:27<13:22,  7.79s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 46.10it/s, est. speed input: 18082.44 toks/s, output: 2935.02 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 42.18it/s, est. speed input: 16779.66 toks/s, output: 2581.96 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.31it/s, est. speed input: 10917.65 toks/s, output: 1896.94 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.81it/s, est. speed input: 10917.65 toks/s, output: 1896.94 toks/s]
Processing batched inference:  23%|██▎       | 30/132 [03:29<10:25,  6.13s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 59.00it/s, est. speed input: 23208.21 toks/s, output: 4568.34 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 34.83it/s, est. speed input: 14650.17 toks/s, output: 2651.05 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.70it/s, est. speed input: 10489.36 toks/s, output: 1984.34 toks/s]
Processing batched inference:  23%|██▎       | 31/132 [03:31<08:29,  5.04s/it]Resource status after batch 30:
Open files: 0
Memory usage: 5238.87 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 48.15it/s, est. speed input: 18905.27 toks/s, output: 2726.36 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 40.42it/s, est. speed input: 16374.47 toks/s, output: 2848.59 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.41it/s, est. speed input: 9986.88 toks/s, output: 1905.82 toks/s] 
Processing batched inference:  24%|██▍       | 32/132 [03:34<07:16,  4.36s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 27.07it/s, est. speed input: 10634.67 toks/s, output: 1536.44 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 18.36it/s, est. speed input: 7635.87 toks/s, output: 1230.02 toks/s] [A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 21.72it/s, est. speed input: 8487.60 toks/s, output: 1362.69 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.85it/s, est. speed input: 8977.21 toks/s, output: 1503.79 toks/s]
Processing batched inference:  25%|██▌       | 33/132 [03:37<06:09,  3.74s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 76.05it/s, est. speed input: 29869.77 toks/s, output: 4314.20 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.73it/s, est. speed input: 16773.31 toks/s, output: 2662.81 toks/s]
Processing batched inference:  26%|██▌       | 34/132 [03:39<05:24,  3.31s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 49.72it/s, est. speed input: 19516.76 toks/s, output: 2809.16 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 32.16it/s, est. speed input: 13400.48 toks/s, output: 2081.82 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.07it/s, est. speed input: 14295.76 toks/s, output: 2483.85 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.41it/s, est. speed input: 14295.76 toks/s, output: 2483.85 toks/s]
Processing batched inference:  27%|██▋       | 35/132 [03:41<04:45,  2.94s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 43.85it/s, est. speed input: 17263.00 toks/s, output: 2947.05 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 36.29it/s, est. speed input: 14635.80 toks/s, output: 2630.35 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 34.20it/s, est. speed input: 13903.89 toks/s, output: 2354.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.35it/s, est. speed input: 15455.99 toks/s, output: 2572.65 toks/s]
Processing batched inference:  27%|██▋       | 36/132 [03:43<04:24,  2.76s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 27.90it/s, est. speed input: 10947.67 toks/s, output: 1846.80 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 24.36it/s, est. speed input: 9751.01 toks/s, output: 1760.89 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.25it/s, est. speed input: 11073.55 toks/s, output: 1922.57 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.21it/s, est. speed input: 11073.55 toks/s, output: 1922.57 toks/s]
Processing batched inference:  28%|██▊       | 37/132 [03:46<04:07,  2.61s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 52.88it/s, est. speed input: 20822.54 toks/s, output: 3049.76 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 31.95it/s, est. speed input: 13358.82 toks/s, output: 2360.85 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.19it/s, est. speed input: 12611.68 toks/s, output: 2227.13 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.06it/s, est. speed input: 12611.68 toks/s, output: 2227.13 toks/s]
Processing batched inference:  29%|██▉       | 38/132 [03:48<03:51,  2.46s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 73.89it/s, est. speed input: 29049.96 toks/s, output: 4219.99 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 37.00it/s, est. speed input: 14547.86 toks/s, output: 2333.61 toks/s]
Processing batched inference:  30%|██▉       | 39/132 [03:50<03:33,  2.29s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 36.80it/s, est. speed input: 14434.29 toks/s, output: 2067.13 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 29.52it/s, est. speed input: 12023.08 toks/s, output: 1882.38 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.97it/s, est. speed input: 12859.58 toks/s, output: 1970.97 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.25it/s, est. speed input: 9917.51 toks/s, output: 1658.41 toks/s] 
Processing batched inference:  30%|███       | 40/132 [03:52<03:26,  2.25s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.84it/s, est. speed input: 1114.34 toks/s, output: 161.61 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:02,  4.69it/s, est. speed input: 1673.69 toks/s, output: 239.09 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.21it/s, est. speed input: 9155.77 toks/s, output: 1387.25 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.31it/s, est. speed input: 9155.77 toks/s, output: 1387.25 toks/s]
Processing batched inference:  31%|███       | 41/132 [03:53<03:10,  2.09s/it]Resource status after batch 40:
Open files: 0
Memory usage: 6314.96 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 66.41it/s, est. speed input: 26125.70 toks/s, output: 3807.54 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.25it/s, est. speed input: 11474.61 toks/s, output: 1816.12 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.17it/s, est. speed input: 11474.61 toks/s, output: 1816.12 toks/s]
Processing batched inference:  32%|███▏      | 42/132 [03:56<03:15,  2.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 57.80it/s, est. speed input: 22660.60 toks/s, output: 3840.37 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 22.45it/s, est. speed input: 9893.62 toks/s, output: 1897.24 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.25it/s, est. speed input: 7552.89 toks/s, output: 1663.15 toks/s]
Processing batched inference:  33%|███▎      | 43/132 [03:58<03:27,  2.33s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 22.97it/s, est. speed input: 9027.89 toks/s, output: 1309.26 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 18.17it/s, est. speed input: 7438.22 toks/s, output: 1432.25 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 27.17it/s, est. speed input: 9813.12 toks/s, output: 2032.10 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.87it/s, est. speed input: 8204.92 toks/s, output: 1819.95 toks/s]
Processing batched inference:  33%|███▎      | 44/132 [04:01<03:22,  2.30s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 29.66it/s, est. speed input: 11622.27 toks/s, output: 1653.73 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 47.80it/s, est. speed input: 17704.34 toks/s, output: 2567.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.42it/s, est. speed input: 14309.16 toks/s, output: 2181.04 toks/s]
Processing batched inference:  34%|███▍      | 45/132 [04:03<03:08,  2.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.82it/s, est. speed input: 1494.21 toks/s, output: 210.17 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 27.73it/s, est. speed input: 8987.50 toks/s, output: 1274.78 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 25.29it/s, est. speed input: 8915.00 toks/s, output: 1517.01 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.82it/s, est. speed input: 10517.04 toks/s, output: 1981.34 toks/s]
Processing batched inference:  35%|███▍      | 46/132 [04:04<02:55,  2.04s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.03it/s, est. speed input: 1188.46 toks/s, output: 169.77 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:01,  9.60it/s, est. speed input: 3244.58 toks/s, output: 468.80 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 22.49it/s, est. speed input: 6989.29 toks/s, output: 1127.64 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.42it/s, est. speed input: 8019.77 toks/s, output: 1457.66 toks/s]
Processing batched inference:  36%|███▌      | 47/132 [04:06<02:46,  1.96s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 31.68it/s, est. speed input: 12421.30 toks/s, output: 1774.06 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 39.82it/s, est. speed input: 15167.28 toks/s, output: 2186.42 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 34.21it/s, est. speed input: 13698.43 toks/s, output: 2206.14 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.68it/s, est. speed input: 11252.49 toks/s, output: 1948.56 toks/s]
Processing batched inference:  36%|███▋      | 48/132 [04:08<02:48,  2.01s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 20.47it/s, est. speed input: 8030.95 toks/s, output: 1153.03 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 20.94it/s, est. speed input: 8180.25 toks/s, output: 1168.56 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 23.60it/s, est. speed input: 8966.46 toks/s, output: 1290.65 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 25.50it/s, est. speed input: 9506.91 toks/s, output: 1607.48 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.91it/s, est. speed input: 10558.51 toks/s, output: 1908.81 toks/s]
Processing batched inference:  37%|███▋      | 49/132 [04:10<02:40,  1.94s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 23.75it/s, est. speed input: 9336.67 toks/s, output: 1353.94 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 23.22it/s, est. speed input: 9158.66 toks/s, output: 1328.23 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 36.32it/s, est. speed input: 12935.05 toks/s, output: 1991.11 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:17<00:00, 36.32it/s, est. speed input: 10374.74 toks/s, output: 1670.98 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.12s/it, est. speed input: 282.81 toks/s, output: 227.01 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.39s/it, est. speed input: 282.81 toks/s, output: 227.01 toks/s]
Processing batched inference:  38%|███▊      | 50/132 [04:34<11:33,  8.45s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.64it/s, est. speed input: 1814.59 toks/s, output: 255.21 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 45.34it/s, est. speed input: 14823.75 toks/s, output: 2152.39 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.30it/s, est. speed input: 9163.83 toks/s, output: 1476.79 toks/s] 
Processing batched inference:  39%|███▊      | 51/132 [04:36<08:44,  6.48s/it]Resource status after batch 50:
Open files: 0
Memory usage: 7228.32 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 21.29it/s, est. speed input: 8332.28 toks/s, output: 1176.56 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 32.94it/s, est. speed input: 12199.37 toks/s, output: 1754.81 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 31.91it/s, est. speed input: 12124.69 toks/s, output: 1954.84 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.58it/s, est. speed input: 10049.40 toks/s, output: 1689.78 toks/s]
Processing batched inference:  39%|███▉      | 52/132 [04:38<06:54,  5.18s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.65it/s, est. speed input: 1440.23 toks/s, output: 211.99 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  7.33it/s, est. speed input: 2614.11 toks/s, output: 377.24 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 17.17it/s, est. speed input: 5618.58 toks/s, output: 868.98 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 17.41it/s, est. speed input: 5981.34 toks/s, output: 1177.02 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.23it/s, est. speed input: 5981.34 toks/s, output: 1177.02 toks/s]
Processing batched inference:  40%|████      | 53/132 [04:40<05:35,  4.25s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.82it/s, est. speed input: 1494.77 toks/s, output: 210.24 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 25.76it/s, est. speed input: 8329.90 toks/s, output: 1208.11 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 26.87it/s, est. speed input: 9105.67 toks/s, output: 1313.76 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.00it/s, est. speed input: 8333.93 toks/s, output: 1383.88 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.23it/s, est. speed input: 8333.93 toks/s, output: 1383.88 toks/s]
Processing batched inference:  41%|████      | 54/132 [04:42<04:33,  3.50s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 27.52it/s, est. speed input: 10807.84 toks/s, output: 1559.53 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 13.33it/s, est. speed input: 5673.85 toks/s, output: 818.78 toks/s]  [A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 19.98it/s, est. speed input: 7524.67 toks/s, output: 1166.80 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 20.16it/s, est. speed input: 7624.46 toks/s, output: 1343.87 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.41it/s, est. speed input: 8017.10 toks/s, output: 1460.99 toks/s]
Processing batched inference:  42%|████▏     | 55/132 [04:44<03:56,  3.07s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  8.18it/s, est. speed input: 3223.18 toks/s, output: 474.41 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 20.42it/s, est. speed input: 7361.30 toks/s, output: 1064.41 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 41.59it/s, est. speed input: 13534.53 toks/s, output: 2073.19 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.94it/s, est. speed input: 10977.74 toks/s, output: 1919.50 toks/s]
Processing batched inference:  42%|████▏     | 56/132 [04:46<03:27,  2.73s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.25it/s, est. speed input: 881.73 toks/s, output: 124.02 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 22.35it/s, est. speed input: 7371.48 toks/s, output: 1128.69 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:13<00:00, 22.35it/s, est. speed input: 7217.08 toks/s, output: 1162.21 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:16<00:00,  1.35s/it, est. speed input: 392.84 toks/s, output: 239.86 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:16<00:00,  1.00s/it, est. speed input: 392.84 toks/s, output: 239.86 toks/s]
Processing batched inference:  43%|████▎     | 57/132 [05:02<08:38,  6.92s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 25.67it/s, est. speed input: 10081.25 toks/s, output: 1454.70 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 18.37it/s, est. speed input: 7534.06 toks/s, output: 1087.18 toks/s] [A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 30.84it/s, est. speed input: 10987.66 toks/s, output: 1686.59 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 13.85it/s, est. speed input: 6387.45 toks/s, output: 1169.55 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.25it/s, est. speed input: 6387.45 toks/s, output: 1169.55 toks/s]
Processing batched inference:  44%|████▍     | 58/132 [05:05<06:51,  5.56s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.45it/s, est. speed input: 2515.39 toks/s, output: 348.24 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 31.01it/s, est. speed input: 10458.04 toks/s, output: 1500.47 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 41.67it/s, est. speed input: 14028.70 toks/s, output: 2023.72 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.52it/s, est. speed input: 11189.90 toks/s, output: 1766.57 toks/s]
Processing batched inference:  45%|████▍     | 59/132 [05:06<05:21,  4.40s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.31it/s, est. speed input: 904.45 toks/s, output: 127.22 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 24.12it/s, est. speed input: 7892.92 toks/s, output: 1214.16 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:06<00:00,  2.32it/s, est. speed input: 911.52 toks/s, output: 318.53 toks/s]  
Processing batched inference:  45%|████▌     | 60/132 [05:14<06:28,  5.40s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.01it/s, est. speed input: 1187.66 toks/s, output: 174.82 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 13.55it/s, est. speed input: 4399.08 toks/s, output: 636.10 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 22.46it/s, est. speed input: 7114.68 toks/s, output: 1089.55 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.54it/s, est. speed input: 8048.98 toks/s, output: 1451.77 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.52it/s, est. speed input: 8048.98 toks/s, output: 1451.77 toks/s]
Processing batched inference:  46%|████▌     | 61/132 [05:16<05:04,  4.28s/it]Resource status after batch 60:
Open files: 0
Memory usage: 7920.59 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 16.72it/s, est. speed input: 6547.60 toks/s, output: 928.10 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 21.69it/s, est. speed input: 8262.59 toks/s, output: 1183.33 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 32.05it/s, est. speed input: 11411.32 toks/s, output: 1736.57 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.67it/s, est. speed input: 13217.80 toks/s, output: 2100.48 toks/s]
Processing batched inference:  47%|████▋     | 62/132 [05:17<04:05,  3.51s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.38it/s, est. speed input: 1721.53 toks/s, output: 249.66 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 28.77it/s, est. speed input: 9337.01 toks/s, output: 1338.91 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 31.81it/s, est. speed input: 10920.65 toks/s, output: 1640.44 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.37it/s, est. speed input: 9944.58 toks/s, output: 1569.66 toks/s] 
Processing batched inference:  48%|████▊     | 63/132 [05:19<03:25,  2.98s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.03it/s, est. speed input: 1187.26 toks/s, output: 169.60 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 35.22it/s, est. speed input: 10927.61 toks/s, output: 1576.94 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.96it/s, est. speed input: 9805.30 toks/s, output: 1716.36 toks/s] 
Processing batched inference:  48%|████▊     | 64/132 [05:21<02:53,  2.56s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 28.27it/s, est. speed input: 11112.03 toks/s, output: 1611.54 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 22.93it/s, est. speed input: 9301.98 toks/s, output: 1492.72 toks/s] [A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 37.21it/s, est. speed input: 13238.54 toks/s, output: 2026.27 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.23it/s, est. speed input: 9131.96 toks/s, output: 1533.33 toks/s] 
Processing batched inference:  49%|████▉     | 65/132 [05:23<02:41,  2.41s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.82it/s, est. speed input: 1896.18 toks/s, output: 275.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 22.89it/s, est. speed input: 7564.28 toks/s, output: 1086.08 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 22.59it/s, est. speed input: 8003.74 toks/s, output: 1251.37 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 29.17it/s, est. speed input: 9726.04 toks/s, output: 1885.44 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.10it/s, est. speed input: 9081.06 toks/s, output: 1804.61 toks/s]
Processing batched inference:  50%|█████     | 66/132 [05:25<02:27,  2.23s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 44.73it/s, est. speed input: 17608.16 toks/s, output: 2578.07 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.94it/s, est. speed input: 9647.65 toks/s, output: 1636.25 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.51it/s, est. speed input: 9647.65 toks/s, output: 1636.25 toks/s]
Processing batched inference:  51%|█████     | 67/132 [05:27<02:27,  2.28s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 25.98it/s, est. speed input: 10202.02 toks/s, output: 1470.70 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 21.91it/s, est. speed input: 8874.76 toks/s, output: 1422.17 toks/s] [A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 21.36it/s, est. speed input: 8630.95 toks/s, output: 1335.50 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 19.72it/s, est. speed input: 8162.74 toks/s, output: 1309.16 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:11<00:00, 19.72it/s, est. speed input: 7565.76 toks/s, output: 1265.00 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.88s/it, est. speed input: 274.44 toks/s, output: 222.07 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.43s/it, est. speed input: 274.44 toks/s, output: 222.07 toks/s]
Processing batched inference:  52%|█████▏    | 68/132 [05:51<09:27,  8.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.23it/s, est. speed input: 1661.67 toks/s, output: 240.99 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 17.42it/s, est. speed input: 5746.59 toks/s, output: 815.85 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 34.33it/s, est. speed input: 10603.71 toks/s, output: 1611.91 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.98it/s, est. speed input: 10183.09 toks/s, output: 1753.43 toks/s]
Processing batched inference:  52%|█████▏    | 69/132 [05:53<07:02,  6.70s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.38it/s, est. speed input: 1720.43 toks/s, output: 249.49 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 14.10it/s, est. speed input: 4745.94 toks/s, output: 682.72 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 16.85it/s, est. speed input: 5739.23 toks/s, output: 826.72 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.16it/s, est. speed input: 9384.86 toks/s, output: 1434.74 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.15it/s, est. speed input: 8699.35 toks/s, output: 1446.63 toks/s]
Processing batched inference:  53%|█████▎    | 70/132 [05:55<05:23,  5.22s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.43it/s, est. speed input: 946.72 toks/s, output: 131.08 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 23.50it/s, est. speed input: 7680.73 toks/s, output: 1168.64 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.92it/s, est. speed input: 8606.72 toks/s, output: 1500.19 toks/s]
Processing batched inference:  54%|█████▍    | 71/132 [05:56<04:14,  4.18s/it]Resource status after batch 70:
Open files: 0
Memory usage: 8520.23 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.50it/s, est. speed input: 2163.39 toks/s, output: 313.75 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 15.56it/s, est. speed input: 5507.92 toks/s, output: 796.43 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 31.38it/s, est. speed input: 9947.73 toks/s, output: 1424.69 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.93it/s, est. speed input: 10960.29 toks/s, output: 1661.72 toks/s]
Processing batched inference:  55%|█████▍    | 72/132 [05:58<03:25,  3.43s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.05it/s, est. speed input: 1191.13 toks/s, output: 167.54 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 26.02it/s, est. speed input: 8693.45 toks/s, output: 1321.29 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.10it/s, est. speed input: 9850.84 toks/s, output: 1713.16 toks/s]
Processing batched inference:  55%|█████▌    | 73/132 [06:00<02:49,  2.87s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.83it/s, est. speed input: 1497.79 toks/s, output: 210.67 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 15.73it/s, est. speed input: 5201.86 toks/s, output: 747.64 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 24.12it/s, est. speed input: 8020.52 toks/s, output: 1224.59 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.47it/s, est. speed input: 9209.59 toks/s, output: 1594.56 toks/s]
Processing batched inference:  56%|█████▌    | 74/132 [06:01<02:28,  2.56s/it]ERROR 06-30 23:02:03 [core.py:387] EngineCore hit an exception: Traceback (most recent call last):
ERROR 06-30 23:02:03 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 68, in __getitem__
ERROR 06-30 23:02:03 [core.py:387]     return self.__data[key]
ERROR 06-30 23:02:03 [core.py:387]            ~~~~~~~~~~~^^^^^
ERROR 06-30 23:02:03 [core.py:387] KeyError: '950af6e8612a49bd423021fa515d5f51e13f933b1057068e6da31b9166c9cd83'
ERROR 06-30 23:02:03 [core.py:387] 
ERROR 06-30 23:02:03 [core.py:387] During handling of the above exception, another exception occurred:
ERROR 06-30 23:02:03 [core.py:387] 
ERROR 06-30 23:02:03 [core.py:387] Traceback (most recent call last):
ERROR 06-30 23:02:03 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 380, in run_engine_core
ERROR 06-30 23:02:03 [core.py:387]     engine_core.run_busy_loop()
ERROR 06-30 23:02:03 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 400, in run_busy_loop
ERROR 06-30 23:02:03 [core.py:387]     self._process_input_queue()
ERROR 06-30 23:02:03 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 425, in _process_input_queue
ERROR 06-30 23:02:03 [core.py:387]     self._handle_client_request(*req)
ERROR 06-30 23:02:03 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 441, in _handle_client_request
ERROR 06-30 23:02:03 [core.py:387]     self.add_request(request)
ERROR 06-30 23:02:03 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 177, in add_request
ERROR 06-30 23:02:03 [core.py:387]     request.mm_inputs = self.mm_input_cache_server.get_and_update_p1(
ERROR 06-30 23:02:03 [core.py:387]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:02:03 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/mm_input_cache.py", line 76, in get_and_update_p1
ERROR 06-30 23:02:03 [core.py:387]     mm_input = self.mm_cache[mm_hash]
ERROR 06-30 23:02:03 [core.py:387]                ~~~~~~~~~~~~~^^^^^^^^^
ERROR 06-30 23:02:03 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 211, in __getitem__
ERROR 06-30 23:02:03 [core.py:387]     value = cache_getitem(self, key)
ERROR 06-30 23:02:03 [core.py:387]             ^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:02:03 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 70, in __getitem__
ERROR 06-30 23:02:03 [core.py:387]     return self.__missing__(key)
ERROR 06-30 23:02:03 [core.py:387]            ^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:02:03 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 97, in __missing__
ERROR 06-30 23:02:03 [core.py:387]     raise KeyError(key)
ERROR 06-30 23:02:03 [core.py:387] KeyError: '950af6e8612a49bd423021fa515d5f51e13f933b1057068e6da31b9166c9cd83'
ERROR 06-30 23:02:03 [core.py:387] 
CRITICAL 06-30 23:02:03 [core_client.py:359] Got fatal signal from worker processes, shutting down. See stack trace above for root cause issue.
batch_inference.sh: line 23: 462648 Killed                  python scripts/vllm_infer_new.py --model_name_or_path "$ckpt" --dataset $EVAL_DATASET --template qwen2_vl --save_name "$save_path/generated_predictions.jsonl" --max_new_tokens 4096 --temperature 0.0 --top_p 1.0 --top_k -1 --repetition_penalty 1.0 --batch_size 16 --seed 42
Running inference on checkpoint: checkpoint-378
INFO 06-30 23:02:13 [__init__.py:239] Automatically detected platform cuda.
[INFO|training_args.py:2135] 2025-06-30 23:02:15,837 >> PyTorch: setting up devices
[INFO|training_args.py:1812] 2025-06-30 23:02:15,892 >> The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:15,932 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:15,932 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:15,932 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:15,932 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:15,932 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:15,932 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:15,932 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:02:16,333 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:378] 2025-06-30 23:02:16,334 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378/preprocessor_config.json
[INFO|image_processing_base.py:378] 2025-06-30 23:02:16,339 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:02:16,347 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:16,348 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:16,348 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:16,348 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:16,348 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:16,348 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:16,348 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:16,349 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:02:16,730 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:02:16,732 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:02:16,925 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:02:17,377 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}

[INFO|configuration_utils.py:696] 2025-06-30 23:02:17,428 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378/config.json
[INFO|configuration_utils.py:696] 2025-06-30 23:02:17,428 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378/config.json
[INFO|configuration_utils.py:770] 2025-06-30 23:02:17,430 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "text_config": {
    "architectures": [
      "Qwen2VLForConditionalGeneration"
    ],
    "attention_dropout": 0.0,
    "bos_token_id": 151643,
    "eos_token_id": 151645,
    "hidden_act": "silu",
    "hidden_size": 1536,
    "image_token_id": null,
    "initializer_range": 0.02,
    "intermediate_size": 8960,
    "max_position_embeddings": 32768,
    "max_window_layers": 28,
    "model_type": "qwen2_vl_text",
    "num_attention_heads": 12,
    "num_hidden_layers": 28,
    "num_key_value_heads": 2,
    "rms_norm_eps": 1e-06,
    "rope_scaling": {
      "mrope_section": [
        16,
        24,
        24
      ],
      "rope_type": "default",
      "type": "default"
    },
    "rope_theta": 1000000.0,
    "sliding_window": 32768,
    "tie_word_embeddings": true,
    "torch_dtype": "float32",
    "use_cache": false,
    "use_sliding_window": false,
    "video_token_id": null,
    "vision_end_token_id": 151653,
    "vision_start_token_id": 151652,
    "vision_token_id": 151654,
    "vocab_size": 151936
  },
  "torch_dtype": "bfloat16",
  "transformers_version": "4.52.4",
  "use_cache": false,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "depth": 32,
    "embed_dim": 1280,
    "hidden_act": "quick_gelu",
    "hidden_size": 1536,
    "in_channels": 3,
    "in_chans": 3,
    "initializer_range": 0.02,
    "mlp_ratio": 4,
    "model_type": "qwen2_vl",
    "num_heads": 16,
    "patch_size": 14,
    "spatial_merge_size": 2,
    "spatial_patch_size": 14,
    "temporal_patch_size": 2,
    "torch_dtype": "float32"
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 151936
}

INFO 06-30 23:02:29 [config.py:689] This model supports multiple tasks: {'embed', 'classify', 'score', 'reward', 'generate'}. Defaulting to 'generate'.
INFO 06-30 23:02:29 [config.py:1901] Chunked prefill is enabled with max_num_batched_tokens=8192.
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:30,419 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:30,419 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:30,419 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:30,419 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:30,419 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:30,419 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:02:30,419 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:02:30,759 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:1088] 2025-06-30 23:02:30,865 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378/generation_config.json
[INFO|configuration_utils.py:1135] 2025-06-30 23:02:30,867 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

WARNING 06-30 23:02:30 [utils.py:2304] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/getting_started/troubleshooting.html#python-multiprocessing for more information. Reason: CUDA is initialized
INFO 06-30 23:02:38 [__init__.py:239] Automatically detected platform cuda.
INFO 06-30 23:02:41 [core.py:61] Initializing a V1 LLM engine (v0.8.4) with config: model='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378', speculative_config=None, tokenizer='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-30 23:02:42 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f7cce2b71d0>
INFO 06-30 23:02:42 [parallel_state.py:959] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-30 23:02:42 [cuda.py:221] Using Flash Attention backend on V1 engine.
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:02:45 [gpu_model_runner.py:1276] Starting to load model saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378...
WARNING 06-30 23:02:46 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-30 23:02:46 [config.py:3466] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
WARNING 06-30 23:02:46 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.06s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.06s/it]

INFO 06-30 23:02:53 [loader.py:458] Loading weights took 7.27 seconds
INFO 06-30 23:02:53 [gpu_model_runner.py:1291] Model loading took 4.1513 GiB and 7.565514 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:02:55 [gpu_model_runner.py:1560] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-30 23:03:09 [backends.py:416] Using cache directory: /root/.cache/vllm/torch_compile_cache/e9c7653ba5/rank_0_0 for vLLM's torch.compile
INFO 06-30 23:03:09 [backends.py:426] Dynamo bytecode transform time: 7.64 s
INFO 06-30 23:03:10 [backends.py:115] Directly load the compiled graph for shape None from the cache
INFO 06-30 23:03:17 [monitor.py:33] torch.compile takes 7.64 s in total
INFO 06-30 23:03:17 [kv_cache_utils.py:634] GPU KV cache size: 1,006,016 tokens
INFO 06-30 23:03:17 [kv_cache_utils.py:637] Maximum concurrency for 6,144 tokens per request: 163.74x
INFO 06-30 23:03:38 [gpu_model_runner.py:1626] Graph capturing finished in 21 secs, took 0.47 GiB
INFO 06-30 23:03:38 [core.py:163] init engine (profile, create kv cache, warmup model) took 44.53 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:03:39 [core_client.py:435] Core engine process 0 ready.
[INFO|2025-06-30 23:03:39] llamafactory.data.loader:143 >> Loading dataset ./0_my_dataset/vindr/qwen2_vindr_input_test_len_2108.json...
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151653, 198, 5598, 30618, 14697, 315, 364, 47, 811, 372, 8767, 269, 706, 6, 5671, 438, 4718, 3561, 510, 73594, 2236, 198, 9640, 4913, 58456, 62, 17, 67, 788, 508, 87, 16, 11, 379, 16, 11, 856, 17, 11, 379, 17, 1125, 330, 1502, 788, 330, 1502, 7115, 9338, 921, 73594, 151645, 198, 151644, 77091, 198]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|vision_end|>
Return bounding boxes of 'Pneumothorax' areas as JSON format:
```json
[
{"bbox_2d": [x1, y1, x2, y2], "label": "label"},
...
]
```<|im_end|>
<|im_start|>assistant

label_ids:
[27, 9217, 397, 9640, 220, 341, 262, 330, 58456, 62, 17, 67, 788, 2278, 414, 220, 16, 22, 20, 345, 414, 220, 17, 22, 24, 345, 414, 220, 18, 15, 17, 345, 414, 220, 21, 23, 16, 198, 262, 3211, 262, 330, 1502, 788, 330, 47, 811, 372, 8767, 269, 706, 698, 220, 456, 921, 522, 9217, 29, 151645, 198]
labels:
<answer>
[
  {
    "bbox_2d": [
      175,
      279,
      302,
      681
    ],
    "label": "Pneumothorax"
  }
]
</answer><|im_end|>

Current file descriptor limits: soft=8192, hard=8192
Initial resource status:
Open files: 0
Memory usage: 933.48 MB
Using effective batch size: 16
Processing batched inference:   0%|          | 0/132 [00:00<?, ?it/s][INFO|image_processing_base.py:378] 2025-06-30 23:03:40,982 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:03:40,982 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|image_processing_base.py:378] 2025-06-30 23:03:40,983 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:03:40,983 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:03:40,984 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:03:40,984 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:03:40,984 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:03:40,984 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:03:40,984 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:03:40,984 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:03:40,984 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:03:41,811 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:03:41,812 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:03:41,812 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:03:42,326 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: CachedQwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-378', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='left', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}


Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 55.35it/s, est. speed input: 21778.01 toks/s, output: 3580.52 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.35it/s, est. speed input: 15474.22 toks/s, output: 2592.48 toks/s]
Processing batched inference:   1%|          | 1/132 [00:04<10:04,  4.62s/it]Resource status after batch 0:
Open files: 0
Memory usage: 1095.23 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 47.71it/s, est. speed input: 18706.25 toks/s, output: 3029.93 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 36.44it/s, est. speed input: 14866.20 toks/s, output: 2439.69 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 25.31it/s, est. speed input: 11198.09 toks/s, output: 1880.24 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.19it/s, est. speed input: 9502.13 toks/s, output: 1655.73 toks/s] 
Processing batched inference:   2%|▏         | 2/132 [00:07<07:28,  3.45s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 60.11it/s, est. speed input: 23579.04 toks/s, output: 3661.04 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.01it/s, est. speed input: 9429.45 toks/s, output: 1649.33 toks/s] 
Processing batched inference:   2%|▏         | 3/132 [00:10<07:00,  3.26s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 80.52it/s, est. speed input: 31615.07 toks/s, output: 5708.84 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.59it/s, est. speed input: 16335.89 toks/s, output: 3233.80 toks/s]
Processing batched inference:   3%|▎         | 4/132 [00:13<06:32,  3.06s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 53.96it/s, est. speed input: 21223.30 toks/s, output: 3381.73 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 23.05it/s, est. speed input: 10090.05 toks/s, output: 1944.27 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:14<00:00, 23.05it/s, est. speed input: 10090.05 toks/s, output: 1944.27 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.28s/it, est. speed input: 284.07 toks/s, output: 236.50 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.38s/it, est. speed input: 284.07 toks/s, output: 236.50 toks/s]
Processing batched inference:   4%|▍         | 5/132 [00:37<22:48, 10.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 91.17it/s, est. speed input: 35856.87 toks/s, output: 6708.77 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.67it/s, est. speed input: 16782.39 toks/s, output: 3091.74 toks/s]
Processing batched inference:   5%|▍         | 6/132 [00:40<16:51,  8.03s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 83.86it/s, est. speed input: 32881.59 toks/s, output: 5325.62 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:17<00:00, 83.86it/s, est. speed input: 10946.80 toks/s, output: 1812.00 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.78s/it, est. speed input: 283.06 toks/s, output: 228.88 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.38s/it, est. speed input: 283.06 toks/s, output: 228.88 toks/s]
Processing batched inference:   5%|▌         | 7/132 [01:04<27:50, 13.36s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 44.90it/s, est. speed input: 17654.01 toks/s, output: 2559.38 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 30.15it/s, est. speed input: 12567.93 toks/s, output: 1948.44 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.40it/s, est. speed input: 9232.55 toks/s, output: 1546.30 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.48it/s, est. speed input: 9232.55 toks/s, output: 1546.30 toks/s]
Processing batched inference:   6%|▌         | 8/132 [01:07<20:27,  9.90s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 78.22it/s, est. speed input: 30700.85 toks/s, output: 4764.29 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.19it/s, est. speed input: 10673.91 toks/s, output: 2030.74 toks/s]
Processing batched inference:   7%|▋         | 9/132 [01:09<15:46,  7.69s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 109.41it/s, est. speed input: 42966.82 toks/s, output: 7131.75 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.58it/s, est. speed input: 9260.45 toks/s, output: 1613.62 toks/s]  
Processing batched inference:   8%|▊         | 10/132 [01:12<12:28,  6.14s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 68.55it/s, est. speed input: 26882.87 toks/s, output: 4469.84 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:15<00:00, 68.55it/s, est. speed input: 15283.63 toks/s, output: 2656.81 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:21<00:00,  1.68s/it, est. speed input: 286.82 toks/s, output: 234.05 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:21<00:00,  1.37s/it, est. speed input: 286.82 toks/s, output: 234.05 toks/s]
Processing batched inference:   8%|▊         | 11/132 [01:36<23:24, 11.61s/it]Resource status after batch 10:
Open files: 0
Memory usage: 2835.04 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 65.23it/s, est. speed input: 25613.21 toks/s, output: 3978.99 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.76it/s, est. speed input: 15219.92 toks/s, output: 2420.30 toks/s]
Processing batched inference:   9%|▉         | 12/132 [01:38<17:29,  8.74s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 70.91it/s, est. speed input: 27853.48 toks/s, output: 4568.05 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.94it/s, est. speed input: 16473.62 toks/s, output: 2749.88 toks/s]
Processing batched inference:  10%|▉         | 13/132 [01:41<13:28,  6.79s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 70.41it/s, est. speed input: 27630.28 toks/s, output: 4544.97 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.53it/s, est. speed input: 10410.91 toks/s, output: 1883.51 toks/s]
Processing batched inference:  11%|█         | 14/132 [01:43<11:03,  5.62s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 86.12it/s, est. speed input: 33806.22 toks/s, output: 5892.27 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.30it/s, est. speed input: 16617.51 toks/s, output: 2781.38 toks/s]
Processing batched inference:  11%|█▏        | 15/132 [01:46<08:58,  4.60s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 58.31it/s, est. speed input: 22913.64 toks/s, output: 3866.25 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:11<00:00, 58.31it/s, est. speed input: 11391.49 toks/s, output: 2105.04 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.74s/it, est. speed input: 276.99 toks/s, output: 228.55 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.42s/it, est. speed input: 276.99 toks/s, output: 228.55 toks/s]
Processing batched inference:  12%|█▏        | 16/132 [02:11<20:42, 10.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 44.07it/s, est. speed input: 17315.75 toks/s, output: 2504.67 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 27.12it/s, est. speed input: 11355.82 toks/s, output: 1749.57 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.75it/s, est. speed input: 13634.99 toks/s, output: 2154.43 toks/s]
Processing batched inference:  13%|█▎        | 17/132 [02:13<15:34,  8.13s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 50.57it/s, est. speed input: 19850.20 toks/s, output: 2853.86 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 28.44it/s, est. speed input: 12017.41 toks/s, output: 1963.60 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:15<00:00, 28.44it/s, est. speed input: 8633.33 toks/s, output: 1514.16 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.13s/it, est. speed input: 274.77 toks/s, output: 224.47 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.43s/it, est. speed input: 274.77 toks/s, output: 224.47 toks/s]
Processing batched inference:  14%|█▎        | 18/132 [02:37<24:44, 13.03s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 88.65it/s, est. speed input: 34815.90 toks/s, output: 5356.39 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:10<00:00, 88.65it/s, est. speed input: 15935.55 toks/s, output: 2423.65 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.78s/it, est. speed input: 283.54 toks/s, output: 225.25 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.39s/it, est. speed input: 283.54 toks/s, output: 225.25 toks/s]
Processing batched inference:  14%|█▍        | 19/132 [03:02<30:58, 16.45s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 26.73it/s, est. speed input: 10515.30 toks/s, output: 1505.82 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 20.98it/s, est. speed input: 8521.31 toks/s, output: 1402.09 toks/s] [A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 30.07it/s, est. speed input: 11016.30 toks/s, output: 1810.46 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 22.97it/s, est. speed input: 9385.23 toks/s, output: 1646.53 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.92it/s, est. speed input: 8999.55 toks/s, output: 1630.52 toks/s]
Processing batched inference:  15%|█▌        | 20/132 [03:04<22:39, 12.14s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 35.97it/s, est. speed input: 14089.44 toks/s, output: 2557.94 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 26.05it/s, est. speed input: 10828.84 toks/s, output: 1942.93 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00,  8.79it/s, est. speed input: 4625.91 toks/s, output: 1004.10 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 11.80it/s, est. speed input: 4625.91 toks/s, output: 1004.10 toks/s]
Processing batched inference:  16%|█▌        | 21/132 [03:07<17:32,  9.48s/it]Resource status after batch 20:
Open files: 0
Memory usage: 4358.91 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 71.45it/s, est. speed input: 28064.45 toks/s, output: 4689.93 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.79it/s, est. speed input: 12877.87 toks/s, output: 2352.89 toks/s]
Processing batched inference:  17%|█▋        | 22/132 [03:09<13:23,  7.31s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 64.97it/s, est. speed input: 25500.62 toks/s, output: 3667.31 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.20it/s, est. speed input: 9396.54 toks/s, output: 1862.83 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.91it/s, est. speed input: 9396.54 toks/s, output: 1862.83 toks/s]
Processing batched inference:  17%|█▋        | 23/132 [03:12<10:38,  5.85s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 61.96it/s, est. speed input: 24372.56 toks/s, output: 4298.97 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 38.59it/s, est. speed input: 16144.09 toks/s, output: 2866.67 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.77it/s, est. speed input: 17203.33 toks/s, output: 3015.27 toks/s]
Processing batched inference:  18%|█▊        | 24/132 [03:14<08:35,  4.77s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 20.85it/s, est. speed input: 8200.28 toks/s, output: 1192.80 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 21.42it/s, est. speed input: 8378.31 toks/s, output: 1478.44 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 28.91it/s, est. speed input: 10422.41 toks/s, output: 1875.31 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.56it/s, est. speed input: 8475.52 toks/s, output: 1622.31 toks/s] 
Processing batched inference:  19%|█▉        | 25/132 [03:16<07:12,  4.04s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 52.80it/s, est. speed input: 20729.46 toks/s, output: 2986.29 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 44.51it/s, est. speed input: 17982.20 toks/s, output: 2592.35 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.94it/s, est. speed input: 16470.78 toks/s, output: 2375.36 toks/s]
Processing batched inference:  20%|█▉        | 26/132 [03:18<06:01,  3.41s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 16.48it/s, est. speed input: 6478.19 toks/s, output: 939.46 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 15.54it/s, est. speed input: 6151.79 toks/s, output: 885.50 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 20.16it/s, est. speed input: 7511.18 toks/s, output: 1087.33 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 25.94it/s, est. speed input: 9003.77 toks/s, output: 1478.94 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 24.02it/s, est. speed input: 8826.38 toks/s, output: 1607.08 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.89it/s, est. speed input: 7411.08 toks/s, output: 1448.89 toks/s]
Processing batched inference:  20%|██        | 27/132 [03:20<05:18,  3.03s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 45.89it/s, est. speed input: 18003.16 toks/s, output: 2790.04 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 21.24it/s, est. speed input: 9332.95 toks/s, output: 1627.92 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.37it/s, est. speed input: 9168.83 toks/s, output: 1655.21 toks/s]
Processing batched inference:  21%|██        | 28/132 [03:23<04:57,  2.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.76it/s, est. speed input: 1857.66 toks/s, output: 257.18 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01, 10.62it/s, est. speed input: 3694.48 toks/s, output: 516.95 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 20.34it/s, est. speed input: 6402.12 toks/s, output: 916.56 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 18.53it/s, est. speed input: 6500.65 toks/s, output: 1011.42 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 17.71it/s, est. speed input: 6510.92 toks/s, output: 1253.74 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:10<00:00,  1.55it/s, est. speed input: 608.28 toks/s, output: 291.94 toks/s]  
Processing batched inference:  22%|██▏       | 29/132 [03:34<09:21,  5.45s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 49.69it/s, est. speed input: 19499.52 toks/s, output: 3080.88 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 29.06it/s, est. speed input: 12351.95 toks/s, output: 2002.43 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.78it/s, est. speed input: 8941.91 toks/s, output: 1623.44 toks/s] 
Processing batched inference:  23%|██▎       | 30/132 [03:37<07:41,  4.52s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 41.22it/s, est. speed input: 16194.45 toks/s, output: 3100.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 31.80it/s, est. speed input: 12940.00 toks/s, output: 2486.47 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.96it/s, est. speed input: 11877.66 toks/s, output: 2161.93 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.23it/s, est. speed input: 11877.66 toks/s, output: 2161.93 toks/s]
Processing batched inference:  23%|██▎       | 31/132 [03:39<06:30,  3.86s/it]Resource status after batch 30:
Open files: 0
Memory usage: 5638.52 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 63.06it/s, est. speed input: 24758.50 toks/s, output: 3567.44 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.86it/s, est. speed input: 13921.02 toks/s, output: 2147.26 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.96it/s, est. speed input: 10204.91 toks/s, output: 1712.14 toks/s]
Processing batched inference:  24%|██▍       | 32/132 [03:41<05:41,  3.42s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 26.15it/s, est. speed input: 10272.24 toks/s, output: 1484.05 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 18.75it/s, est. speed input: 7743.47 toks/s, output: 1247.36 toks/s] [A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 21.69it/s, est. speed input: 8480.25 toks/s, output: 1361.54 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.83it/s, est. speed input: 8970.22 toks/s, output: 1502.62 toks/s]
Processing batched inference:  25%|██▌       | 33/132 [03:44<05:04,  3.07s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 69.64it/s, est. speed input: 27363.09 toks/s, output: 3959.74 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 33.45it/s, est. speed input: 14244.42 toks/s, output: 2417.97 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:14<00:00, 33.45it/s, est. speed input: 12639.23 toks/s, output: 2417.40 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:14<00:00,  1.44s/it, est. speed input: 419.17 toks/s, output: 261.58 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:14<00:00,  1.07it/s, est. speed input: 419.17 toks/s, output: 261.58 toks/s]
Processing batched inference:  26%|██▌       | 34/132 [04:00<11:42,  7.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 48.87it/s, est. speed input: 19195.12 toks/s, output: 2771.87 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 37.38it/s, est. speed input: 15311.16 toks/s, output: 2368.21 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 35.22it/s, est. speed input: 14510.74 toks/s, output: 2410.30 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.96it/s, est. speed input: 14510.74 toks/s, output: 2410.30 toks/s]
Processing batched inference:  27%|██▋       | 35/132 [04:02<09:08,  5.65s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 14.15it/s, est. speed input: 5570.06 toks/s, output: 815.86 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:01, 10.14it/s, est. speed input: 4206.85 toks/s, output: 615.62 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:15<00:00, 10.14it/s, est. speed input: 10637.02 toks/s, output: 1699.07 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.64s/it, est. speed input: 274.50 toks/s, output: 220.03 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.43s/it, est. speed input: 274.50 toks/s, output: 220.03 toks/s]
Processing batched inference:  27%|██▋       | 36/132 [04:27<18:01, 11.27s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 40.90it/s, est. speed input: 16054.04 toks/s, output: 2310.78 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 28.42it/s, est. speed input: 11745.84 toks/s, output: 2077.61 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.61it/s, est. speed input: 13311.41 toks/s, output: 2306.86 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.91it/s, est. speed input: 13311.41 toks/s, output: 2306.86 toks/s]
Processing batched inference:  28%|██▊       | 37/132 [04:29<13:30,  8.53s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 17.43it/s, est. speed input: 6861.29 toks/s, output: 1004.99 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 14.44it/s, est. speed input: 5869.13 toks/s, output: 861.38 toks/s] [A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 17.36it/s, est. speed input: 6632.73 toks/s, output: 1179.12 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.23it/s, est. speed input: 12281.97 toks/s, output: 1977.66 toks/s]
Processing batched inference:  29%|██▉       | 38/132 [04:31<10:15,  6.55s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 17.47it/s, est. speed input: 6866.01 toks/s, output: 995.72 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 39.48it/s, est. speed input: 14306.88 toks/s, output: 2068.02 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 29.88it/s, est. speed input: 11913.33 toks/s, output: 1725.79 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.92it/s, est. speed input: 11371.84 toks/s, output: 1829.58 toks/s]
Processing batched inference:  30%|██▉       | 39/132 [04:33<07:58,  5.15s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.66it/s, est. speed input: 2220.48 toks/s, output: 317.18 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 16.82it/s, est. speed input: 6014.02 toks/s, output: 987.81 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 29.16it/s, est. speed input: 9610.11 toks/s, output: 1565.58 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:14<00:00,  1.10it/s, est. speed input: 431.49 toks/s, output: 249.97 toks/s]  
Processing batched inference:  30%|███       | 40/132 [04:49<12:53,  8.41s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.32it/s, est. speed input: 2092.61 toks/s, output: 303.48 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 15.43it/s, est. speed input: 5309.08 toks/s, output: 769.96 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 18.25it/s, est. speed input: 6327.55 toks/s, output: 915.73 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.49it/s, est. speed input: 11655.14 toks/s, output: 1765.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.62it/s, est. speed input: 11655.14 toks/s, output: 1765.95 toks/s]
Processing batched inference:  31%|███       | 41/132 [04:51<09:44,  6.43s/it]Resource status after batch 40:
Open files: 0
Memory usage: 6813.54 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.01it/s, est. speed input: 1578.51 toks/s, output: 232.35 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 41.43it/s, est. speed input: 13560.90 toks/s, output: 1962.57 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.35it/s, est. speed input: 10342.03 toks/s, output: 1636.90 toks/s]
Processing batched inference:  32%|███▏      | 42/132 [04:53<07:37,  5.08s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 18.69it/s, est. speed input: 7323.48 toks/s, output: 1040.73 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 23.77it/s, est. speed input: 8958.43 toks/s, output: 1469.46 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 32.30it/s, est. speed input: 11505.61 toks/s, output: 2101.43 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:15<00:00, 32.30it/s, est. speed input: 8717.62 toks/s, output: 1742.60 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.13s/it, est. speed input: 273.25 toks/s, output: 229.54 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.44s/it, est. speed input: 273.25 toks/s, output: 229.54 toks/s]
Processing batched inference:  33%|███▎      | 43/132 [05:17<16:14, 10.95s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 22.76it/s, est. speed input: 8946.01 toks/s, output: 1297.43 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 23.96it/s, est. speed input: 9320.54 toks/s, output: 1639.81 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 28.98it/s, est. speed input: 10656.56 toks/s, output: 1973.84 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 12.44it/s, est. speed input: 6055.72 toks/s, output: 1347.07 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.40it/s, est. speed input: 6055.72 toks/s, output: 1347.07 toks/s]
Processing batched inference:  33%|███▎      | 44/132 [05:20<12:21,  8.43s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.41it/s, est. speed input: 948.18 toks/s, output: 137.51 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.96it/s, est. speed input: 8343.87 toks/s, output: 1271.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.23it/s, est. speed input: 8343.87 toks/s, output: 1271.78 toks/s]
Processing batched inference:  34%|███▍      | 45/132 [05:21<09:20,  6.44s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.44it/s, est. speed input: 2125.73 toks/s, output: 298.99 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 17.67it/s, est. speed input: 6098.71 toks/s, output: 868.54 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 16.60it/s, est. speed input: 6048.53 toks/s, output: 864.05 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 22.53it/s, est. speed input: 7706.61 toks/s, output: 1243.05 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.93it/s, est. speed input: 7153.60 toks/s, output: 1404.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.24it/s, est. speed input: 7153.60 toks/s, output: 1404.68 toks/s]
Processing batched inference:  35%|███▍      | 46/132 [05:24<07:22,  5.15s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.81it/s, est. speed input: 1486.07 toks/s, output: 205.75 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:02,  5.74it/s, est. speed input: 2086.05 toks/s, output: 293.42 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 13.22it/s, est. speed input: 4043.67 toks/s, output: 575.88 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 24.98it/s, est. speed input: 7547.04 toks/s, output: 1148.24 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.07it/s, est. speed input: 7881.21 toks/s, output: 1258.10 toks/s]
Processing batched inference:  36%|███▌      | 47/132 [05:26<05:55,  4.18s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 16.45it/s, est. speed input: 6454.96 toks/s, output: 926.77 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 23.93it/s, est. speed input: 8873.35 toks/s, output: 1275.83 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 28.94it/s, est. speed input: 10360.98 toks/s, output: 1614.06 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 14.82it/s, est. speed input: 6705.92 toks/s, output: 1332.27 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 13.84it/s, est. speed input: 5431.35 toks/s, output: 1185.42 toks/s]
Processing batched inference:  36%|███▋      | 48/132 [05:28<05:13,  3.73s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  7.09it/s, est. speed input: 2774.22 toks/s, output: 390.20 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 14.65it/s, est. speed input: 5325.98 toks/s, output: 766.64 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 30.70it/s, est. speed input: 9859.17 toks/s, output: 1412.72 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 28.67it/s, est. speed input: 9966.47 toks/s, output: 1603.57 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.98it/s, est. speed input: 6662.41 toks/s, output: 1207.67 toks/s]
Processing batched inference:  37%|███▋      | 49/132 [05:30<04:29,  3.25s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  7.68it/s, est. speed input: 3020.40 toks/s, output: 438.01 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01,  8.59it/s, est. speed input: 3314.02 toks/s, output: 477.02 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 16.92it/s, est. speed input: 5680.27 toks/s, output: 823.80 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 27.05it/s, est. speed input: 9053.21 toks/s, output: 1384.38 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:17<00:00, 27.05it/s, est. speed input: 9053.21 toks/s, output: 1384.38 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.25s/it, est. speed input: 274.30 toks/s, output: 218.08 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.43s/it, est. speed input: 274.30 toks/s, output: 218.08 toks/s]
Processing batched inference:  38%|███▊      | 50/132 [05:55<13:02,  9.54s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.98it/s, est. speed input: 1163.48 toks/s, output: 163.65 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 25.53it/s, est. speed input: 8634.38 toks/s, output: 1330.25 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00,  8.87it/s, est. speed input: 3486.54 toks/s, output: 697.08 toks/s] 
Processing batched inference:  39%|███▊      | 51/132 [05:57<10:08,  7.52s/it]Resource status after batch 50:
Open files: 0
Memory usage: 7790.70 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  9.36it/s, est. speed input: 3652.56 toks/s, output: 505.65 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 30.10it/s, est. speed input: 10632.19 toks/s, output: 1526.53 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 28.67it/s, est. speed input: 10691.20 toks/s, output: 1548.25 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 31.48it/s, est. speed input: 11526.57 toks/s, output: 1865.16 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.12it/s, est. speed input: 9475.75 toks/s, output: 1658.15 toks/s] 
Processing batched inference:  39%|███▉      | 52/132 [05:59<07:50,  5.88s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.22it/s, est. speed input: 873.84 toks/s, output: 128.63 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 18.94it/s, est. speed input: 6256.10 toks/s, output: 960.32 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 17.26it/s, est. speed input: 6118.06 toks/s, output: 1158.14 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.58it/s, est. speed input: 6118.06 toks/s, output: 1158.14 toks/s]
Processing batched inference:  40%|████      | 53/132 [06:01<06:11,  4.70s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.72it/s, est. speed input: 1859.05 toks/s, output: 273.64 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01, 10.70it/s, est. speed input: 3726.87 toks/s, output: 535.10 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 20.65it/s, est. speed input: 6648.12 toks/s, output: 964.20 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 27.21it/s, est. speed input: 8628.09 toks/s, output: 1313.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.75it/s, est. speed input: 8147.26 toks/s, output: 1352.88 toks/s]
Processing batched inference:  41%|████      | 54/132 [06:03<04:59,  3.83s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.42it/s, est. speed input: 955.14 toks/s, output: 140.60 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 19.91it/s, est. speed input: 6698.93 toks/s, output: 1021.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.80it/s, est. speed input: 7777.50 toks/s, output: 1360.39 toks/s]
Processing batched inference:  42%|████▏     | 55/132 [06:05<04:08,  3.23s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.98it/s, est. speed input: 2749.94 toks/s, output: 404.77 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 21.89it/s, est. speed input: 7772.95 toks/s, output: 1127.29 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 27.15it/s, est. speed input: 9824.50 toks/s, output: 1572.62 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.13it/s, est. speed input: 9873.06 toks/s, output: 1649.40 toks/s]
Processing batched inference:  42%|████▏     | 56/132 [06:07<03:39,  2.88s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:08,  1.76it/s, est. speed input: 690.10 toks/s, output: 97.07 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 19.42it/s, est. speed input: 6280.77 toks/s, output: 961.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.38it/s, est. speed input: 6830.13 toks/s, output: 1145.22 toks/s]
Processing batched inference:  43%|████▎     | 57/132 [06:09<03:07,  2.50s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.10it/s, est. speed input: 1214.14 toks/s, output: 173.44 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 23.72it/s, est. speed input: 7617.89 toks/s, output: 1095.63 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 20.27it/s, est. speed input: 7243.30 toks/s, output: 1177.87 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 14.11it/s, est. speed input: 5877.78 toks/s, output: 1213.69 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 14.96it/s, est. speed input: 5877.78 toks/s, output: 1213.69 toks/s]
Processing batched inference:  44%|████▍     | 58/132 [06:11<02:59,  2.42s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.37it/s, est. speed input: 1314.75 toks/s, output: 182.03 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 37.86it/s, est. speed input: 11836.28 toks/s, output: 1705.92 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.29it/s, est. speed input: 10313.91 toks/s, output: 1628.31 toks/s]
Processing batched inference:  45%|████▍     | 59/132 [06:13<02:42,  2.23s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.51it/s, est. speed input: 981.10 toks/s, output: 138.00 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 24.84it/s, est. speed input: 8204.25 toks/s, output: 1262.05 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 12.79it/s, est. speed input: 5024.48 toks/s, output: 910.26 toks/s] 
Processing batched inference:  45%|████▌     | 60/132 [06:15<02:38,  2.21s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.59it/s, est. speed input: 1019.57 toks/s, output: 150.08 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 28.78it/s, est. speed input: 8853.94 toks/s, output: 1275.36 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.46it/s, est. speed input: 6063.05 toks/s, output: 1092.61 toks/s]
Processing batched inference:  46%|████▌     | 61/132 [06:17<02:30,  2.12s/it]Resource status after batch 60:
Open files: 0
Memory usage: 8465.90 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.51it/s, est. speed input: 980.03 toks/s, output: 137.85 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.99it/s, est. speed input: 9497.50 toks/s, output: 1435.18 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.19it/s, est. speed input: 9497.50 toks/s, output: 1435.18 toks/s]
Processing batched inference:  47%|████▋     | 62/132 [06:18<02:17,  1.97s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.78it/s, est. speed input: 1091.88 toks/s, output: 158.36 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.11it/s, est. speed input: 9688.26 toks/s, output: 1453.51 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.71it/s, est. speed input: 9688.26 toks/s, output: 1453.51 toks/s]
Processing batched inference:  48%|████▊     | 63/132 [06:20<02:12,  1.92s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.63it/s, est. speed input: 1032.72 toks/s, output: 147.52 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 21.41it/s, est. speed input: 7131.65 toks/s, output: 1093.43 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.54it/s, est. speed input: 8853.78 toks/s, output: 1617.42 toks/s]
Processing batched inference:  48%|████▊     | 64/132 [06:22<02:05,  1.85s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:07,  1.97it/s, est. speed input: 770.99 toks/s, output: 110.14 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 20.81it/s, est. speed input: 6694.24 toks/s, output: 1027.65 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.15it/s, est. speed input: 5613.48 toks/s, output: 1030.03 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 14.28it/s, est. speed input: 5613.48 toks/s, output: 1030.03 toks/s]
Processing batched inference:  49%|████▉     | 65/132 [06:24<02:05,  1.88s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.06it/s, est. speed input: 1204.31 toks/s, output: 174.66 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 21.86it/s, est. speed input: 6983.45 toks/s, output: 1010.94 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 19.46it/s, est. speed input: 6870.85 toks/s, output: 1266.58 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.26it/s, est. speed input: 8358.01 toks/s, output: 1723.37 toks/s]
Processing batched inference:  50%|█████     | 66/132 [06:26<02:06,  1.92s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.81it/s, est. speed input: 2273.11 toks/s, output: 319.71 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01,  7.24it/s, est. speed input: 2740.69 toks/s, output: 394.48 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 24.07it/s, est. speed input: 8043.91 toks/s, output: 1257.40 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.00it/s, est. speed input: 8786.75 toks/s, output: 1626.99 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.32it/s, est. speed input: 8786.75 toks/s, output: 1626.99 toks/s]
Processing batched inference:  51%|█████     | 67/132 [06:28<02:06,  1.95s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 59.86it/s, est. speed input: 23520.28 toks/s, output: 3402.41 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 27.45it/s, est. speed input: 11728.62 toks/s, output: 1805.25 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.73it/s, est. speed input: 9249.12 toks/s, output: 1533.60 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.56it/s, est. speed input: 9249.12 toks/s, output: 1533.60 toks/s]
Processing batched inference:  52%|█████▏    | 68/132 [06:30<02:07,  1.99s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.42it/s, est. speed input: 1738.78 toks/s, output: 252.17 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 13.76it/s, est. speed input: 4654.94 toks/s, output: 662.40 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 31.88it/s, est. speed input: 9793.43 toks/s, output: 1498.00 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.54it/s, est. speed input: 10283.00 toks/s, output: 1846.05 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.23it/s, est. speed input: 10283.00 toks/s, output: 1846.05 toks/s]
Processing batched inference:  52%|█████▏    | 69/132 [06:32<02:00,  1.91s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.38it/s, est. speed input: 1721.11 toks/s, output: 249.60 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01, 10.20it/s, est. speed input: 3528.44 toks/s, output: 504.03 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 18.83it/s, est. speed input: 5959.19 toks/s, output: 854.99 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 30.87it/s, est. speed input: 9129.70 toks/s, output: 1393.43 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:16<00:00, 30.87it/s, est. speed input: 7651.12 toks/s, output: 1228.63 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:20<00:00,  2.05s/it, est. speed input: 307.71 toks/s, output: 225.40 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:20<00:00,  1.28s/it, est. speed input: 307.71 toks/s, output: 225.40 toks/s]
Processing batched inference:  53%|█████▎    | 70/132 [06:53<08:02,  7.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.23it/s, est. speed input: 869.93 toks/s, output: 120.44 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 21.93it/s, est. speed input: 7146.79 toks/s, output: 1088.79 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 16.63it/s, est. speed input: 6138.39 toks/s, output: 1117.83 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.63it/s, est. speed input: 6138.39 toks/s, output: 1117.83 toks/s]
Processing batched inference:  54%|█████▍    | 71/132 [06:55<06:08,  6.04s/it]Resource status after batch 70:
Open files: 0
Memory usage: 9003.00 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 18.53it/s, est. speed input: 7282.01 toks/s, output: 1056.06 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 15.74it/s, est. speed input: 6353.43 toks/s, output: 918.68 toks/s] [A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 26.83it/s, est. speed input: 9436.80 toks/s, output: 1355.56 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 28.99it/s, est. speed input: 10180.80 toks/s, output: 1624.38 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.62it/s, est. speed input: 8487.32 toks/s, output: 1413.82 toks/s] 
Processing batched inference:  55%|█████▍    | 72/132 [06:57<04:48,  4.82s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.68it/s, est. speed input: 1047.68 toks/s, output: 147.36 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 22.64it/s, est. speed input: 7495.73 toks/s, output: 1153.27 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.83it/s, est. speed input: 9353.35 toks/s, output: 1690.70 toks/s]
Processing batched inference:  55%|█████▌    | 73/132 [06:59<03:48,  3.87s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.05it/s, est. speed input: 1192.10 toks/s, output: 167.68 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 13.33it/s, est. speed input: 4350.29 toks/s, output: 625.25 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 24.39it/s, est. speed input: 7755.98 toks/s, output: 1176.37 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.84it/s, est. speed input: 8175.93 toks/s, output: 1355.69 toks/s]
Processing batched inference:  56%|█████▌    | 74/132 [07:01<03:07,  3.24s/it]ERROR 06-30 23:10:42 [core.py:387] EngineCore hit an exception: Traceback (most recent call last):
ERROR 06-30 23:10:42 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 68, in __getitem__
ERROR 06-30 23:10:42 [core.py:387]     return self.__data[key]
ERROR 06-30 23:10:42 [core.py:387]            ~~~~~~~~~~~^^^^^
ERROR 06-30 23:10:42 [core.py:387] KeyError: '52d6efbfb53decdacbcfa8b1162473d7b7a555cecc85bbd1b653ec8f078b552e'
ERROR 06-30 23:10:42 [core.py:387] 
ERROR 06-30 23:10:42 [core.py:387] During handling of the above exception, another exception occurred:
ERROR 06-30 23:10:42 [core.py:387] 
ERROR 06-30 23:10:42 [core.py:387] Traceback (most recent call last):
ERROR 06-30 23:10:42 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 380, in run_engine_core
ERROR 06-30 23:10:42 [core.py:387]     engine_core.run_busy_loop()
ERROR 06-30 23:10:42 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 400, in run_busy_loop
ERROR 06-30 23:10:42 [core.py:387]     self._process_input_queue()
ERROR 06-30 23:10:42 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 425, in _process_input_queue
ERROR 06-30 23:10:42 [core.py:387]     self._handle_client_request(*req)
ERROR 06-30 23:10:42 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 441, in _handle_client_request
ERROR 06-30 23:10:42 [core.py:387]     self.add_request(request)
ERROR 06-30 23:10:42 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 177, in add_request
ERROR 06-30 23:10:42 [core.py:387]     request.mm_inputs = self.mm_input_cache_server.get_and_update_p1(
ERROR 06-30 23:10:42 [core.py:387]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:10:42 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/mm_input_cache.py", line 76, in get_and_update_p1
ERROR 06-30 23:10:42 [core.py:387]     mm_input = self.mm_cache[mm_hash]
ERROR 06-30 23:10:42 [core.py:387]                ~~~~~~~~~~~~~^^^^^^^^^
ERROR 06-30 23:10:42 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 211, in __getitem__
ERROR 06-30 23:10:42 [core.py:387]     value = cache_getitem(self, key)
ERROR 06-30 23:10:42 [core.py:387]             ^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:10:42 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 70, in __getitem__
ERROR 06-30 23:10:42 [core.py:387]     return self.__missing__(key)
ERROR 06-30 23:10:42 [core.py:387]            ^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:10:42 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 97, in __missing__
ERROR 06-30 23:10:42 [core.py:387]     raise KeyError(key)
ERROR 06-30 23:10:42 [core.py:387] KeyError: '52d6efbfb53decdacbcfa8b1162473d7b7a555cecc85bbd1b653ec8f078b552e'
ERROR 06-30 23:10:42 [core.py:387] 
CRITICAL 06-30 23:10:42 [core_client.py:359] Got fatal signal from worker processes, shutting down. See stack trace above for root cause issue.
batch_inference.sh: line 23: 470971 Killed                  python scripts/vllm_infer_new.py --model_name_or_path "$ckpt" --dataset $EVAL_DATASET --template qwen2_vl --save_name "$save_path/generated_predictions.jsonl" --max_new_tokens 4096 --temperature 0.0 --top_p 1.0 --top_k -1 --repetition_penalty 1.0 --batch_size 16 --seed 42
Running inference on checkpoint: checkpoint-441
INFO 06-30 23:10:52 [__init__.py:239] Automatically detected platform cuda.
[INFO|training_args.py:2135] 2025-06-30 23:10:54,559 >> PyTorch: setting up devices
[INFO|training_args.py:1812] 2025-06-30 23:10:54,616 >> The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:54,633 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:54,633 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:54,633 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:54,633 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:54,633 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:54,633 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:54,633 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:10:55,031 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:378] 2025-06-30 23:10:55,032 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441/preprocessor_config.json
[INFO|image_processing_base.py:378] 2025-06-30 23:10:55,036 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:10:55,043 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:55,045 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:55,045 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:55,045 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:55,045 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:55,045 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:55,045 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:10:55,045 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:10:55,430 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:10:55,431 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:10:55,630 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:10:56,084 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}

[INFO|configuration_utils.py:696] 2025-06-30 23:10:56,141 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441/config.json
[INFO|configuration_utils.py:696] 2025-06-30 23:10:56,141 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441/config.json
[INFO|configuration_utils.py:770] 2025-06-30 23:10:56,143 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "text_config": {
    "architectures": [
      "Qwen2VLForConditionalGeneration"
    ],
    "attention_dropout": 0.0,
    "bos_token_id": 151643,
    "eos_token_id": 151645,
    "hidden_act": "silu",
    "hidden_size": 1536,
    "image_token_id": null,
    "initializer_range": 0.02,
    "intermediate_size": 8960,
    "max_position_embeddings": 32768,
    "max_window_layers": 28,
    "model_type": "qwen2_vl_text",
    "num_attention_heads": 12,
    "num_hidden_layers": 28,
    "num_key_value_heads": 2,
    "rms_norm_eps": 1e-06,
    "rope_scaling": {
      "mrope_section": [
        16,
        24,
        24
      ],
      "rope_type": "default",
      "type": "default"
    },
    "rope_theta": 1000000.0,
    "sliding_window": 32768,
    "tie_word_embeddings": true,
    "torch_dtype": "float32",
    "use_cache": false,
    "use_sliding_window": false,
    "video_token_id": null,
    "vision_end_token_id": 151653,
    "vision_start_token_id": 151652,
    "vision_token_id": 151654,
    "vocab_size": 151936
  },
  "torch_dtype": "bfloat16",
  "transformers_version": "4.52.4",
  "use_cache": false,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "depth": 32,
    "embed_dim": 1280,
    "hidden_act": "quick_gelu",
    "hidden_size": 1536,
    "in_channels": 3,
    "in_chans": 3,
    "initializer_range": 0.02,
    "mlp_ratio": 4,
    "model_type": "qwen2_vl",
    "num_heads": 16,
    "patch_size": 14,
    "spatial_merge_size": 2,
    "spatial_patch_size": 14,
    "temporal_patch_size": 2,
    "torch_dtype": "float32"
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 151936
}

INFO 06-30 23:11:07 [config.py:689] This model supports multiple tasks: {'embed', 'classify', 'generate', 'score', 'reward'}. Defaulting to 'generate'.
INFO 06-30 23:11:07 [config.py:1901] Chunked prefill is enabled with max_num_batched_tokens=8192.
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:11:08,802 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:11:08,803 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:11:08,803 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:11:08,803 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:11:08,803 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:11:08,803 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:11:08,803 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:11:09,140 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:1088] 2025-06-30 23:11:09,244 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441/generation_config.json
[INFO|configuration_utils.py:1135] 2025-06-30 23:11:09,247 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

WARNING 06-30 23:11:09 [utils.py:2304] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/getting_started/troubleshooting.html#python-multiprocessing for more information. Reason: CUDA is initialized
INFO 06-30 23:11:16 [__init__.py:239] Automatically detected platform cuda.
INFO 06-30 23:11:19 [core.py:61] Initializing a V1 LLM engine (v0.8.4) with config: model='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441', speculative_config=None, tokenizer='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-30 23:11:20 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f3500e4bd90>
INFO 06-30 23:11:21 [parallel_state.py:959] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-30 23:11:21 [cuda.py:221] Using Flash Attention backend on V1 engine.
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:11:24 [gpu_model_runner.py:1276] Starting to load model saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441...
WARNING 06-30 23:11:24 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-30 23:11:24 [config.py:3466] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
WARNING 06-30 23:11:24 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.30s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.30s/it]

INFO 06-30 23:11:31 [loader.py:458] Loading weights took 7.51 seconds
INFO 06-30 23:11:32 [gpu_model_runner.py:1291] Model loading took 4.1513 GiB and 7.698879 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:11:33 [gpu_model_runner.py:1560] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-30 23:11:48 [backends.py:416] Using cache directory: /root/.cache/vllm/torch_compile_cache/9c6bff6e45/rank_0_0 for vLLM's torch.compile
INFO 06-30 23:11:48 [backends.py:426] Dynamo bytecode transform time: 7.90 s
INFO 06-30 23:11:48 [backends.py:115] Directly load the compiled graph for shape None from the cache
INFO 06-30 23:11:55 [monitor.py:33] torch.compile takes 7.90 s in total
INFO 06-30 23:11:56 [kv_cache_utils.py:634] GPU KV cache size: 1,006,016 tokens
INFO 06-30 23:11:56 [kv_cache_utils.py:637] Maximum concurrency for 6,144 tokens per request: 163.74x
INFO 06-30 23:12:16 [gpu_model_runner.py:1626] Graph capturing finished in 20 secs, took 0.47 GiB
INFO 06-30 23:12:16 [core.py:163] init engine (profile, create kv cache, warmup model) took 44.40 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:12:17 [core_client.py:435] Core engine process 0 ready.
[INFO|2025-06-30 23:12:17] llamafactory.data.loader:143 >> Loading dataset ./0_my_dataset/vindr/qwen2_vindr_input_test_len_2108.json...
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151653, 198, 5598, 30618, 14697, 315, 364, 47, 811, 372, 8767, 269, 706, 6, 5671, 438, 4718, 3561, 510, 73594, 2236, 198, 9640, 4913, 58456, 62, 17, 67, 788, 508, 87, 16, 11, 379, 16, 11, 856, 17, 11, 379, 17, 1125, 330, 1502, 788, 330, 1502, 7115, 9338, 921, 73594, 151645, 198, 151644, 77091, 198]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|vision_end|>
Return bounding boxes of 'Pneumothorax' areas as JSON format:
```json
[
{"bbox_2d": [x1, y1, x2, y2], "label": "label"},
...
]
```<|im_end|>
<|im_start|>assistant

label_ids:
[27, 9217, 397, 9640, 220, 341, 262, 330, 58456, 62, 17, 67, 788, 2278, 414, 220, 16, 22, 20, 345, 414, 220, 17, 22, 24, 345, 414, 220, 18, 15, 17, 345, 414, 220, 21, 23, 16, 198, 262, 3211, 262, 330, 1502, 788, 330, 47, 811, 372, 8767, 269, 706, 698, 220, 456, 921, 522, 9217, 29, 151645, 198]
labels:
<answer>
[
  {
    "bbox_2d": [
      175,
      279,
      302,
      681
    ],
    "label": "Pneumothorax"
  }
]
</answer><|im_end|>

Current file descriptor limits: soft=8192, hard=8192
Initial resource status:
Open files: 0
Memory usage: 926.81 MB
Using effective batch size: 16
Processing batched inference:   0%|          | 0/132 [00:00<?, ?it/s][INFO|image_processing_base.py:378] 2025-06-30 23:12:19,018 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:12:19,018 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|image_processing_base.py:378] 2025-06-30 23:12:19,019 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:12:19,019 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:12:19,020 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:12:19,020 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:12:19,020 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:12:19,020 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:12:19,020 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:12:19,020 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:12:19,020 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:12:19,838 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:12:19,838 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:12:19,838 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:12:20,318 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: CachedQwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-441', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='left', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}


Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 87.22it/s, est. speed input: 34320.85 toks/s, output: 6184.82 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.34it/s, est. speed input: 16259.04 toks/s, output: 2990.17 toks/s]
Processing batched inference:   1%|          | 1/132 [00:04<09:33,  4.38s/it]Resource status after batch 0:
Open files: 0
Memory usage: 1086.88 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 92.32it/s, est. speed input: 36231.48 toks/s, output: 5554.65 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.83it/s, est. speed input: 9754.49 toks/s, output: 1629.85 toks/s] 
Processing batched inference:   2%|▏         | 2/132 [00:07<07:41,  3.55s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 71.18it/s, est. speed input: 27918.41 toks/s, output: 4000.22 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.85it/s, est. speed input: 15649.32 toks/s, output: 2500.64 toks/s]
Processing batched inference:   2%|▏         | 3/132 [00:10<06:45,  3.14s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 85.62it/s, est. speed input: 33604.56 toks/s, output: 5541.88 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 10.92it/s, est. speed input: 4287.44 toks/s, output: 914.92 toks/s]  
Processing batched inference:   3%|▎         | 4/132 [00:13<07:05,  3.33s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 65.36it/s, est. speed input: 25704.49 toks/s, output: 4052.64 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.09it/s, est. speed input: 6319.46 toks/s, output: 1345.75 toks/s] 
Processing batched inference:   4%|▍         | 5/132 [00:16<07:01,  3.32s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 91.27it/s, est. speed input: 35894.33 toks/s, output: 5970.47 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.68it/s, est. speed input: 17178.97 toks/s, output: 2897.19 toks/s]
Processing batched inference:   5%|▍         | 6/132 [00:19<06:33,  3.12s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 84.77it/s, est. speed input: 33231.78 toks/s, output: 5375.72 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 45.01it/s, est. speed input: 17638.87 toks/s, output: 3151.11 toks/s]
Processing batched inference:   5%|▌         | 7/132 [00:22<06:07,  2.94s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 56.33it/s, est. speed input: 22140.17 toks/s, output: 3627.01 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.43it/s, est. speed input: 15496.86 toks/s, output: 2597.92 toks/s]
Processing batched inference:   6%|▌         | 8/132 [00:24<05:48,  2.81s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 85.90it/s, est. speed input: 33745.12 toks/s, output: 5345.14 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:02<00:00,  6.71it/s, est. speed input: 2634.60 toks/s, output: 664.41 toks/s] 
Processing batched inference:   7%|▋         | 9/132 [00:29<06:53,  3.36s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 69.77it/s, est. speed input: 27388.90 toks/s, output: 3942.18 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 32.15it/s, est. speed input: 13825.85 toks/s, output: 2223.71 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.92it/s, est. speed input: 12928.70 toks/s, output: 2154.04 toks/s]
Processing batched inference:   8%|▊         | 10/132 [00:31<06:15,  3.08s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 79.17it/s, est. speed input: 31063.11 toks/s, output: 4786.47 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.07it/s, est. speed input: 16889.01 toks/s, output: 2905.30 toks/s]
Processing batched inference:   8%|▊         | 11/132 [00:34<05:47,  2.87s/it]Resource status after batch 10:
Open files: 0
Memory usage: 2769.17 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 79.68it/s, est. speed input: 31273.67 toks/s, output: 4807.50 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.56it/s, est. speed input: 15929.31 toks/s, output: 2413.88 toks/s]
Processing batched inference:   9%|▉         | 12/132 [00:36<05:31,  2.76s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 73.45it/s, est. speed input: 28842.96 toks/s, output: 5081.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.97it/s, est. speed input: 16879.74 toks/s, output: 3072.76 toks/s]
Processing batched inference:  10%|▉         | 13/132 [00:39<05:15,  2.65s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 86.96it/s, est. speed input: 34112.82 toks/s, output: 5543.66 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.73it/s, est. speed input: 12455.26 toks/s, output: 2156.15 toks/s]
Processing batched inference:  11%|█         | 14/132 [00:41<05:04,  2.58s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 75.04it/s, est. speed input: 29460.77 toks/s, output: 4833.65 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:16<00:00, 75.04it/s, est. speed input: 15463.48 toks/s, output: 2482.68 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.79s/it, est. speed input: 282.11 toks/s, output: 226.31 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.39s/it, est. speed input: 282.11 toks/s, output: 226.31 toks/s]
Processing batched inference:  11%|█▏        | 15/132 [01:05<17:41,  9.08s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 58.41it/s, est. speed input: 22950.87 toks/s, output: 3615.02 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 31.01it/s, est. speed input: 13307.67 toks/s, output: 2237.83 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 12.33it/s, est. speed input: 4841.59 toks/s, output: 947.65 toks/s]  
Processing batched inference:  12%|█▏        | 16/132 [01:08<14:10,  7.33s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 44.12it/s, est. speed input: 17307.52 toks/s, output: 2729.96 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 43.61it/s, est. speed input: 17144.10 toks/s, output: 2914.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.75it/s, est. speed input: 10889.26 toks/s, output: 1965.15 toks/s]
Processing batched inference:  13%|█▎        | 17/132 [01:11<11:21,  5.92s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.58it/s, est. speed input: 2183.09 toks/s, output: 307.03 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 24.65it/s, est. speed input: 8268.14 toks/s, output: 1193.13 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 20.96it/s, est. speed input: 7789.68 toks/s, output: 1322.37 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 17.80it/s, est. speed input: 7082.27 toks/s, output: 1341.44 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:17<00:00, 17.80it/s, est. speed input: 7561.34 toks/s, output: 1532.62 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:23<00:02,  2.87s/it, est. speed input: 251.59 toks/s, output: 222.73 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:23<00:00,  1.46s/it, est. speed input: 267.80 toks/s, output: 396.99 toks/s]
Processing batched inference:  14%|█▎        | 18/132 [01:36<21:58, 11.56s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 95.48it/s, est. speed input: 37485.42 toks/s, output: 6189.11 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:11<00:00, 95.48it/s, est. speed input: 15855.67 toks/s, output: 2535.25 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.75s/it, est. speed input: 282.09 toks/s, output: 226.16 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.39s/it, est. speed input: 282.09 toks/s, output: 226.16 toks/s]
Processing batched inference:  14%|█▍        | 19/132 [02:00<28:57, 15.37s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 36.15it/s, est. speed input: 14208.28 toks/s, output: 2343.76 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 46.35it/s, est. speed input: 17458.63 toks/s, output: 3035.02 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.73it/s, est. speed input: 9317.72 toks/s, output: 1621.41 toks/s] 
Processing batched inference:  15%|█▌        | 20/132 [02:02<21:23, 11.46s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 74.08it/s, est. speed input: 29048.49 toks/s, output: 5421.34 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.08it/s, est. speed input: 8260.43 toks/s, output: 1795.66 toks/s] 
Processing batched inference:  16%|█▌        | 21/132 [02:05<16:28,  8.90s/it]Resource status after batch 20:
Open files: 0
Memory usage: 4310.73 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 78.36it/s, est. speed input: 30791.72 toks/s, output: 5226.82 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.03it/s, est. speed input: 16902.15 toks/s, output: 2956.29 toks/s]
Processing batched inference:  17%|█▋        | 22/132 [02:08<12:47,  6.98s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 64.56it/s, est. speed input: 25324.15 toks/s, output: 3628.31 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:19<00:00, 64.56it/s, est. speed input: 14893.48 toks/s, output: 2398.69 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.73s/it, est. speed input: 279.69 toks/s, output: 224.51 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.40s/it, est. speed input: 279.69 toks/s, output: 224.51 toks/s]
Processing batched inference:  17%|█▋        | 23/132 [02:32<22:09, 12.20s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 76.43it/s, est. speed input: 30032.07 toks/s, output: 4347.11 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:15<00:00, 76.43it/s, est. speed input: 15910.90 toks/s, output: 2437.56 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:21<00:00,  1.61s/it, est. speed input: 286.11 toks/s, output: 227.49 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:21<00:00,  1.37s/it, est. speed input: 286.11 toks/s, output: 227.49 toks/s]
Processing batched inference:  18%|█▊        | 24/132 [02:56<28:17, 15.72s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 31.62it/s, est. speed input: 12439.28 toks/s, output: 1813.06 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 24.42it/s, est. speed input: 10005.96 toks/s, output: 1688.37 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 17.88it/s, est. speed input: 7776.70 toks/s, output: 1380.92 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 12.02it/s, est. speed input: 4724.53 toks/s, output: 977.19 toks/s] 
Processing batched inference:  19%|█▉        | 25/132 [02:59<21:21, 11.98s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 84.61it/s, est. speed input: 33203.58 toks/s, output: 5186.53 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.81it/s, est. speed input: 16417.27 toks/s, output: 2495.70 toks/s]
Processing batched inference:  20%|█▉        | 26/132 [03:01<15:57,  9.03s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 33.78it/s, est. speed input: 13261.51 toks/s, output: 1908.80 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 24.47it/s, est. speed input: 10023.99 toks/s, output: 1445.56 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 28.91it/s, est. speed input: 11169.23 toks/s, output: 1948.34 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.47it/s, est. speed input: 11572.99 toks/s, output: 2260.71 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.50it/s, est. speed input: 11572.99 toks/s, output: 2260.71 toks/s]
Processing batched inference:  20%|██        | 27/132 [03:03<12:06,  6.92s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 86.84it/s, est. speed input: 34089.86 toks/s, output: 4906.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.24it/s, est. speed input: 9510.05 toks/s, output: 1574.37 toks/s] 
Processing batched inference:  21%|██        | 28/132 [03:06<09:45,  5.63s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 56.61it/s, est. speed input: 22232.53 toks/s, output: 3195.41 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 23.66it/s, est. speed input: 10379.62 toks/s, output: 2004.71 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.98it/s, est. speed input: 10201.39 toks/s, output: 2008.73 toks/s]
Processing batched inference:  22%|██▏       | 29/132 [03:09<08:03,  4.69s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 55.24it/s, est. speed input: 21675.69 toks/s, output: 3424.73 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 24.58it/s, est. speed input: 10664.57 toks/s, output: 1812.60 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.19it/s, est. speed input: 9100.55 toks/s, output: 1652.22 toks/s] 
Processing batched inference:  23%|██▎       | 30/132 [03:11<06:51,  4.03s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 77.56it/s, est. speed input: 30517.96 toks/s, output: 5817.67 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.22it/s, est. speed input: 10610.93 toks/s, output: 2008.98 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.00it/s, est. speed input: 10610.93 toks/s, output: 2008.98 toks/s]
Processing batched inference:  23%|██▎       | 31/132 [03:14<06:00,  3.57s/it]Resource status after batch 30:
Open files: 0
Memory usage: 5566.96 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 71.52it/s, est. speed input: 28104.66 toks/s, output: 4069.61 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.94it/s, est. speed input: 17275.16 toks/s, output: 2771.90 toks/s]
Processing batched inference:  24%|██▍       | 32/132 [03:16<05:24,  3.24s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 25.93it/s, est. speed input: 10198.01 toks/s, output: 1471.49 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 21.13it/s, est. speed input: 8572.50 toks/s, output: 1234.40 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.04it/s, est. speed input: 9355.81 toks/s, output: 1424.28 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.80it/s, est. speed input: 9355.81 toks/s, output: 1424.28 toks/s]
Processing batched inference:  25%|██▌       | 33/132 [03:18<04:47,  2.91s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 78.32it/s, est. speed input: 30780.56 toks/s, output: 4865.07 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.04it/s, est. speed input: 15722.25 toks/s, output: 2959.02 toks/s]
Processing batched inference:  26%|██▌       | 34/132 [03:20<04:27,  2.72s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 50.21it/s, est. speed input: 19742.42 toks/s, output: 3220.79 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 39.79it/s, est. speed input: 16162.78 toks/s, output: 2479.85 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.24it/s, est. speed input: 9121.70 toks/s, output: 1518.08 toks/s] 
Processing batched inference:  27%|██▋       | 35/132 [03:23<04:15,  2.64s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 67.30it/s, est. speed input: 26464.61 toks/s, output: 4278.49 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.42it/s, est. speed input: 13801.49 toks/s, output: 2216.91 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.45it/s, est. speed input: 9602.58 toks/s, output: 1746.55 toks/s] 
Processing batched inference:  27%|██▋       | 36/132 [03:26<04:14,  2.65s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 15.82it/s, est. speed input: 6199.32 toks/s, output: 882.18 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 31.75it/s, est. speed input: 11134.41 toks/s, output: 1753.63 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 31.13it/s, est. speed input: 11375.05 toks/s, output: 1903.51 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.97it/s, est. speed input: 11762.60 toks/s, output: 2038.45 toks/s]
Processing batched inference:  28%|██▊       | 37/132 [03:28<03:57,  2.50s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 67.52it/s, est. speed input: 26573.96 toks/s, output: 4296.32 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 33.51it/s, est. speed input: 14327.98 toks/s, output: 2439.36 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.73it/s, est. speed input: 13658.58 toks/s, output: 2412.06 toks/s]
Processing batched inference:  29%|██▉       | 38/132 [03:30<03:51,  2.46s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 78.41it/s, est. speed input: 30811.06 toks/s, output: 4461.69 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.08it/s, est. speed input: 16154.28 toks/s, output: 2717.14 toks/s]
Processing batched inference:  30%|██▉       | 39/132 [03:32<03:35,  2.31s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 48.60it/s, est. speed input: 19074.34 toks/s, output: 2741.29 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 29.07it/s, est. speed input: 12158.66 toks/s, output: 1908.83 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 17.06it/s, est. speed input: 7835.99 toks/s, output: 1401.90 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.71it/s, est. speed input: 6169.56 toks/s, output: 1260.40 toks/s]
Processing batched inference:  30%|███       | 40/132 [03:35<03:38,  2.37s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 32.43it/s, est. speed input: 12741.21 toks/s, output: 1842.16 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 26.85it/s, est. speed input: 10839.98 toks/s, output: 1689.38 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 33.43it/s, est. speed input: 12587.14 toks/s, output: 2029.05 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.62it/s, est. speed input: 14380.43 toks/s, output: 2291.00 toks/s]
Processing batched inference:  31%|███       | 41/132 [03:37<03:25,  2.26s/it]Resource status after batch 40:
Open files: 0
Memory usage: 6707.06 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 60.43it/s, est. speed input: 23777.73 toks/s, output: 3468.89 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.16it/s, est. speed input: 12231.72 toks/s, output: 1941.81 toks/s]
Processing batched inference:  32%|███▏      | 42/132 [03:39<03:31,  2.35s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 69.63it/s, est. speed input: 27315.28 toks/s, output: 4642.40 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00,  8.29it/s, est. speed input: 3821.84 toks/s, output: 870.18 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00,  9.74it/s, est. speed input: 3821.84 toks/s, output: 870.18 toks/s]
Processing batched inference:  33%|███▎      | 43/132 [03:43<04:01,  2.72s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 40.47it/s, est. speed input: 15908.40 toks/s, output: 2703.54 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 27.77it/s, est. speed input: 11456.81 toks/s, output: 2223.67 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 22.59it/s, est. speed input: 9661.87 toks/s, output: 1902.12 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.22it/s, est. speed input: 7949.43 toks/s, output: 1763.26 toks/s]
Processing batched inference:  33%|███▎      | 44/132 [03:45<03:51,  2.63s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 29.19it/s, est. speed input: 11438.45 toks/s, output: 1627.43 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 45.52it/s, est. speed input: 16861.03 toks/s, output: 2445.38 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.68it/s, est. speed input: 9252.80 toks/s, output: 1551.67 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.52it/s, est. speed input: 9252.80 toks/s, output: 1551.67 toks/s]
Processing batched inference:  34%|███▍      | 45/132 [03:47<03:34,  2.47s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 45.57it/s, est. speed input: 17858.96 toks/s, output: 2543.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 31.03it/s, est. speed input: 12776.55 toks/s, output: 1971.81 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 24.25it/s, est. speed input: 10451.58 toks/s, output: 1766.56 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.38it/s, est. speed input: 7992.46 toks/s, output: 1569.40 toks/s] 
Processing batched inference:  35%|███▍      | 46/132 [03:50<03:28,  2.42s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 14.75it/s, est. speed input: 5769.74 toks/s, output: 811.52 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 17.87it/s, est. speed input: 6843.90 toks/s, output: 979.62 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 32.22it/s, est. speed input: 11023.20 toks/s, output: 1584.02 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.14it/s, est. speed input: 10450.47 toks/s, output: 1743.10 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.60it/s, est. speed input: 10450.47 toks/s, output: 1743.10 toks/s]
Processing batched inference:  36%|███▌      | 47/132 [03:51<03:12,  2.26s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 15.04it/s, est. speed input: 5900.00 toks/s, output: 847.05 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 26.05it/s, est. speed input: 9538.71 toks/s, output: 1383.39 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 28.43it/s, est. speed input: 10344.21 toks/s, output: 1773.66 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:16<00:00, 28.43it/s, est. speed input: 8778.11 toks/s, output: 1672.35 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.29s/it, est. speed input: 276.97 toks/s, output: 230.19 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.42s/it, est. speed input: 276.97 toks/s, output: 230.19 toks/s]
Processing batched inference:  36%|███▋      | 48/132 [04:16<12:23,  8.85s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  5.00it/s, est. speed input: 1954.92 toks/s, output: 274.96 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01, 10.01it/s, est. speed input: 3559.44 toks/s, output: 503.26 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 32.22it/s, est. speed input: 9619.41 toks/s, output: 1368.42 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 31.63it/s, est. speed input: 10173.47 toks/s, output: 1626.96 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.05it/s, est. speed input: 9438.45 toks/s, output: 1572.54 toks/s] 
Processing batched inference:  37%|███▋      | 49/132 [04:17<09:17,  6.72s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 42.45it/s, est. speed input: 16677.46 toks/s, output: 2411.38 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 46.34it/s, est. speed input: 17948.47 toks/s, output: 2587.28 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 31.39it/s, est. speed input: 13416.34 toks/s, output: 2381.72 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:10<00:00, 31.39it/s, est. speed input: 13416.34 toks/s, output: 2381.72 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.55s/it, est. speed input: 281.48 toks/s, output: 230.29 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.40s/it, est. speed input: 281.48 toks/s, output: 230.29 toks/s]
Processing batched inference:  38%|███▊      | 50/132 [04:41<16:13, 11.88s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.78it/s, est. speed input: 1477.80 toks/s, output: 207.87 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 36.37it/s, est. speed input: 11929.33 toks/s, output: 1736.14 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.50it/s, est. speed input: 6489.26 toks/s, output: 1144.77 toks/s] 
Processing batched inference:  39%|███▊      | 51/132 [04:44<12:06,  8.97s/it]Resource status after batch 50:
Open files: 0
Memory usage: 7672.78 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 22.31it/s, est. speed input: 8729.42 toks/s, output: 1231.69 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 32.25it/s, est. speed input: 11859.84 toks/s, output: 1701.90 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 37.01it/s, est. speed input: 13325.98 toks/s, output: 2148.57 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.66it/s, est. speed input: 10081.14 toks/s, output: 1695.12 toks/s]
Processing batched inference:  39%|███▉      | 52/132 [04:46<09:16,  6.95s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.74it/s, est. speed input: 1867.68 toks/s, output: 274.91 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  8.55it/s, est. speed input: 3108.46 toks/s, output: 448.56 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 21.60it/s, est. speed input: 7198.90 toks/s, output: 1095.53 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:01<00:00, 14.18it/s, est. speed input: 5601.74 toks/s, output: 988.63 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 12.83it/s, est. speed input: 5037.50 toks/s, output: 997.70 toks/s]
Processing batched inference:  40%|████      | 53/132 [04:48<07:24,  5.63s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01,  9.80it/s, est. speed input: 3847.63 toks/s, output: 553.82 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 25.46it/s, est. speed input: 8799.18 toks/s, output: 1273.43 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 22.15it/s, est. speed input: 8317.71 toks/s, output: 1201.39 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.65it/s, est. speed input: 8303.28 toks/s, output: 1314.01 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.15it/s, est. speed input: 8303.28 toks/s, output: 1314.01 toks/s]
Processing batched inference:  41%|████      | 54/132 [04:50<05:54,  4.55s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 17.47it/s, est. speed input: 6860.40 toks/s, output: 989.97 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 18.00it/s, est. speed input: 7035.09 toks/s, output: 1015.18 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 16.36it/s, est. speed input: 6590.48 toks/s, output: 954.05 toks/s] [A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 20.80it/s, est. speed input: 7659.06 toks/s, output: 1174.71 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.99it/s, est. speed input: 7987.31 toks/s, output: 1393.12 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.33it/s, est. speed input: 7987.31 toks/s, output: 1393.12 toks/s]
Processing batched inference:  42%|████▏     | 55/132 [04:53<04:56,  3.85s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 35.60it/s, est. speed input: 14019.23 toks/s, output: 2055.95 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 29.03it/s, est. speed input: 11714.03 toks/s, output: 1850.88 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 38.03it/s, est. speed input: 14211.46 toks/s, output: 2170.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.39it/s, est. speed input: 7223.56 toks/s, output: 1263.07 toks/s] 
Processing batched inference:  42%|████▏     | 56/132 [04:55<04:18,  3.40s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:08,  1.83it/s, est. speed input: 715.53 toks/s, output: 100.65 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 12.66it/s, est. speed input: 4154.96 toks/s, output: 657.83 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:14<00:00, 12.66it/s, est. speed input: 6472.90 toks/s, output: 1302.69 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.71s/it, est. speed input: 275.66 toks/s, output: 231.63 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.43s/it, est. speed input: 275.66 toks/s, output: 231.63 toks/s]
Processing batched inference:  43%|████▎     | 57/132 [05:18<11:47,  9.43s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 35.58it/s, est. speed input: 13981.04 toks/s, output: 2021.27 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 29.66it/s, est. speed input: 11972.14 toks/s, output: 1874.37 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 17.57it/s, est. speed input: 7920.46 toks/s, output: 1365.26 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:19<00:00, 17.57it/s, est. speed input: 6034.49 toks/s, output: 1170.42 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.35s/it, est. speed input: 278.65 toks/s, output: 232.23 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.41s/it, est. speed input: 278.65 toks/s, output: 232.23 toks/s]
Processing batched inference:  44%|████▍     | 58/132 [05:43<17:04, 13.84s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.83it/s, est. speed input: 2281.42 toks/s, output: 320.89 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 23.91it/s, est. speed input: 8291.69 toks/s, output: 1199.98 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 35.27it/s, est. speed input: 11637.86 toks/s, output: 1780.74 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.03it/s, est. speed input: 9428.17 toks/s, output: 1628.15 toks/s] 
Processing batched inference:  45%|████▍     | 59/132 [05:44<12:28, 10.25s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.10it/s, est. speed input: 1602.42 toks/s, output: 225.37 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 26.06it/s, est. speed input: 8541.79 toks/s, output: 1250.44 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 27.80it/s, est. speed input: 9705.50 toks/s, output: 1483.09 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.24it/s, est. speed input: 6775.17 toks/s, output: 1129.34 toks/s]
Processing batched inference:  45%|████▌     | 60/132 [05:46<09:18,  7.76s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.36it/s, est. speed input: 1324.03 toks/s, output: 194.89 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:01, 11.33it/s, est. speed input: 3772.01 toks/s, output: 538.83 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 24.47it/s, est. speed input: 7719.44 toks/s, output: 1174.29 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.43it/s, est. speed input: 8405.73 toks/s, output: 1450.49 toks/s]
Processing batched inference:  46%|████▌     | 61/132 [05:48<07:01,  5.94s/it]Resource status after batch 60:
Open files: 0
Memory usage: 8382.49 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 44.65it/s, est. speed input: 17528.24 toks/s, output: 2522.74 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 33.46it/s, est. speed input: 13681.49 toks/s, output: 2099.88 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 32.74it/s, est. speed input: 13327.84 toks/s, output: 2017.48 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 35.16it/s, est. speed input: 13803.18 toks/s, output: 2085.81 toks/s]
Processing batched inference:  47%|████▋     | 62/132 [05:50<05:27,  4.68s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.87it/s, est. speed input: 1905.06 toks/s, output: 267.96 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 46.59it/s, est. speed input: 15262.05 toks/s, output: 2190.47 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 35.01it/s, est. speed input: 13727.20 toks/s, output: 2059.42 toks/s]
Processing batched inference:  48%|████▊     | 63/132 [05:51<04:19,  3.77s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.93it/s, est. speed input: 1150.33 toks/s, output: 164.33 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 25.44it/s, est. speed input: 8661.04 toks/s, output: 1321.92 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.47it/s, est. speed input: 6863.66 toks/s, output: 1152.30 toks/s]
Processing batched inference:  48%|████▊     | 64/132 [05:53<03:36,  3.19s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 36.06it/s, est. speed input: 14176.62 toks/s, output: 2055.74 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 49.65it/s, est. speed input: 18793.96 toks/s, output: 2894.82 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.94it/s, est. speed input: 6660.78 toks/s, output: 1170.29 toks/s] 
Processing batched inference:  49%|████▉     | 65/132 [05:56<03:17,  2.95s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.48it/s, est. speed input: 2152.00 toks/s, output: 312.10 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 29.07it/s, est. speed input: 9625.98 toks/s, output: 1381.09 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 21.08it/s, est. speed input: 8060.56 toks/s, output: 1249.80 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.25it/s, est. speed input: 8927.41 toks/s, output: 1707.39 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.70it/s, est. speed input: 8927.41 toks/s, output: 1707.39 toks/s]
Processing batched inference:  50%|█████     | 66/132 [05:58<02:55,  2.65s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 42.71it/s, est. speed input: 16812.62 toks/s, output: 2460.13 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 30.85it/s, est. speed input: 12856.09 toks/s, output: 2199.61 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.32it/s, est. speed input: 9573.77 toks/s, output: 1698.19 toks/s] 
Processing batched inference:  51%|█████     | 67/132 [06:00<02:44,  2.54s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 49.99it/s, est. speed input: 19654.83 toks/s, output: 2849.60 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 24.24it/s, est. speed input: 10514.44 toks/s, output: 1603.30 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:18<00:00, 24.24it/s, est. speed input: 8494.38 toks/s, output: 1417.39 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.16s/it, est. speed input: 276.46 toks/s, output: 223.62 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.42s/it, est. speed input: 276.46 toks/s, output: 223.62 toks/s]
Processing batched inference:  52%|█████▏    | 68/132 [06:24<09:40,  9.07s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  8.74it/s, est. speed input: 3408.64 toks/s, output: 471.87 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 21.42it/s, est. speed input: 7712.02 toks/s, output: 1091.48 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 30.35it/s, est. speed input: 10493.21 toks/s, output: 1492.09 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 32.15it/s, est. speed input: 11344.31 toks/s, output: 1790.94 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.25it/s, est. speed input: 11076.26 toks/s, output: 1827.74 toks/s]
Processing batched inference:  52%|█████▏    | 69/132 [06:26<07:12,  6.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  7.03it/s, est. speed input: 2764.25 toks/s, output: 400.87 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01,  8.33it/s, est. speed input: 3184.93 toks/s, output: 461.91 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 17.37it/s, est. speed input: 5850.69 toks/s, output: 844.30 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 34.35it/s, est. speed input: 10149.57 toks/s, output: 1556.39 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 14.05it/s, est. speed input: 5517.74 toks/s, output: 1046.63 toks/s] 
Processing batched inference:  53%|█████▎    | 70/132 [06:28<05:41,  5.51s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.57it/s, est. speed input: 1003.08 toks/s, output: 138.88 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 20.17it/s, est. speed input: 6670.75 toks/s, output: 1026.23 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.67it/s, est. speed input: 8903.79 toks/s, output: 1688.00 toks/s]
Processing batched inference:  54%|█████▍    | 71/132 [06:30<04:26,  4.37s/it]Resource status after batch 70:
Open files: 0
Memory usage: 8916.79 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01, 12.77it/s, est. speed input: 5012.49 toks/s, output: 721.49 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 12.20it/s, est. speed input: 4822.33 toks/s, output: 694.13 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 29.16it/s, est. speed input: 9534.95 toks/s, output: 1362.10 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.95it/s, est. speed input: 9567.85 toks/s, output: 1599.92 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.37it/s, est. speed input: 9567.85 toks/s, output: 1599.92 toks/s]
Processing batched inference:  55%|█████▍    | 72/132 [06:32<03:39,  3.66s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.80it/s, est. speed input: 1093.10 toks/s, output: 153.75 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 25.05it/s, est. speed input: 8307.84 toks/s, output: 1269.81 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.04it/s, est. speed input: 9436.11 toks/s, output: 1636.53 toks/s]
Processing batched inference:  55%|█████▌    | 73/132 [06:34<03:00,  3.05s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.25it/s, est. speed input: 1271.97 toks/s, output: 178.91 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 34.19it/s, est. speed input: 10836.82 toks/s, output: 1555.97 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.52it/s, est. speed input: 9620.99 toks/s, output: 1598.36 toks/s] 
Processing batched inference:  56%|█████▌    | 74/132 [06:35<02:33,  2.65s/it]ERROR 06-30 23:18:55 [core.py:387] EngineCore hit an exception: Traceback (most recent call last):
ERROR 06-30 23:18:55 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 68, in __getitem__
ERROR 06-30 23:18:55 [core.py:387]     return self.__data[key]
ERROR 06-30 23:18:55 [core.py:387]            ~~~~~~~~~~~^^^^^
ERROR 06-30 23:18:55 [core.py:387] KeyError: '929683195666c1a255c3337d3fcde26f8a4e36266a607c6ecc05e41492395a52'
ERROR 06-30 23:18:55 [core.py:387] 
ERROR 06-30 23:18:55 [core.py:387] During handling of the above exception, another exception occurred:
ERROR 06-30 23:18:55 [core.py:387] 
ERROR 06-30 23:18:55 [core.py:387] Traceback (most recent call last):
ERROR 06-30 23:18:55 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 380, in run_engine_core
ERROR 06-30 23:18:55 [core.py:387]     engine_core.run_busy_loop()
ERROR 06-30 23:18:55 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 400, in run_busy_loop
ERROR 06-30 23:18:55 [core.py:387]     self._process_input_queue()
ERROR 06-30 23:18:55 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 425, in _process_input_queue
ERROR 06-30 23:18:55 [core.py:387]     self._handle_client_request(*req)
ERROR 06-30 23:18:55 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 441, in _handle_client_request
ERROR 06-30 23:18:55 [core.py:387]     self.add_request(request)
ERROR 06-30 23:18:55 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 177, in add_request
ERROR 06-30 23:18:55 [core.py:387]     request.mm_inputs = self.mm_input_cache_server.get_and_update_p1(
ERROR 06-30 23:18:55 [core.py:387]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:18:55 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/mm_input_cache.py", line 76, in get_and_update_p1
ERROR 06-30 23:18:55 [core.py:387]     mm_input = self.mm_cache[mm_hash]
ERROR 06-30 23:18:55 [core.py:387]                ~~~~~~~~~~~~~^^^^^^^^^
ERROR 06-30 23:18:55 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 211, in __getitem__
ERROR 06-30 23:18:55 [core.py:387]     value = cache_getitem(self, key)
ERROR 06-30 23:18:55 [core.py:387]             ^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:18:55 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 70, in __getitem__
ERROR 06-30 23:18:55 [core.py:387]     return self.__missing__(key)
ERROR 06-30 23:18:55 [core.py:387]            ^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:18:55 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 97, in __missing__
ERROR 06-30 23:18:55 [core.py:387]     raise KeyError(key)
ERROR 06-30 23:18:55 [core.py:387] KeyError: '929683195666c1a255c3337d3fcde26f8a4e36266a607c6ecc05e41492395a52'
ERROR 06-30 23:18:55 [core.py:387] 
CRITICAL 06-30 23:18:55 [core_client.py:359] Got fatal signal from worker processes, shutting down. See stack trace above for root cause issue.
batch_inference.sh: line 23: 480299 Killed                  python scripts/vllm_infer_new.py --model_name_or_path "$ckpt" --dataset $EVAL_DATASET --template qwen2_vl --save_name "$save_path/generated_predictions.jsonl" --max_new_tokens 4096 --temperature 0.0 --top_p 1.0 --top_k -1 --repetition_penalty 1.0 --batch_size 16 --seed 42
Running inference on checkpoint: checkpoint-504
INFO 06-30 23:19:05 [__init__.py:239] Automatically detected platform cuda.
[INFO|training_args.py:2135] 2025-06-30 23:19:07,637 >> PyTorch: setting up devices
[INFO|training_args.py:1812] 2025-06-30 23:19:07,686 >> The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:07,703 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:07,704 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:07,704 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:07,704 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:07,704 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:07,704 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:07,704 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:19:08,097 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:378] 2025-06-30 23:19:08,098 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504/preprocessor_config.json
[INFO|image_processing_base.py:378] 2025-06-30 23:19:08,103 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:19:08,109 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:08,110 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:08,110 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:08,110 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:08,110 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:08,110 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:08,110 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:08,110 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:19:08,489 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:19:08,491 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:19:08,709 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:19:09,163 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}

[INFO|configuration_utils.py:696] 2025-06-30 23:19:09,222 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504/config.json
[INFO|configuration_utils.py:696] 2025-06-30 23:19:09,223 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504/config.json
[INFO|configuration_utils.py:770] 2025-06-30 23:19:09,225 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "text_config": {
    "architectures": [
      "Qwen2VLForConditionalGeneration"
    ],
    "attention_dropout": 0.0,
    "bos_token_id": 151643,
    "eos_token_id": 151645,
    "hidden_act": "silu",
    "hidden_size": 1536,
    "image_token_id": null,
    "initializer_range": 0.02,
    "intermediate_size": 8960,
    "max_position_embeddings": 32768,
    "max_window_layers": 28,
    "model_type": "qwen2_vl_text",
    "num_attention_heads": 12,
    "num_hidden_layers": 28,
    "num_key_value_heads": 2,
    "rms_norm_eps": 1e-06,
    "rope_scaling": {
      "mrope_section": [
        16,
        24,
        24
      ],
      "rope_type": "default",
      "type": "default"
    },
    "rope_theta": 1000000.0,
    "sliding_window": 32768,
    "tie_word_embeddings": true,
    "torch_dtype": "float32",
    "use_cache": false,
    "use_sliding_window": false,
    "video_token_id": null,
    "vision_end_token_id": 151653,
    "vision_start_token_id": 151652,
    "vision_token_id": 151654,
    "vocab_size": 151936
  },
  "torch_dtype": "bfloat16",
  "transformers_version": "4.52.4",
  "use_cache": false,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "depth": 32,
    "embed_dim": 1280,
    "hidden_act": "quick_gelu",
    "hidden_size": 1536,
    "in_channels": 3,
    "in_chans": 3,
    "initializer_range": 0.02,
    "mlp_ratio": 4,
    "model_type": "qwen2_vl",
    "num_heads": 16,
    "patch_size": 14,
    "spatial_merge_size": 2,
    "spatial_patch_size": 14,
    "temporal_patch_size": 2,
    "torch_dtype": "float32"
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 151936
}

INFO 06-30 23:19:21 [config.py:689] This model supports multiple tasks: {'classify', 'score', 'reward', 'embed', 'generate'}. Defaulting to 'generate'.
INFO 06-30 23:19:21 [config.py:1901] Chunked prefill is enabled with max_num_batched_tokens=8192.
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:22,008 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:22,008 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:22,009 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:22,009 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:22,009 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:22,009 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:19:22,009 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:19:22,361 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:1088] 2025-06-30 23:19:22,454 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504/generation_config.json
[INFO|configuration_utils.py:1135] 2025-06-30 23:19:22,455 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

WARNING 06-30 23:19:22 [utils.py:2304] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/getting_started/troubleshooting.html#python-multiprocessing for more information. Reason: CUDA is initialized
INFO 06-30 23:19:30 [__init__.py:239] Automatically detected platform cuda.
INFO 06-30 23:19:33 [core.py:61] Initializing a V1 LLM engine (v0.8.4) with config: model='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504', speculative_config=None, tokenizer='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-30 23:19:33 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fe7fd7aea10>
INFO 06-30 23:19:34 [parallel_state.py:959] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-30 23:19:34 [cuda.py:221] Using Flash Attention backend on V1 engine.
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:19:37 [gpu_model_runner.py:1276] Starting to load model saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504...
WARNING 06-30 23:19:37 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-30 23:19:37 [config.py:3466] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
WARNING 06-30 23:19:37 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.26s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.26s/it]

INFO 06-30 23:19:45 [loader.py:458] Loading weights took 7.47 seconds
INFO 06-30 23:19:45 [gpu_model_runner.py:1291] Model loading took 4.1513 GiB and 7.656869 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:19:46 [gpu_model_runner.py:1560] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-30 23:20:01 [backends.py:416] Using cache directory: /root/.cache/vllm/torch_compile_cache/cd7ab86862/rank_0_0 for vLLM's torch.compile
INFO 06-30 23:20:01 [backends.py:426] Dynamo bytecode transform time: 7.79 s
INFO 06-30 23:20:01 [backends.py:115] Directly load the compiled graph for shape None from the cache
INFO 06-30 23:20:08 [monitor.py:33] torch.compile takes 7.79 s in total
INFO 06-30 23:20:09 [kv_cache_utils.py:634] GPU KV cache size: 1,006,016 tokens
INFO 06-30 23:20:09 [kv_cache_utils.py:637] Maximum concurrency for 6,144 tokens per request: 163.74x
INFO 06-30 23:20:29 [gpu_model_runner.py:1626] Graph capturing finished in 20 secs, took 0.47 GiB
INFO 06-30 23:20:29 [core.py:163] init engine (profile, create kv cache, warmup model) took 44.53 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:20:31 [core_client.py:435] Core engine process 0 ready.
[INFO|2025-06-30 23:20:31] llamafactory.data.loader:143 >> Loading dataset ./0_my_dataset/vindr/qwen2_vindr_input_test_len_2108.json...
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151653, 198, 5598, 30618, 14697, 315, 364, 47, 811, 372, 8767, 269, 706, 6, 5671, 438, 4718, 3561, 510, 73594, 2236, 198, 9640, 4913, 58456, 62, 17, 67, 788, 508, 87, 16, 11, 379, 16, 11, 856, 17, 11, 379, 17, 1125, 330, 1502, 788, 330, 1502, 7115, 9338, 921, 73594, 151645, 198, 151644, 77091, 198]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|vision_end|>
Return bounding boxes of 'Pneumothorax' areas as JSON format:
```json
[
{"bbox_2d": [x1, y1, x2, y2], "label": "label"},
...
]
```<|im_end|>
<|im_start|>assistant

label_ids:
[27, 9217, 397, 9640, 220, 341, 262, 330, 58456, 62, 17, 67, 788, 2278, 414, 220, 16, 22, 20, 345, 414, 220, 17, 22, 24, 345, 414, 220, 18, 15, 17, 345, 414, 220, 21, 23, 16, 198, 262, 3211, 262, 330, 1502, 788, 330, 47, 811, 372, 8767, 269, 706, 698, 220, 456, 921, 522, 9217, 29, 151645, 198]
labels:
<answer>
[
  {
    "bbox_2d": [
      175,
      279,
      302,
      681
    ],
    "label": "Pneumothorax"
  }
]
</answer><|im_end|>

Current file descriptor limits: soft=8192, hard=8192
Initial resource status:
Open files: 0
Memory usage: 928.99 MB
Using effective batch size: 16
Processing batched inference:   0%|          | 0/132 [00:00<?, ?it/s][INFO|image_processing_base.py:378] 2025-06-30 23:20:32,438 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:20:32,438 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|image_processing_base.py:378] 2025-06-30 23:20:32,439 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:20:32,439 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:20:32,440 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:20:32,440 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:20:32,440 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:20:32,440 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:20:32,440 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:20:32,440 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:20:32,440 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:20:33,247 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:20:33,248 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:20:33,248 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:20:33,765 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: CachedQwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-504', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='left', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}


Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 58.20it/s, est. speed input: 22908.52 toks/s, output: 4059.84 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 35.61it/s, est. speed input: 15011.83 toks/s, output: 2994.65 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.15it/s, est. speed input: 12248.07 toks/s, output: 2441.37 toks/s]
Processing batched inference:   1%|          | 1/132 [00:04<09:57,  4.56s/it]Resource status after batch 0:
Open files: 0
Memory usage: 1095.22 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 109.66it/s, est. speed input: 43067.03 toks/s, output: 6659.92 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.12it/s, est. speed input: 7902.04 toks/s, output: 1443.57 toks/s]  
Processing batched inference:   2%|▏         | 2/132 [00:07<08:02,  3.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 68.78it/s, est. speed input: 26992.70 toks/s, output: 4608.65 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.42it/s, est. speed input: 9097.78 toks/s, output: 1734.66 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.16it/s, est. speed input: 9097.78 toks/s, output: 1734.66 toks/s]
Processing batched inference:   2%|▏         | 3/132 [00:10<07:17,  3.39s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 80.77it/s, est. speed input: 31704.26 toks/s, output: 4890.26 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.17it/s, est. speed input: 11460.64 toks/s, output: 2093.58 toks/s]
Processing batched inference:   3%|▎         | 4/132 [00:13<06:53,  3.23s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 68.57it/s, est. speed input: 26965.92 toks/s, output: 4587.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.57it/s, est. speed input: 13184.28 toks/s, output: 2608.17 toks/s]
Processing batched inference:   4%|▍         | 5/132 [00:16<06:26,  3.05s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 84.73it/s, est. speed input: 33317.11 toks/s, output: 5977.30 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.12it/s, est. speed input: 7518.61 toks/s, output: 1559.63 toks/s] 
Processing batched inference:   5%|▍         | 6/132 [00:19<06:24,  3.05s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 101.20it/s, est. speed input: 39667.25 toks/s, output: 7193.91 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.00it/s, est. speed input: 11756.81 toks/s, output: 2100.34 toks/s] 
Processing batched inference:   5%|▌         | 7/132 [00:22<06:05,  2.93s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 94.87it/s, est. speed input: 37309.35 toks/s, output: 5882.12 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.78it/s, est. speed input: 15239.72 toks/s, output: 2324.56 toks/s]
Processing batched inference:   6%|▌         | 8/132 [00:24<05:48,  2.81s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 66.44it/s, est. speed input: 26056.07 toks/s, output: 3728.32 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 13.28it/s, est. speed input: 6025.67 toks/s, output: 1238.50 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.35it/s, est. speed input: 6025.67 toks/s, output: 1238.50 toks/s]
Processing batched inference:   7%|▋         | 9/132 [00:27<05:56,  2.90s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 93.82it/s, est. speed input: 36863.51 toks/s, output: 6643.13 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.29it/s, est. speed input: 9148.37 toks/s, output: 1797.90 toks/s] 
Processing batched inference:   8%|▊         | 10/132 [00:30<05:54,  2.90s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 59.48it/s, est. speed input: 23330.66 toks/s, output: 3648.02 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 23.79it/s, est. speed input: 10453.23 toks/s, output: 1980.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.63it/s, est. speed input: 8872.96 toks/s, output: 1996.09 toks/s] 
Processing batched inference:   8%|▊         | 11/132 [00:33<05:54,  2.93s/it]Resource status after batch 10:
Open files: 0
Memory usage: 2728.20 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 91.93it/s, est. speed input: 36103.03 toks/s, output: 5198.41 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.01it/s, est. speed input: 15712.21 toks/s, output: 2373.53 toks/s]
Processing batched inference:   9%|▉         | 12/132 [00:36<05:40,  2.84s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 79.77it/s, est. speed input: 31323.67 toks/s, output: 5185.04 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.41it/s, est. speed input: 12730.66 toks/s, output: 2323.63 toks/s]
Processing batched inference:  10%|▉         | 13/132 [00:38<05:32,  2.79s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 128.09it/s, est. speed input: 50229.83 toks/s, output: 8533.32 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.95it/s, est. speed input: 13326.62 toks/s, output: 2311.25 toks/s] 
Processing batched inference:  11%|█         | 14/132 [00:41<05:31,  2.81s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 58.09it/s, est. speed input: 22792.54 toks/s, output: 3531.87 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:16<00:00, 58.09it/s, est. speed input: 11100.76 toks/s, output: 2151.46 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.70s/it, est. speed input: 283.16 toks/s, output: 235.99 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.39s/it, est. speed input: 283.16 toks/s, output: 235.99 toks/s]
Processing batched inference:  11%|█▏        | 15/132 [01:06<18:03,  9.26s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 59.80it/s, est. speed input: 23519.78 toks/s, output: 4046.79 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 37.23it/s, est. speed input: 15694.19 toks/s, output: 2889.42 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.22it/s, est. speed input: 11477.02 toks/s, output: 2166.04 toks/s]
Processing batched inference:  12%|█▏        | 16/132 [01:08<14:08,  7.32s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 44.84it/s, est. speed input: 17599.51 toks/s, output: 2533.27 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 40.96it/s, est. speed input: 16344.43 toks/s, output: 2356.71 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.94it/s, est. speed input: 16850.81 toks/s, output: 2662.48 toks/s]
Processing batched inference:  13%|█▎        | 17/132 [01:11<11:10,  5.83s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 26.44it/s, est. speed input: 10375.84 toks/s, output: 1491.23 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 23.31it/s, est. speed input: 9360.17 toks/s, output: 1916.03 toks/s] [A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 16.15it/s, est. speed input: 7031.49 toks/s, output: 1436.10 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 15.65it/s, est. speed input: 6738.60 toks/s, output: 1558.63 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00,  9.92it/s, est. speed input: 3890.65 toks/s, output: 1027.66 toks/s]
Processing batched inference:  14%|█▎        | 18/132 [01:14<09:31,  5.02s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 77.54it/s, est. speed input: 30451.91 toks/s, output: 4981.99 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:13<00:00, 77.54it/s, est. speed input: 15978.05 toks/s, output: 2554.89 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.79s/it, est. speed input: 282.26 toks/s, output: 226.29 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.39s/it, est. speed input: 282.26 toks/s, output: 226.29 toks/s]
Processing batched inference:  14%|█▍        | 19/132 [01:38<20:23, 10.83s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 39.41it/s, est. speed input: 15488.77 toks/s, output: 2233.16 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 44.17it/s, est. speed input: 17016.45 toks/s, output: 2819.54 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.36it/s, est. speed input: 9374.70 toks/s, output: 1625.33 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.87it/s, est. speed input: 9374.70 toks/s, output: 1625.33 toks/s]
Processing batched inference:  15%|█▌        | 20/132 [01:41<15:28,  8.29s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 41.01it/s, est. speed input: 16075.79 toks/s, output: 2925.80 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 19.60it/s, est. speed input: 8538.82 toks/s, output: 1656.06 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.08it/s, est. speed input: 7479.27 toks/s, output: 1627.04 toks/s]
Processing batched inference:  16%|█▌        | 21/132 [01:44<12:29,  6.76s/it]Resource status after batch 20:
Open files: 0
Memory usage: 4252.12 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 76.45it/s, est. speed input: 30026.24 toks/s, output: 4677.22 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.48it/s, est. speed input: 16685.05 toks/s, output: 2788.21 toks/s]
Processing batched inference:  17%|█▋        | 22/132 [01:46<10:04,  5.49s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 70.12it/s, est. speed input: 27507.88 toks/s, output: 4232.64 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.21it/s, est. speed input: 13048.26 toks/s, output: 2283.65 toks/s]
Processing batched inference:  17%|█▋        | 23/132 [01:49<08:16,  4.55s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 51.15it/s, est. speed input: 20099.41 toks/s, output: 3222.82 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 31.37it/s, est. speed input: 13200.80 toks/s, output: 2145.67 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:18<00:00, 31.37it/s, est. speed input: 13745.88 toks/s, output: 2220.17 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:21<00:00,  2.16s/it, est. speed input: 286.15 toks/s, output: 229.76 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:21<00:00,  1.37s/it, est. speed input: 286.15 toks/s, output: 229.76 toks/s]
Processing batched inference:  18%|█▊        | 24/132 [02:13<18:39, 10.37s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 37.14it/s, est. speed input: 14610.31 toks/s, output: 2129.47 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 22.44it/s, est. speed input: 9494.13 toks/s, output: 1602.04 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.48it/s, est. speed input: 11844.98 toks/s, output: 2080.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.11it/s, est. speed input: 11844.98 toks/s, output: 2080.78 toks/s]
Processing batched inference:  19%|█▉        | 25/132 [02:15<14:09,  7.94s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 39.63it/s, est. speed input: 15552.89 toks/s, output: 2232.85 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 42.57it/s, est. speed input: 16540.97 toks/s, output: 2690.27 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.86it/s, est. speed input: 16438.41 toks/s, output: 2619.29 toks/s]
Processing batched inference:  20%|█▉        | 26/132 [02:17<10:49,  6.13s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 46.97it/s, est. speed input: 18463.24 toks/s, output: 2667.97 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 26.05it/s, est. speed input: 10966.42 toks/s, output: 1845.35 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 26.72it/s, est. speed input: 10935.37 toks/s, output: 2020.96 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 13.24it/s, est. speed input: 5193.79 toks/s, output: 1132.09 toks/s] 
Processing batched inference:  20%|██        | 27/132 [02:20<08:58,  5.13s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 68.36it/s, est. speed input: 26824.15 toks/s, output: 3845.88 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 13.80it/s, est. speed input: 6205.69 toks/s, output: 1289.22 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.67it/s, est. speed input: 6539.38 toks/s, output: 1435.79 toks/s]
Processing batched inference:  21%|██        | 28/132 [02:23<07:51,  4.54s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 26.42it/s, est. speed input: 10340.63 toks/s, output: 1750.72 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 26.37it/s, est. speed input: 10348.94 toks/s, output: 2103.91 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 26.26it/s, est. speed input: 10325.41 toks/s, output: 2219.73 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:01<00:00,  9.35it/s, est. speed input: 4908.27 toks/s, output: 1264.34 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:02<00:00,  6.69it/s, est. speed input: 2626.81 toks/s, output: 838.79 toks/s] 
Processing batched inference:  22%|██▏       | 29/132 [02:27<07:31,  4.38s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 69.58it/s, est. speed input: 27317.78 toks/s, output: 4283.22 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 11.37it/s, est. speed input: 5196.74 toks/s, output: 984.05 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 13.24it/s, est. speed input: 5196.74 toks/s, output: 984.05 toks/s]
Processing batched inference:  23%|██▎       | 30/132 [02:30<06:45,  3.98s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 44.38it/s, est. speed input: 17481.26 toks/s, output: 2566.67 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 35.32it/s, est. speed input: 14362.20 toks/s, output: 2534.80 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 21.09it/s, est. speed input: 9598.95 toks/s, output: 1764.33 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.18it/s, est. speed input: 9891.94 toks/s, output: 1869.76 toks/s]
Processing batched inference:  23%|██▎       | 31/132 [02:32<05:47,  3.44s/it]Resource status after batch 30:
Open files: 0
Memory usage: 5531.68 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 57.87it/s, est. speed input: 22720.00 toks/s, output: 3273.73 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 36.73it/s, est. speed input: 15342.76 toks/s, output: 2227.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.78it/s, est. speed input: 13670.39 toks/s, output: 2086.98 toks/s]
Processing batched inference:  24%|██▍       | 32/132 [02:35<05:17,  3.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.68it/s, est. speed input: 1055.45 toks/s, output: 155.36 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:01,  9.74it/s, est. speed input: 3199.10 toks/s, output: 461.64 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 24.41it/s, est. speed input: 7528.48 toks/s, output: 1147.40 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.89it/s, est. speed input: 7816.58 toks/s, output: 1249.69 toks/s]
Processing batched inference:  25%|██▌       | 33/132 [02:37<04:39,  2.82s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 43.09it/s, est. speed input: 16919.43 toks/s, output: 2637.23 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:11<00:00, 43.09it/s, est. speed input: 14617.92 toks/s, output: 2471.65 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:22<00:01,  1.91s/it, est. speed input: 256.13 toks/s, output: 218.63 toks/s]   [A
Processed prompts: 100%|██████████| 16/16 [00:23<00:00,  1.73s/it, est. speed input: 270.24 toks/s, output: 392.49 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:23<00:00,  1.45s/it, est. speed input: 270.24 toks/s, output: 392.49 toks/s]
Processing batched inference:  26%|██▌       | 34/132 [03:02<15:29,  9.48s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 37.63it/s, est. speed input: 14789.57 toks/s, output: 2144.89 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 35.66it/s, est. speed input: 14131.77 toks/s, output: 2203.70 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 35.50it/s, est. speed input: 14039.51 toks/s, output: 2458.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.93it/s, est. speed input: 8998.04 toks/s, output: 1692.35 toks/s] 
Processing batched inference:  27%|██▋       | 35/132 [03:04<11:53,  7.35s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 37.40it/s, est. speed input: 14708.40 toks/s, output: 2476.13 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 31.38it/s, est. speed input: 12659.96 toks/s, output: 2318.25 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 34.36it/s, est. speed input: 13393.45 toks/s, output: 2669.16 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.65it/s, est. speed input: 6932.66 toks/s, output: 1420.93 toks/s] 
Processing batched inference:  27%|██▋       | 36/132 [03:07<09:34,  5.98s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 49.80it/s, est. speed input: 19563.54 toks/s, output: 3173.43 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 31.37it/s, est. speed input: 13172.19 toks/s, output: 2295.00 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 35.43it/s, est. speed input: 13902.10 toks/s, output: 2409.23 toks/s]
Processing batched inference:  28%|██▊       | 37/132 [03:09<07:41,  4.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 67.29it/s, est. speed input: 26482.07 toks/s, output: 3860.73 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 35.72it/s, est. speed input: 15184.26 toks/s, output: 2332.40 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.04it/s, est. speed input: 15746.74 toks/s, output: 2410.37 toks/s]
Processing batched inference:  29%|██▉       | 38/132 [03:11<06:18,  4.03s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 56.39it/s, est. speed input: 22137.73 toks/s, output: 3186.24 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 35.28it/s, est. speed input: 14816.98 toks/s, output: 2410.18 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.38it/s, est. speed input: 8799.65 toks/s, output: 1551.44 toks/s] 
Processing batched inference:  30%|██▉       | 39/132 [03:13<05:26,  3.51s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 17.52it/s, est. speed input: 6886.03 toks/s, output: 989.87 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 22.30it/s, est. speed input: 8560.19 toks/s, output: 1235.73 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 22.35it/s, est. speed input: 8655.21 toks/s, output: 1333.20 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 20.86it/s, est. speed input: 8306.56 toks/s, output: 1472.72 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 13.07it/s, est. speed input: 5136.19 toks/s, output: 1049.29 toks/s]
Processing batched inference:  30%|███       | 40/132 [03:16<04:55,  3.22s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:06,  2.29it/s, est. speed input: 898.51 toks/s, output: 130.31 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:02,  6.46it/s, est. speed input: 2143.43 toks/s, output: 307.74 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 22.30it/s, est. speed input: 6462.99 toks/s, output: 988.93 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.89it/s, est. speed input: 7419.52 toks/s, output: 1294.24 toks/s]
Processing batched inference:  31%|███       | 41/132 [03:18<04:11,  2.77s/it]Resource status after batch 40:
Open files: 0
Memory usage: 6706.81 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 48.97it/s, est. speed input: 19254.87 toks/s, output: 3097.54 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 31.38it/s, est. speed input: 13192.11 toks/s, output: 2024.46 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.04it/s, est. speed input: 10223.89 toks/s, output: 1859.15 toks/s]
Processing batched inference:  32%|███▏      | 42/132 [03:20<04:05,  2.73s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 41.27it/s, est. speed input: 16223.31 toks/s, output: 2352.51 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 39.25it/s, est. speed input: 15509.56 toks/s, output: 2863.52 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 21.15it/s, est. speed input: 9684.72 toks/s, output: 2008.01 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.29it/s, est. speed input: 9531.00 toks/s, output: 2009.08 toks/s]
Processing batched inference:  33%|███▎      | 43/132 [03:23<03:59,  2.69s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 22.56it/s, est. speed input: 8866.51 toks/s, output: 1285.89 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 24.40it/s, est. speed input: 9441.96 toks/s, output: 1514.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 23.33it/s, est. speed input: 9188.52 toks/s, output: 1629.55 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 28.08it/s, est. speed input: 10267.97 toks/s, output: 2165.03 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.69it/s, est. speed input: 8919.70 toks/s, output: 1914.67 toks/s] 
Processing batched inference:  33%|███▎      | 44/132 [03:25<03:43,  2.54s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 24.54it/s, est. speed input: 9613.66 toks/s, output: 1368.02 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 39.46it/s, est. speed input: 14450.22 toks/s, output: 2092.48 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 22.83it/s, est. speed input: 9746.00 toks/s, output: 1726.82 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.12it/s, est. speed input: 9081.93 toks/s, output: 1660.29 toks/s]
Processing batched inference:  34%|███▍      | 45/132 [03:27<03:27,  2.38s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 33.13it/s, est. speed input: 12988.59 toks/s, output: 1855.33 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 29.97it/s, est. speed input: 11930.39 toks/s, output: 1710.23 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 31.49it/s, est. speed input: 12307.63 toks/s, output: 1868.54 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.87it/s, est. speed input: 7007.16 toks/s, output: 1266.50 toks/s] 
Processing batched inference:  35%|███▍      | 46/132 [03:29<03:24,  2.38s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.87it/s, est. speed input: 2288.71 toks/s, output: 316.86 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:02,  6.90it/s, est. speed input: 2629.17 toks/s, output: 369.80 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 12.40it/s, est. speed input: 4240.14 toks/s, output: 609.11 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 26.74it/s, est. speed input: 8294.59 toks/s, output: 1257.74 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.07it/s, est. speed input: 8274.79 toks/s, output: 1316.99 toks/s]
Processing batched inference:  36%|███▌      | 47/132 [03:31<03:08,  2.21s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 41.17it/s, est. speed input: 16175.78 toks/s, output: 2338.57 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 33.00it/s, est. speed input: 13343.55 toks/s, output: 2391.08 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 23.46it/s, est. speed input: 10215.13 toks/s, output: 1995.37 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:05<00:00,  3.07it/s, est. speed input: 1203.06 toks/s, output: 419.55 toks/s]  
Processing batched inference:  36%|███▋      | 48/132 [03:38<05:06,  3.65s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 22.40it/s, est. speed input: 8787.78 toks/s, output: 1261.65 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 21.42it/s, est. speed input: 8451.93 toks/s, output: 1207.37 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 27.77it/s, est. speed input: 10263.13 toks/s, output: 1468.16 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 30.76it/s, est. speed input: 11118.09 toks/s, output: 1863.05 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.19it/s, est. speed input: 11062.50 toks/s, output: 1924.17 toks/s]
Processing batched inference:  37%|███▋      | 49/132 [03:40<04:16,  3.09s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 39.77it/s, est. speed input: 15636.02 toks/s, output: 2267.29 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 44.81it/s, est. speed input: 17309.66 toks/s, output: 2502.05 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 14.88it/s, est. speed input: 7003.95 toks/s, output: 1137.34 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:18<00:00, 14.88it/s, est. speed input: 7003.95 toks/s, output: 1137.34 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:23<00:02,  2.74s/it, est. speed input: 254.75 toks/s, output: 215.71 toks/s]  [A
Processed prompts: 100%|██████████| 16/16 [00:23<00:00,  2.38s/it, est. speed input: 268.95 toks/s, output: 388.77 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:23<00:00,  1.46s/it, est. speed input: 268.95 toks/s, output: 388.77 toks/s]
Processing batched inference:  38%|███▊      | 50/132 [04:05<13:09,  9.63s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.53it/s, est. speed input: 2552.91 toks/s, output: 359.07 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 32.22it/s, est. speed input: 11329.34 toks/s, output: 1645.57 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 33.55it/s, est. speed input: 12022.13 toks/s, output: 2065.88 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.57it/s, est. speed input: 6517.66 toks/s, output: 1250.24 toks/s] 
Processing batched inference:  39%|███▊      | 51/132 [04:07<10:00,  7.41s/it]Resource status after batch 50:
Open files: 0
Memory usage: 7684.25 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 42.52it/s, est. speed input: 16678.07 toks/s, output: 2707.41 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 42.75it/s, est. speed input: 16763.61 toks/s, output: 2586.07 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.20it/s, est. speed input: 8547.10 toks/s, output: 1498.37 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.75it/s, est. speed input: 8547.10 toks/s, output: 1498.37 toks/s]
Processing batched inference:  39%|███▉      | 52/132 [04:09<07:50,  5.89s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  7.36it/s, est. speed input: 2901.82 toks/s, output: 427.11 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  9.74it/s, est. speed input: 3703.65 toks/s, output: 534.46 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 25.15it/s, est. speed input: 8072.96 toks/s, output: 1163.01 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 20.94it/s, est. speed input: 7584.90 toks/s, output: 1159.32 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.81it/s, est. speed input: 6999.81 toks/s, output: 1272.67 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.83it/s, est. speed input: 6999.81 toks/s, output: 1272.67 toks/s]
Processing batched inference:  40%|████      | 53/132 [04:12<06:17,  4.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 20.98it/s, est. speed input: 8230.97 toks/s, output: 1181.74 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 23.17it/s, est. speed input: 8960.96 toks/s, output: 1296.31 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 22.73it/s, est. speed input: 8890.62 toks/s, output: 1291.59 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 20.84it/s, est. speed input: 8359.34 toks/s, output: 1329.06 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.76it/s, est. speed input: 6185.57 toks/s, output: 1075.37 toks/s]
Processing batched inference:  41%|████      | 54/132 [04:14<05:12,  4.00s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 20.47it/s, est. speed input: 8036.82 toks/s, output: 1159.72 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 14.68it/s, est. speed input: 6020.98 toks/s, output: 868.79 toks/s] [A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 23.16it/s, est. speed input: 8448.92 toks/s, output: 1305.02 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.98it/s, est. speed input: 8518.56 toks/s, output: 1485.94 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.68it/s, est. speed input: 8518.56 toks/s, output: 1485.94 toks/s]
Processing batched inference:  42%|████▏     | 55/132 [04:16<04:22,  3.41s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  7.87it/s, est. speed input: 3101.61 toks/s, output: 456.53 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 16.11it/s, est. speed input: 5863.74 toks/s, output: 1012.06 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 34.84it/s, est. speed input: 11296.09 toks/s, output: 1744.85 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 25.55it/s, est. speed input: 9674.16 toks/s, output: 1788.31 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.82it/s, est. speed input: 10142.29 toks/s, output: 1929.95 toks/s]
Processing batched inference:  42%|████▏     | 56/132 [04:18<03:48,  3.00s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:07,  2.03it/s, est. speed input: 792.54 toks/s, output: 111.47 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 16.02it/s, est. speed input: 5292.73 toks/s, output: 818.77 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:01<00:00, 15.84it/s, est. speed input: 5488.83 toks/s, output: 1062.73 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:02<00:00,  6.03it/s, est. speed input: 2369.79 toks/s, output: 596.40 toks/s] 
Processing batched inference:  43%|████▎     | 57/132 [04:21<03:55,  3.14s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 32.30it/s, est. speed input: 12691.37 toks/s, output: 1834.95 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 27.58it/s, est. speed input: 11106.83 toks/s, output: 1762.08 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 20.51it/s, est. speed input: 8816.47 toks/s, output: 1516.56 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 10.11it/s, est. speed input: 5234.45 toks/s, output: 1120.81 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 13.32it/s, est. speed input: 5234.45 toks/s, output: 1120.81 toks/s]
Processing batched inference:  44%|████▍     | 58/132 [04:24<03:45,  3.05s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.70it/s, est. speed input: 1839.22 toks/s, output: 258.68 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 21.89it/s, est. speed input: 7435.33 toks/s, output: 1076.03 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 33.37it/s, est. speed input: 10723.23 toks/s, output: 1640.75 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.41it/s, est. speed input: 9185.02 toks/s, output: 1586.17 toks/s] 
Processing batched inference:  45%|████▍     | 59/132 [04:26<03:15,  2.67s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.38it/s, est. speed input: 1323.64 toks/s, output: 186.18 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 26.08it/s, est. speed input: 8387.85 toks/s, output: 1224.58 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 26.72it/s, est. speed input: 9120.71 toks/s, output: 1403.02 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 13.53it/s, est. speed input: 5315.18 toks/s, output: 962.92 toks/s] 
Processing batched inference:  45%|████▌     | 60/132 [04:28<03:00,  2.51s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.35it/s, est. speed input: 1320.25 toks/s, output: 194.33 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 16.37it/s, est. speed input: 5386.14 toks/s, output: 778.89 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 20.82it/s, est. speed input: 6902.05 toks/s, output: 1065.89 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 21.92it/s, est. speed input: 7346.56 toks/s, output: 1295.09 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.31it/s, est. speed input: 6397.72 toks/s, output: 1241.59 toks/s]
Processing batched inference:  46%|████▌     | 61/132 [04:30<02:46,  2.34s/it]Resource status after batch 60:
Open files: 0
Memory usage: 8365.03 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 21.75it/s, est. speed input: 8525.27 toks/s, output: 1217.79 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 23.02it/s, est. speed input: 8965.64 toks/s, output: 1289.15 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 34.46it/s, est. speed input: 12261.95 toks/s, output: 1861.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.63it/s, est. speed input: 8882.16 toks/s, output: 1410.07 toks/s] 
Processing batched inference:  47%|████▋     | 62/132 [04:32<02:35,  2.22s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 40.00it/s, est. speed input: 15680.18 toks/s, output: 2239.86 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 36.21it/s, est. speed input: 14457.74 toks/s, output: 2219.55 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.23it/s, est. speed input: 15771.97 toks/s, output: 2489.45 toks/s]
Processing batched inference:  48%|████▊     | 63/132 [04:34<02:27,  2.14s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.40it/s, est. speed input: 1331.54 toks/s, output: 190.20 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 36.10it/s, est. speed input: 11419.19 toks/s, output: 1639.23 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.60it/s, est. speed input: 7305.23 toks/s, output: 1281.07 toks/s] 
Processing batched inference:  48%|████▊     | 64/132 [04:36<02:19,  2.05s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 36.20it/s, est. speed input: 14227.47 toks/s, output: 2063.37 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 40.26it/s, est. speed input: 15523.32 toks/s, output: 2400.73 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.90it/s, est. speed input: 9073.54 toks/s, output: 1594.23 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.07it/s, est. speed input: 9073.54 toks/s, output: 1594.23 toks/s]
Processing batched inference:  49%|████▉     | 65/132 [04:38<02:21,  2.11s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.93it/s, est. speed input: 1939.18 toks/s, output: 281.22 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 30.31it/s, est. speed input: 9979.19 toks/s, output: 1435.52 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 22.74it/s, est. speed input: 8575.96 toks/s, output: 1329.00 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 22.86it/s, est. speed input: 8673.58 toks/s, output: 1538.74 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.17it/s, est. speed input: 9107.90 toks/s, output: 1669.51 toks/s]
Processing batched inference:  50%|█████     | 66/132 [04:40<02:16,  2.06s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 78.07it/s, est. speed input: 30752.33 toks/s, output: 4512.91 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.36it/s, est. speed input: 6833.26 toks/s, output: 1212.11 toks/s] 
Processing batched inference:  51%|█████     | 67/132 [04:43<02:24,  2.23s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 56.10it/s, est. speed input: 22045.60 toks/s, output: 3188.71 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 25.80it/s, est. speed input: 11024.99 toks/s, output: 1700.97 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.32it/s, est. speed input: 9326.96 toks/s, output: 1614.86 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.76it/s, est. speed input: 9326.96 toks/s, output: 1614.86 toks/s]
Processing batched inference:  52%|█████▏    | 68/132 [04:45<02:21,  2.20s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.05it/s, est. speed input: 1968.03 toks/s, output: 272.47 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  9.94it/s, est. speed input: 3552.06 toks/s, output: 507.41 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 40.84it/s, est. speed input: 11805.29 toks/s, output: 1696.34 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 11.97it/s, est. speed input: 4692.31 toks/s, output: 875.31 toks/s]  
Processing batched inference:  52%|█████▏    | 69/132 [04:47<02:23,  2.28s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.38it/s, est. speed input: 1330.18 toks/s, output: 192.92 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 16.49it/s, est. speed input: 5425.21 toks/s, output: 782.90 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 35.80it/s, est. speed input: 10614.86 toks/s, output: 1703.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.80it/s, est. speed input: 7776.89 toks/s, output: 1352.64 toks/s] 
Processing batched inference:  53%|█████▎    | 70/132 [04:49<02:14,  2.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.63it/s, est. speed input: 1027.17 toks/s, output: 142.22 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 24.40it/s, est. speed input: 8047.03 toks/s, output: 1229.71 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.15it/s, est. speed input: 9091.80 toks/s, output: 1581.85 toks/s]
Processing batched inference:  54%|█████▍    | 71/132 [04:51<02:02,  2.00s/it]Resource status after batch 70:
Open files: 0
Memory usage: 8861.23 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01,  9.95it/s, est. speed input: 3907.05 toks/s, output: 562.36 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:01, 11.42it/s, est. speed input: 4386.34 toks/s, output: 631.39 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 30.33it/s, est. speed input: 9404.46 toks/s, output: 1455.86 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 32.30it/s, est. speed input: 10334.76 toks/s, output: 1655.98 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.43it/s, est. speed input: 8411.59 toks/s, output: 1406.54 toks/s] 
Processing batched inference:  55%|█████▍    | 72/132 [04:53<02:01,  2.02s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:09,  1.65it/s, est. speed input: 645.81 toks/s, output: 89.19 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 16.97it/s, est. speed input: 5406.14 toks/s, output: 825.60 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:01<00:00, 13.75it/s, est. speed input: 4897.20 toks/s, output: 902.39 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 11.40it/s, est. speed input: 4475.75 toks/s, output: 910.96 toks/s]
Processing batched inference:  55%|█████▌    | 73/132 [04:55<01:58,  2.01s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.00it/s, est. speed input: 1564.82 toks/s, output: 220.10 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 30.48it/s, est. speed input: 9783.44 toks/s, output: 1392.83 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.96it/s, est. speed input: 9163.52 toks/s, output: 1388.08 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.35it/s, est. speed input: 9163.52 toks/s, output: 1388.08 toks/s]
Processing batched inference:  56%|█████▌    | 74/132 [04:57<01:52,  1.94s/it]ERROR 06-30 23:25:29 [core.py:387] EngineCore hit an exception: Traceback (most recent call last):
ERROR 06-30 23:25:29 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 68, in __getitem__
ERROR 06-30 23:25:29 [core.py:387]     return self.__data[key]
ERROR 06-30 23:25:29 [core.py:387]            ~~~~~~~~~~~^^^^^
ERROR 06-30 23:25:29 [core.py:387] KeyError: 'c3480b9949c7b358c7d175ffe264b284165eca5ce3fae45f07a0d86ce1b27ae0'
ERROR 06-30 23:25:29 [core.py:387] 
ERROR 06-30 23:25:29 [core.py:387] During handling of the above exception, another exception occurred:
ERROR 06-30 23:25:29 [core.py:387] 
ERROR 06-30 23:25:29 [core.py:387] Traceback (most recent call last):
ERROR 06-30 23:25:29 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 380, in run_engine_core
ERROR 06-30 23:25:29 [core.py:387]     engine_core.run_busy_loop()
ERROR 06-30 23:25:29 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 400, in run_busy_loop
ERROR 06-30 23:25:29 [core.py:387]     self._process_input_queue()
ERROR 06-30 23:25:29 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 425, in _process_input_queue
ERROR 06-30 23:25:29 [core.py:387]     self._handle_client_request(*req)
ERROR 06-30 23:25:29 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 441, in _handle_client_request
ERROR 06-30 23:25:29 [core.py:387]     self.add_request(request)
ERROR 06-30 23:25:29 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 177, in add_request
ERROR 06-30 23:25:29 [core.py:387]     request.mm_inputs = self.mm_input_cache_server.get_and_update_p1(
ERROR 06-30 23:25:29 [core.py:387]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:25:29 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/mm_input_cache.py", line 76, in get_and_update_p1
ERROR 06-30 23:25:29 [core.py:387]     mm_input = self.mm_cache[mm_hash]
ERROR 06-30 23:25:29 [core.py:387]                ~~~~~~~~~~~~~^^^^^^^^^
ERROR 06-30 23:25:29 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 211, in __getitem__
ERROR 06-30 23:25:29 [core.py:387]     value = cache_getitem(self, key)
ERROR 06-30 23:25:29 [core.py:387]             ^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:25:29 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 70, in __getitem__
ERROR 06-30 23:25:29 [core.py:387]     return self.__missing__(key)
ERROR 06-30 23:25:29 [core.py:387]            ^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:25:29 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 97, in __missing__
ERROR 06-30 23:25:29 [core.py:387]     raise KeyError(key)
ERROR 06-30 23:25:29 [core.py:387] KeyError: 'c3480b9949c7b358c7d175ffe264b284165eca5ce3fae45f07a0d86ce1b27ae0'
ERROR 06-30 23:25:29 [core.py:387] 
CRITICAL 06-30 23:25:29 [core_client.py:359] Got fatal signal from worker processes, shutting down. See stack trace above for root cause issue.
batch_inference.sh: line 23: 489184 Killed                  python scripts/vllm_infer_new.py --model_name_or_path "$ckpt" --dataset $EVAL_DATASET --template qwen2_vl --save_name "$save_path/generated_predictions.jsonl" --max_new_tokens 4096 --temperature 0.0 --top_p 1.0 --top_k -1 --repetition_penalty 1.0 --batch_size 16 --seed 42
Running inference on checkpoint: checkpoint-567
INFO 06-30 23:25:39 [__init__.py:239] Automatically detected platform cuda.
[INFO|training_args.py:2135] 2025-06-30 23:25:41,555 >> PyTorch: setting up devices
[INFO|training_args.py:1812] 2025-06-30 23:25:41,600 >> The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:41,617 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:41,617 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:41,617 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:41,617 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:41,617 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:41,617 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:41,617 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:25:42,012 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:378] 2025-06-30 23:25:42,013 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567/preprocessor_config.json
[INFO|image_processing_base.py:378] 2025-06-30 23:25:42,018 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:25:42,024 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:42,025 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:42,025 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:42,025 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:42,025 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:42,025 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:42,025 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:42,025 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:25:42,415 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:25:42,417 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:25:42,632 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:25:43,091 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}

[INFO|configuration_utils.py:696] 2025-06-30 23:25:43,146 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567/config.json
[INFO|configuration_utils.py:696] 2025-06-30 23:25:43,146 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567/config.json
[INFO|configuration_utils.py:770] 2025-06-30 23:25:43,148 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "text_config": {
    "architectures": [
      "Qwen2VLForConditionalGeneration"
    ],
    "attention_dropout": 0.0,
    "bos_token_id": 151643,
    "eos_token_id": 151645,
    "hidden_act": "silu",
    "hidden_size": 1536,
    "image_token_id": null,
    "initializer_range": 0.02,
    "intermediate_size": 8960,
    "max_position_embeddings": 32768,
    "max_window_layers": 28,
    "model_type": "qwen2_vl_text",
    "num_attention_heads": 12,
    "num_hidden_layers": 28,
    "num_key_value_heads": 2,
    "rms_norm_eps": 1e-06,
    "rope_scaling": {
      "mrope_section": [
        16,
        24,
        24
      ],
      "rope_type": "default",
      "type": "default"
    },
    "rope_theta": 1000000.0,
    "sliding_window": 32768,
    "tie_word_embeddings": true,
    "torch_dtype": "float32",
    "use_cache": false,
    "use_sliding_window": false,
    "video_token_id": null,
    "vision_end_token_id": 151653,
    "vision_start_token_id": 151652,
    "vision_token_id": 151654,
    "vocab_size": 151936
  },
  "torch_dtype": "bfloat16",
  "transformers_version": "4.52.4",
  "use_cache": false,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "depth": 32,
    "embed_dim": 1280,
    "hidden_act": "quick_gelu",
    "hidden_size": 1536,
    "in_channels": 3,
    "in_chans": 3,
    "initializer_range": 0.02,
    "mlp_ratio": 4,
    "model_type": "qwen2_vl",
    "num_heads": 16,
    "patch_size": 14,
    "spatial_merge_size": 2,
    "spatial_patch_size": 14,
    "temporal_patch_size": 2,
    "torch_dtype": "float32"
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 151936
}

INFO 06-30 23:25:54 [config.py:689] This model supports multiple tasks: {'reward', 'embed', 'generate', 'score', 'classify'}. Defaulting to 'generate'.
INFO 06-30 23:25:54 [config.py:1901] Chunked prefill is enabled with max_num_batched_tokens=8192.
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:55,805 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:55,805 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:55,805 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:55,805 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:55,805 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:55,805 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:25:55,805 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:25:56,179 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:1088] 2025-06-30 23:25:56,277 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567/generation_config.json
[INFO|configuration_utils.py:1135] 2025-06-30 23:25:56,277 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

WARNING 06-30 23:25:56 [utils.py:2304] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/getting_started/troubleshooting.html#python-multiprocessing for more information. Reason: CUDA is initialized
INFO 06-30 23:26:03 [__init__.py:239] Automatically detected platform cuda.
INFO 06-30 23:26:06 [core.py:61] Initializing a V1 LLM engine (v0.8.4) with config: model='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567', speculative_config=None, tokenizer='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-30 23:26:07 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f6680112690>
INFO 06-30 23:26:08 [parallel_state.py:959] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-30 23:26:08 [cuda.py:221] Using Flash Attention backend on V1 engine.
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:26:11 [gpu_model_runner.py:1276] Starting to load model saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567...
WARNING 06-30 23:26:11 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-30 23:26:11 [config.py:3466] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
WARNING 06-30 23:26:11 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.30s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.30s/it]

INFO 06-30 23:26:18 [loader.py:458] Loading weights took 7.51 seconds
INFO 06-30 23:26:19 [gpu_model_runner.py:1291] Model loading took 4.1513 GiB and 7.707501 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:26:20 [gpu_model_runner.py:1560] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-30 23:26:34 [backends.py:416] Using cache directory: /root/.cache/vllm/torch_compile_cache/854303e6e8/rank_0_0 for vLLM's torch.compile
INFO 06-30 23:26:34 [backends.py:426] Dynamo bytecode transform time: 7.63 s
INFO 06-30 23:26:35 [backends.py:115] Directly load the compiled graph for shape None from the cache
INFO 06-30 23:26:42 [monitor.py:33] torch.compile takes 7.63 s in total
INFO 06-30 23:26:42 [kv_cache_utils.py:634] GPU KV cache size: 1,006,016 tokens
INFO 06-30 23:26:42 [kv_cache_utils.py:637] Maximum concurrency for 6,144 tokens per request: 163.74x
INFO 06-30 23:27:03 [gpu_model_runner.py:1626] Graph capturing finished in 20 secs, took 0.47 GiB
INFO 06-30 23:27:03 [core.py:163] init engine (profile, create kv cache, warmup model) took 43.97 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:27:04 [core_client.py:435] Core engine process 0 ready.
[INFO|2025-06-30 23:27:04] llamafactory.data.loader:143 >> Loading dataset ./0_my_dataset/vindr/qwen2_vindr_input_test_len_2108.json...
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151653, 198, 5598, 30618, 14697, 315, 364, 47, 811, 372, 8767, 269, 706, 6, 5671, 438, 4718, 3561, 510, 73594, 2236, 198, 9640, 4913, 58456, 62, 17, 67, 788, 508, 87, 16, 11, 379, 16, 11, 856, 17, 11, 379, 17, 1125, 330, 1502, 788, 330, 1502, 7115, 9338, 921, 73594, 151645, 198, 151644, 77091, 198]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|vision_end|>
Return bounding boxes of 'Pneumothorax' areas as JSON format:
```json
[
{"bbox_2d": [x1, y1, x2, y2], "label": "label"},
...
]
```<|im_end|>
<|im_start|>assistant

label_ids:
[27, 9217, 397, 9640, 220, 341, 262, 330, 58456, 62, 17, 67, 788, 2278, 414, 220, 16, 22, 20, 345, 414, 220, 17, 22, 24, 345, 414, 220, 18, 15, 17, 345, 414, 220, 21, 23, 16, 198, 262, 3211, 262, 330, 1502, 788, 330, 47, 811, 372, 8767, 269, 706, 698, 220, 456, 921, 522, 9217, 29, 151645, 198]
labels:
<answer>
[
  {
    "bbox_2d": [
      175,
      279,
      302,
      681
    ],
    "label": "Pneumothorax"
  }
]
</answer><|im_end|>

Current file descriptor limits: soft=8192, hard=8192
Initial resource status:
Open files: 0
Memory usage: 936.94 MB
Using effective batch size: 16
Processing batched inference:   0%|          | 0/132 [00:00<?, ?it/s][INFO|image_processing_base.py:378] 2025-06-30 23:27:05,660 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:27:05,660 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|image_processing_base.py:378] 2025-06-30 23:27:05,662 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:27:05,662 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:27:05,663 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:27:05,663 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:27:05,663 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:27:05,663 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:27:05,663 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:27:05,663 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:27:05,663 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:27:06,477 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:27:06,477 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:27:06,478 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:27:06,976 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: CachedQwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-567', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='left', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}


Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 85.63it/s, est. speed input: 33664.93 toks/s, output: 5651.83 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.14it/s, est. speed input: 16967.82 toks/s, output: 3128.52 toks/s]
Processing batched inference:   1%|          | 1/132 [00:04<09:41,  4.44s/it]Resource status after batch 0:
Open files: 0
Memory usage: 1087.09 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 89.57it/s, est. speed input: 35151.47 toks/s, output: 5389.08 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.74it/s, est. speed input: 9716.17 toks/s, output: 1699.19 toks/s] 
Processing batched inference:   2%|▏         | 2/132 [00:07<07:38,  3.53s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 77.91it/s, est. speed input: 30573.14 toks/s, output: 4389.33 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.16it/s, est. speed input: 15378.55 toks/s, output: 2457.36 toks/s]
Processing batched inference:   2%|▏         | 3/132 [00:09<06:36,  3.07s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 52.10it/s, est. speed input: 20467.39 toks/s, output: 3777.02 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 35.77it/s, est. speed input: 14744.55 toks/s, output: 2570.98 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s, est. speed input: 8604.04 toks/s, output: 1697.75 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.90it/s, est. speed input: 8604.04 toks/s, output: 1697.75 toks/s]
Processing batched inference:   3%|▎         | 4/132 [00:12<06:02,  2.83s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 59.77it/s, est. speed input: 23502.89 toks/s, output: 3998.55 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.87it/s, est. speed input: 11366.57 toks/s, output: 2243.22 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.90it/s, est. speed input: 11366.57 toks/s, output: 2243.22 toks/s]
Processing batched inference:   4%|▍         | 5/132 [00:14<05:43,  2.70s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 77.45it/s, est. speed input: 30456.02 toks/s, output: 5802.03 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.61it/s, est. speed input: 10856.72 toks/s, output: 2167.45 toks/s]
Processing batched inference:   5%|▍         | 6/132 [00:17<05:36,  2.67s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 22.50it/s, est. speed input: 8818.96 toks/s, output: 1512.85 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 20.80it/s, est. speed input: 8271.11 toks/s, output: 1324.77 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 27.17it/s, est. speed input: 9944.32 toks/s, output: 1625.83 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 29.46it/s, est. speed input: 10626.59 toks/s, output: 1843.66 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.21it/s, est. speed input: 9093.27 toks/s, output: 1623.09 toks/s] 
Processing batched inference:   5%|▌         | 7/132 [00:19<05:25,  2.60s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 94.65it/s, est. speed input: 37189.07 toks/s, output: 5730.06 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.76it/s, est. speed input: 17199.38 toks/s, output: 2623.37 toks/s]
Processing batched inference:   6%|▌         | 8/132 [00:22<05:14,  2.53s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 67.35it/s, est. speed input: 26438.82 toks/s, output: 4168.59 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00,  9.82it/s, est. speed input: 4503.29 toks/s, output: 1030.99 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 11.47it/s, est. speed input: 4503.29 toks/s, output: 1030.99 toks/s]
Processing batched inference:   7%|▋         | 9/132 [00:25<05:53,  2.87s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 49.66it/s, est. speed input: 19501.96 toks/s, output: 3393.52 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.45it/s, est. speed input: 9210.46 toks/s, output: 1744.12 toks/s] 
Processing batched inference:   8%|▊         | 10/132 [00:28<05:53,  2.90s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 81.27it/s, est. speed input: 31854.91 toks/s, output: 4883.84 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.09it/s, est. speed input: 13364.28 toks/s, output: 2516.39 toks/s]
Processing batched inference:   8%|▊         | 11/132 [00:31<05:43,  2.84s/it]Resource status after batch 10:
Open files: 0
Memory usage: 2457.32 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 27.31it/s, est. speed input: 10744.15 toks/s, output: 1561.45 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 19.66it/s, est. speed input: 8181.21 toks/s, output: 1180.28 toks/s] [A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 21.56it/s, est. speed input: 8563.92 toks/s, output: 1299.61 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.20it/s, est. speed input: 8716.59 toks/s, output: 1380.57 toks/s]
Processing batched inference:   9%|▉         | 12/132 [00:33<05:17,  2.65s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 77.59it/s, est. speed input: 30474.52 toks/s, output: 4997.91 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.42it/s, est. speed input: 12344.18 toks/s, output: 2156.80 toks/s]
Processing batched inference:  10%|▉         | 13/132 [00:36<05:12,  2.63s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 104.62it/s, est. speed input: 41015.44 toks/s, output: 7161.72 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.09it/s, est. speed input: 16519.80 toks/s, output: 2993.94 toks/s] 
Processing batched inference:  11%|█         | 14/132 [00:38<05:09,  2.62s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 63.89it/s, est. speed input: 25083.52 toks/s, output: 4115.50 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.30it/s, est. speed input: 16620.80 toks/s, output: 2779.16 toks/s]
Processing batched inference:  11%|█▏        | 15/132 [00:41<04:50,  2.48s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 68.27it/s, est. speed input: 26855.20 toks/s, output: 4627.11 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.25it/s, est. speed input: 11095.64 toks/s, output: 2178.82 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.23it/s, est. speed input: 11095.64 toks/s, output: 2178.82 toks/s]
Processing batched inference:  12%|█▏        | 16/132 [00:43<04:52,  2.52s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 74.45it/s, est. speed input: 29207.58 toks/s, output: 5053.57 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.34it/s, est. speed input: 16996.22 toks/s, output: 2812.77 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.30it/s, est. speed input: 16996.22 toks/s, output: 2812.77 toks/s]
Processing batched inference:  13%|█▎        | 17/132 [00:45<04:41,  2.44s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 24.59it/s, est. speed input: 9653.39 toks/s, output: 1632.57 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 24.30it/s, est. speed input: 9570.94 toks/s, output: 1835.58 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 25.22it/s, est. speed input: 9805.42 toks/s, output: 1958.76 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 17.66it/s, est. speed input: 7846.50 toks/s, output: 1736.65 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.42it/s, est. speed input: 7412.69 toks/s, output: 1733.58 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.88it/s, est. speed input: 7412.69 toks/s, output: 1733.58 toks/s]
Processing batched inference:  14%|█▎        | 18/132 [00:48<04:36,  2.42s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 66.18it/s, est. speed input: 26001.53 toks/s, output: 4031.20 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 11.07it/s, est. speed input: 4348.53 toks/s, output: 922.42 toks/s]  
Processing batched inference:  14%|█▍        | 19/132 [00:51<05:11,  2.76s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 37.93it/s, est. speed input: 14920.61 toks/s, output: 2152.76 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 34.38it/s, est. speed input: 13683.75 toks/s, output: 2170.81 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 38.08it/s, est. speed input: 14727.80 toks/s, output: 2471.23 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.03it/s, est. speed input: 9435.00 toks/s, output: 1641.82 toks/s] 
Processing batched inference:  15%|█▌        | 20/132 [00:54<04:51,  2.60s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 76.22it/s, est. speed input: 29888.48 toks/s, output: 5708.82 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.05it/s, est. speed input: 10994.57 toks/s, output: 2307.58 toks/s]
Processing batched inference:  16%|█▌        | 21/132 [00:56<04:52,  2.64s/it]Resource status after batch 20:
Open files: 0
Memory usage: 3632.40 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 78.18it/s, est. speed input: 30707.71 toks/s, output: 4783.48 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.16it/s, est. speed input: 16951.04 toks/s, output: 2832.71 toks/s]
Processing batched inference:  17%|█▋        | 22/132 [00:59<04:42,  2.57s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 18.69it/s, est. speed input: 7326.77 toks/s, output: 1046.59 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 32.96it/s, est. speed input: 12017.49 toks/s, output: 1728.37 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 32.35it/s, est. speed input: 12129.28 toks/s, output: 1855.88 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 12.30it/s, est. speed input: 4832.86 toks/s, output: 994.24 toks/s]  
Processing batched inference:  17%|█▋        | 23/132 [01:01<04:44,  2.61s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 71.23it/s, est. speed input: 28018.61 toks/s, output: 4505.60 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.52it/s, est. speed input: 10273.02 toks/s, output: 1795.74 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.14it/s, est. speed input: 10273.02 toks/s, output: 1795.74 toks/s]
Processing batched inference:  18%|█▊        | 24/132 [01:04<04:38,  2.58s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 15.41it/s, est. speed input: 6058.03 toks/s, output: 878.50 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 16.56it/s, est. speed input: 6465.88 toks/s, output: 942.45 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 29.56it/s, est. speed input: 10088.98 toks/s, output: 1466.90 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.43it/s, est. speed input: 8475.72 toks/s, output: 1490.30 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.56it/s, est. speed input: 8475.72 toks/s, output: 1490.30 toks/s]
Processing batched inference:  19%|█▉        | 25/132 [01:06<04:19,  2.43s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 69.32it/s, est. speed input: 27205.35 toks/s, output: 3909.94 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.48it/s, est. speed input: 16682.28 toks/s, output: 2647.51 toks/s]
Processing batched inference:  20%|█▉        | 26/132 [01:08<04:08,  2.35s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 16.26it/s, est. speed input: 6389.37 toks/s, output: 926.61 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 27.61it/s, est. speed input: 10134.99 toks/s, output: 1462.47 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 22.11it/s, est. speed input: 8787.83 toks/s, output: 1270.28 toks/s] [A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 23.73it/s, est. speed input: 9162.56 toks/s, output: 1587.70 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:01<00:00, 10.61it/s, est. speed input: 5451.58 toks/s, output: 1129.58 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:06<00:00,  2.37it/s, est. speed input: 928.16 toks/s, output: 366.17 toks/s]  
Processing batched inference:  20%|██        | 27/132 [01:16<07:10,  4.10s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 42.46it/s, est. speed input: 16643.87 toks/s, output: 2377.55 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 29.61it/s, est. speed input: 12308.56 toks/s, output: 2122.94 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.60it/s, est. speed input: 10436.52 toks/s, output: 1970.53 toks/s]
Processing batched inference:  21%|██        | 28/132 [01:19<06:11,  3.57s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 51.19it/s, est. speed input: 20087.06 toks/s, output: 2883.87 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 42.06it/s, est. speed input: 16982.33 toks/s, output: 2805.66 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.06it/s, est. speed input: 10231.58 toks/s, output: 1928.35 toks/s]
Processing batched inference:  22%|██▏       | 29/132 [01:21<05:24,  3.15s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 60.18it/s, est. speed input: 23617.57 toks/s, output: 3731.38 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 23.71it/s, est. speed input: 10301.76 toks/s, output: 1808.24 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.36it/s, est. speed input: 9167.63 toks/s, output: 1664.42 toks/s] 
Processing batched inference:  23%|██▎       | 30/132 [01:23<04:58,  2.93s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 29.28it/s, est. speed input: 11509.39 toks/s, output: 1898.60 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 34.52it/s, est. speed input: 13182.41 toks/s, output: 2055.14 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 25.15it/s, est. speed input: 10589.68 toks/s, output: 1787.67 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.17it/s, est. speed input: 10675.07 toks/s, output: 1861.52 toks/s]
Processing batched inference:  23%|██▎       | 31/132 [01:26<04:38,  2.76s/it]Resource status after batch 30:
Open files: 0
Memory usage: 4584.62 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 67.90it/s, est. speed input: 26684.02 toks/s, output: 3855.32 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.72it/s, est. speed input: 17161.64 toks/s, output: 2617.29 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.65it/s, est. speed input: 17161.64 toks/s, output: 2617.29 toks/s]
Processing batched inference:  24%|██▍       | 32/132 [01:28<04:29,  2.70s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 37.52it/s, est. speed input: 14738.58 toks/s, output: 2129.39 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 22.26it/s, est. speed input: 9308.90 toks/s, output: 1475.81 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.91it/s, est. speed input: 9563.27 toks/s, output: 1527.38 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.33it/s, est. speed input: 9563.27 toks/s, output: 1527.38 toks/s]
Processing batched inference:  25%|██▌       | 33/132 [01:30<04:13,  2.56s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 48.68it/s, est. speed input: 19116.58 toks/s, output: 2757.36 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:17<00:00, 48.68it/s, est. speed input: 15751.37 toks/s, output: 2515.01 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.75s/it, est. speed input: 281.47 toks/s, output: 225.71 toks/s]   [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.39s/it, est. speed input: 281.47 toks/s, output: 225.71 toks/s]
Processing batched inference:  26%|██▌       | 34/132 [01:54<14:40,  8.99s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 35.92it/s, est. speed input: 14127.62 toks/s, output: 2056.51 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 27.86it/s, est. speed input: 11328.27 toks/s, output: 1975.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 35.86it/s, est. speed input: 13472.27 toks/s, output: 2185.89 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.33it/s, est. speed input: 11513.16 toks/s, output: 2084.76 toks/s]
Processing batched inference:  27%|██▋       | 35/132 [01:57<11:14,  6.95s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 26.23it/s, est. speed input: 10336.38 toks/s, output: 1521.42 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 26.26it/s, est. speed input: 10315.52 toks/s, output: 1492.85 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 30.24it/s, est. speed input: 11452.28 toks/s, output: 1660.97 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.12it/s, est. speed input: 9628.46 toks/s, output: 1754.36 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.51it/s, est. speed input: 9628.46 toks/s, output: 1754.36 toks/s]
Processing batched inference:  27%|██▋       | 36/132 [01:59<08:51,  5.53s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 74.06it/s, est. speed input: 29063.07 toks/s, output: 4628.88 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.62it/s, est. speed input: 14366.99 toks/s, output: 2398.26 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.60it/s, est. speed input: 14366.99 toks/s, output: 2398.26 toks/s]
Processing batched inference:  28%|██▊       | 37/132 [02:01<07:08,  4.51s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 102.90it/s, est. speed input: 40490.24 toks/s, output: 6819.35 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.51it/s, est. speed input: 15930.74 toks/s, output: 2562.62 toks/s] 
Processing batched inference:  29%|██▉       | 38/132 [02:03<06:00,  3.83s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 68.93it/s, est. speed input: 27071.24 toks/s, output: 3906.37 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.30it/s, est. speed input: 14733.58 toks/s, output: 2368.08 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 37.46it/s, est. speed input: 14733.58 toks/s, output: 2368.08 toks/s]
Processing batched inference:  30%|██▉       | 39/132 [02:05<05:00,  3.23s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 46.46it/s, est. speed input: 18240.95 toks/s, output: 2620.16 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 26.82it/s, est. speed input: 11254.66 toks/s, output: 1629.44 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 19.61it/s, est. speed input: 8664.41 toks/s, output: 1477.64 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.76it/s, est. speed input: 8942.64 toks/s, output: 1696.01 toks/s]
Processing batched inference:  30%|███       | 40/132 [02:07<04:26,  2.90s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 36.64it/s, est. speed input: 14400.36 toks/s, output: 2088.45 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 29.36it/s, est. speed input: 11946.11 toks/s, output: 1851.39 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 31.52it/s, est. speed input: 12437.81 toks/s, output: 1894.13 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.66it/s, est. speed input: 9290.82 toks/s, output: 1472.78 toks/s] 
Processing batched inference:  31%|███       | 41/132 [02:09<04:03,  2.68s/it]Resource status after batch 40:
Open files: 0
Memory usage: 5463.09 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 81.05it/s, est. speed input: 31876.29 toks/s, output: 4638.23 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.03it/s, est. speed input: 11000.87 toks/s, output: 1823.51 toks/s]
Processing batched inference:  32%|███▏      | 42/132 [02:12<03:53,  2.60s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 75.14it/s, est. speed input: 29491.07 toks/s, output: 5532.93 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.80it/s, est. speed input: 6591.03 toks/s, output: 1392.52 toks/s] 
Processing batched inference:  33%|███▎      | 43/132 [02:15<04:01,  2.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 30.85it/s, est. speed input: 12132.11 toks/s, output: 1763.91 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 24.12it/s, est. speed input: 9879.94 toks/s, output: 1566.68 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 30.10it/s, est. speed input: 11407.14 toks/s, output: 2127.06 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.03it/s, est. speed input: 11019.11 toks/s, output: 2100.74 toks/s]
Processing batched inference:  33%|███▎      | 44/132 [02:17<03:40,  2.50s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 28.98it/s, est. speed input: 11354.76 toks/s, output: 1615.65 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 39.02it/s, est. speed input: 14718.51 toks/s, output: 2131.44 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 30.66it/s, est. speed input: 12483.44 toks/s, output: 2022.96 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.11it/s, est. speed input: 8684.73 toks/s, output: 1591.82 toks/s] 
Processing batched inference:  34%|███▍      | 45/132 [02:19<03:28,  2.39s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 31.68it/s, est. speed input: 12414.30 toks/s, output: 1767.89 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 27.77it/s, est. speed input: 11113.97 toks/s, output: 1729.39 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 24.90it/s, est. speed input: 10134.90 toks/s, output: 1685.63 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.29it/s, est. speed input: 7564.77 toks/s, output: 1426.36 toks/s] 
Processing batched inference:  35%|███▍      | 46/132 [02:21<03:19,  2.32s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01, 11.20it/s, est. speed input: 4381.12 toks/s, output: 616.23 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 15.81it/s, est. speed input: 5916.93 toks/s, output: 849.94 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 40.45it/s, est. speed input: 12623.30 toks/s, output: 1822.63 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.39it/s, est. speed input: 9972.74 toks/s, output: 1587.23 toks/s] 
Processing batched inference:  36%|███▌      | 47/132 [02:23<03:09,  2.23s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 57.53it/s, est. speed input: 22596.47 toks/s, output: 3262.91 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 32.41it/s, est. speed input: 13681.72 toks/s, output: 2331.20 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:03<00:00,  4.73it/s, est. speed input: 1857.13 toks/s, output: 519.83 toks/s]  
Processing batched inference:  36%|███▋      | 48/132 [02:28<04:14,  3.03s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 17.28it/s, est. speed input: 6774.41 toks/s, output: 967.68 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 18.20it/s, est. speed input: 7074.28 toks/s, output: 1006.63 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 29.77it/s, est. speed input: 10414.28 toks/s, output: 1485.17 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 29.79it/s, est. speed input: 10789.29 toks/s, output: 1653.95 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.53it/s, est. speed input: 10473.68 toks/s, output: 1820.09 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.69it/s, est. speed input: 10473.68 toks/s, output: 1820.09 toks/s]
Processing batched inference:  37%|███▋      | 49/132 [02:30<03:40,  2.66s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 16.57it/s, est. speed input: 6504.22 toks/s, output: 936.18 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 21.58it/s, est. speed input: 8184.90 toks/s, output: 1187.06 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 40.62it/s, est. speed input: 13931.48 toks/s, output: 2014.04 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:18<00:00, 40.62it/s, est. speed input: 9597.74 toks/s, output: 1466.02 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.12s/it, est. speed input: 281.50 toks/s, output: 223.77 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.40s/it, est. speed input: 281.50 toks/s, output: 223.77 toks/s]
Processing batched inference:  38%|███▊      | 50/132 [02:54<12:22,  9.06s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.03it/s, est. speed input: 2357.68 toks/s, output: 331.62 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 38.23it/s, est. speed input: 13119.12 toks/s, output: 1905.24 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 30.99it/s, est. speed input: 11690.45 toks/s, output: 1987.99 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.34it/s, est. speed input: 9178.21 toks/s, output: 1619.14 toks/s] 
Processing batched inference:  39%|███▊      | 51/132 [02:56<09:18,  6.89s/it]Resource status after batch 50:
Open files: 0
Memory usage: 6196.20 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 67.51it/s, est. speed input: 26505.95 toks/s, output: 4067.62 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.45it/s, est. speed input: 10786.81 toks/s, output: 1721.12 toks/s]
Processing batched inference:  39%|███▉      | 52/132 [02:58<07:27,  5.59s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  9.97it/s, est. speed input: 3927.18 toks/s, output: 578.04 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01, 11.19it/s, est. speed input: 4340.25 toks/s, output: 626.32 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 25.48it/s, est. speed input: 8421.63 toks/s, output: 1212.21 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 24.06it/s, est. speed input: 8672.27 toks/s, output: 1316.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.94it/s, est. speed input: 7437.24 toks/s, output: 1298.92 toks/s]
Processing batched inference:  40%|████      | 53/132 [03:00<05:54,  4.49s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 20.68it/s, est. speed input: 8123.50 toks/s, output: 1173.64 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 24.83it/s, est. speed input: 9508.97 toks/s, output: 1381.36 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 28.65it/s, est. speed input: 10580.98 toks/s, output: 1616.96 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.98it/s, est. speed input: 6667.48 toks/s, output: 1102.92 toks/s] 
Processing batched inference:  41%|████      | 54/132 [03:02<04:56,  3.80s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:01, 10.18it/s, est. speed input: 3998.99 toks/s, output: 579.99 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 25.23it/s, est. speed input: 8532.73 toks/s, output: 1418.11 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.39it/s, est. speed input: 8223.42 toks/s, output: 1621.62 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.93it/s, est. speed input: 8223.42 toks/s, output: 1621.62 toks/s]
Processing batched inference:  42%|████▏     | 55/132 [03:04<04:13,  3.30s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.44it/s, est. speed input: 2538.78 toks/s, output: 373.68 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 22.06it/s, est. speed input: 7728.21 toks/s, output: 1265.58 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.42it/s, est. speed input: 10482.62 toks/s, output: 1669.48 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.67it/s, est. speed input: 10482.62 toks/s, output: 1669.48 toks/s]
Processing batched inference:  42%|████▏     | 56/132 [03:06<03:38,  2.88s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:09,  1.59it/s, est. speed input: 620.86 toks/s, output: 87.33 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 15.88it/s, est. speed input: 5091.12 toks/s, output: 785.47 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00,  9.42it/s, est. speed input: 3689.69 toks/s, output: 760.12 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00,  9.39it/s, est. speed input: 3689.69 toks/s, output: 760.12 toks/s]
Processing batched inference:  43%|████▎     | 57/132 [03:08<03:19,  2.66s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 37.37it/s, est. speed input: 14663.68 toks/s, output: 2105.34 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 31.53it/s, est. speed input: 12734.47 toks/s, output: 1833.05 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 36.82it/s, est. speed input: 14100.37 toks/s, output: 2156.16 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.98it/s, est. speed input: 6670.25 toks/s, output: 1121.58 toks/s] 
Processing batched inference:  44%|████▍     | 58/132 [03:11<03:12,  2.60s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.06it/s, est. speed input: 1194.83 toks/s, output: 168.06 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 28.28it/s, est. speed input: 9434.86 toks/s, output: 1436.57 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.22it/s, est. speed input: 10289.10 toks/s, output: 1696.51 toks/s]
Processing batched inference:  45%|████▍     | 59/132 [03:12<02:47,  2.30s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.08it/s, est. speed input: 1204.63 toks/s, output: 169.44 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 32.51it/s, est. speed input: 10141.39 toks/s, output: 1474.86 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.36it/s, est. speed input: 6823.35 toks/s, output: 1137.36 toks/s] 
Processing batched inference:  45%|████▌     | 60/132 [03:14<02:35,  2.16s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.64it/s, est. speed input: 1038.84 toks/s, output: 152.92 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 25.90it/s, est. speed input: 8037.53 toks/s, output: 1154.92 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 27.45it/s, est. speed input: 8976.82 toks/s, output: 1355.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.19it/s, est. speed input: 9491.29 toks/s, output: 1494.14 toks/s]
Processing batched inference:  46%|████▌     | 61/132 [03:16<02:20,  1.98s/it]Resource status after batch 60:
Open files: 0
Memory usage: 6737.28 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 24.82it/s, est. speed input: 9731.62 toks/s, output: 1390.09 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 30.01it/s, est. speed input: 11470.62 toks/s, output: 1649.31 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 33.32it/s, est. speed input: 12486.21 toks/s, output: 1916.41 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.27it/s, est. speed input: 14237.55 toks/s, output: 2151.41 toks/s]
Processing batched inference:  47%|████▋     | 62/132 [03:18<02:12,  1.89s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  7.85it/s, est. speed input: 3084.66 toks/s, output: 447.35 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 31.97it/s, est. speed input: 11085.09 toks/s, output: 1593.88 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 36.03it/s, est. speed input: 12822.20 toks/s, output: 1840.31 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.12it/s, est. speed input: 14161.24 toks/s, output: 2228.45 toks/s]
Processing batched inference:  48%|████▊     | 63/132 [03:19<02:06,  1.84s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.22it/s, est. speed input: 1262.87 toks/s, output: 180.40 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 35.57it/s, est. speed input: 11157.09 toks/s, output: 1603.97 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.25it/s, est. speed input: 7167.91 toks/s, output: 1258.11 toks/s] 
Processing batched inference:  48%|████▊     | 64/132 [03:21<02:05,  1.85s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 32.71it/s, est. speed input: 12857.17 toks/s, output: 1859.22 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 37.52it/s, est. speed input: 14386.50 toks/s, output: 2221.68 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 22.61it/s, est. speed input: 9984.89 toks/s, output: 1605.66 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.32it/s, est. speed input: 9168.03 toks/s, output: 1537.94 toks/s]
Processing batched inference:  49%|████▉     | 65/132 [03:23<02:11,  1.97s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.51it/s, est. speed input: 1774.50 toks/s, output: 257.36 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 25.50it/s, est. speed input: 8348.75 toks/s, output: 1203.05 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 28.81it/s, est. speed input: 9988.14 toks/s, output: 1531.81 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.20it/s, est. speed input: 11087.24 toks/s, output: 1861.34 toks/s]
Processing batched inference:  50%|█████     | 66/132 [03:25<02:05,  1.90s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 52.70it/s, est. speed input: 20746.09 toks/s, output: 3035.84 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.25it/s, est. speed input: 9820.52 toks/s, output: 1741.96 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.94it/s, est. speed input: 9820.52 toks/s, output: 1741.96 toks/s]
Processing batched inference:  51%|█████     | 67/132 [03:27<02:12,  2.04s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 59.98it/s, est. speed input: 23584.53 toks/s, output: 3419.01 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 31.76it/s, est. speed input: 13561.57 toks/s, output: 1949.66 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.98it/s, est. speed input: 10586.69 toks/s, output: 1676.16 toks/s]
Processing batched inference:  52%|█████▏    | 68/132 [03:29<02:09,  2.03s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.30it/s, est. speed input: 2066.78 toks/s, output: 286.15 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 24.21it/s, est. speed input: 8035.90 toks/s, output: 1133.22 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 40.68it/s, est. speed input: 13006.04 toks/s, output: 1857.91 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.08it/s, est. speed input: 12185.66 toks/s, output: 1828.18 toks/s]
Processing batched inference:  52%|█████▏    | 69/132 [03:31<01:58,  1.89s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  7.59it/s, est. speed input: 2962.39 toks/s, output: 410.13 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 23.42it/s, est. speed input: 8330.28 toks/s, output: 1202.11 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 25.12it/s, est. speed input: 9035.62 toks/s, output: 1420.13 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.70it/s, est. speed input: 9538.10 toks/s, output: 1593.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.28it/s, est. speed input: 9538.10 toks/s, output: 1593.70 toks/s]
Processing batched inference:  53%|█████▎    | 70/132 [03:33<02:02,  1.97s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.10it/s, est. speed input: 1208.07 toks/s, output: 167.26 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 22.05it/s, est. speed input: 7415.23 toks/s, output: 1142.50 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.98it/s, est. speed input: 6976.41 toks/s, output: 1375.94 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.77it/s, est. speed input: 6976.41 toks/s, output: 1375.94 toks/s]
Processing batched inference:  54%|█████▍    | 71/132 [03:35<02:00,  1.97s/it]Resource status after batch 70:
Open files: 0
Memory usage: 7278.44 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 16.05it/s, est. speed input: 6301.09 toks/s, output: 906.87 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 15.51it/s, est. speed input: 6120.36 toks/s, output: 880.98 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 35.30it/s, est. speed input: 11699.48 toks/s, output: 1811.07 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.22it/s, est. speed input: 8317.13 toks/s, output: 1390.80 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.19it/s, est. speed input: 8317.13 toks/s, output: 1390.80 toks/s]
Processing batched inference:  55%|█████▍    | 72/132 [03:37<01:59,  2.00s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.42it/s, est. speed input: 1332.33 toks/s, output: 184.47 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 27.36it/s, est. speed input: 8698.34 toks/s, output: 1246.81 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 25.72it/s, est. speed input: 8941.25 toks/s, output: 1513.51 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.05it/s, est. speed input: 7085.51 toks/s, output: 1339.43 toks/s]
Processing batched inference:  55%|█████▌    | 73/132 [03:39<01:57,  1.99s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.51it/s, est. speed input: 2153.67 toks/s, output: 302.91 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 36.45it/s, est. speed input: 12027.41 toks/s, output: 1712.28 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 37.05it/s, est. speed input: 12906.12 toks/s, output: 1847.71 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.78it/s, est. speed input: 8939.50 toks/s, output: 1422.47 toks/s] 
Processing batched inference:  56%|█████▌    | 74/132 [03:41<01:52,  1.94s/it]ERROR 06-30 23:30:47 [core.py:387] EngineCore hit an exception: Traceback (most recent call last):
ERROR 06-30 23:30:47 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 68, in __getitem__
ERROR 06-30 23:30:47 [core.py:387]     return self.__data[key]
ERROR 06-30 23:30:47 [core.py:387]            ~~~~~~~~~~~^^^^^
ERROR 06-30 23:30:47 [core.py:387] KeyError: '63856a4bd3da16c3dfcc53924ca8b661c4c71091c932252df7d1e4a15c6feebb'
ERROR 06-30 23:30:47 [core.py:387] 
ERROR 06-30 23:30:47 [core.py:387] During handling of the above exception, another exception occurred:
ERROR 06-30 23:30:47 [core.py:387] 
ERROR 06-30 23:30:47 [core.py:387] Traceback (most recent call last):
ERROR 06-30 23:30:47 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 380, in run_engine_core
ERROR 06-30 23:30:47 [core.py:387]     engine_core.run_busy_loop()
ERROR 06-30 23:30:47 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 400, in run_busy_loop
ERROR 06-30 23:30:47 [core.py:387]     self._process_input_queue()
ERROR 06-30 23:30:47 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 425, in _process_input_queue
ERROR 06-30 23:30:47 [core.py:387]     self._handle_client_request(*req)
ERROR 06-30 23:30:47 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 441, in _handle_client_request
ERROR 06-30 23:30:47 [core.py:387]     self.add_request(request)
ERROR 06-30 23:30:47 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 177, in add_request
ERROR 06-30 23:30:47 [core.py:387]     request.mm_inputs = self.mm_input_cache_server.get_and_update_p1(
ERROR 06-30 23:30:47 [core.py:387]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:30:47 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/mm_input_cache.py", line 76, in get_and_update_p1
ERROR 06-30 23:30:47 [core.py:387]     mm_input = self.mm_cache[mm_hash]
ERROR 06-30 23:30:47 [core.py:387]                ~~~~~~~~~~~~~^^^^^^^^^
ERROR 06-30 23:30:47 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 211, in __getitem__
ERROR 06-30 23:30:47 [core.py:387]     value = cache_getitem(self, key)
ERROR 06-30 23:30:47 [core.py:387]             ^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:30:47 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 70, in __getitem__
ERROR 06-30 23:30:47 [core.py:387]     return self.__missing__(key)
ERROR 06-30 23:30:47 [core.py:387]            ^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:30:47 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 97, in __missing__
ERROR 06-30 23:30:47 [core.py:387]     raise KeyError(key)
ERROR 06-30 23:30:47 [core.py:387] KeyError: '63856a4bd3da16c3dfcc53924ca8b661c4c71091c932252df7d1e4a15c6feebb'
ERROR 06-30 23:30:47 [core.py:387] 
CRITICAL 06-30 23:30:47 [core_client.py:359] Got fatal signal from worker processes, shutting down. See stack trace above for root cause issue.
batch_inference.sh: line 23: 496311 Killed                  python scripts/vllm_infer_new.py --model_name_or_path "$ckpt" --dataset $EVAL_DATASET --template qwen2_vl --save_name "$save_path/generated_predictions.jsonl" --max_new_tokens 4096 --temperature 0.0 --top_p 1.0 --top_k -1 --repetition_penalty 1.0 --batch_size 16 --seed 42
Running inference on checkpoint: checkpoint-63
INFO 06-30 23:30:57 [__init__.py:239] Automatically detected platform cuda.
[INFO|training_args.py:2135] 2025-06-30 23:30:59,438 >> PyTorch: setting up devices
[INFO|training_args.py:1812] 2025-06-30 23:30:59,480 >> The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,497 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,497 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,497 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,497 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,497 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,497 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,497 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:30:59,888 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:378] 2025-06-30 23:30:59,889 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63/preprocessor_config.json
[INFO|image_processing_base.py:378] 2025-06-30 23:30:59,894 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:30:59,900 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,901 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,901 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,901 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,901 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,901 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,901 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:30:59,901 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:31:00,280 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:31:00,281 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:31:00,477 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:31:00,916 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}

[INFO|configuration_utils.py:696] 2025-06-30 23:31:00,971 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63/config.json
[INFO|configuration_utils.py:696] 2025-06-30 23:31:00,972 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63/config.json
[INFO|configuration_utils.py:770] 2025-06-30 23:31:00,974 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "text_config": {
    "architectures": [
      "Qwen2VLForConditionalGeneration"
    ],
    "attention_dropout": 0.0,
    "bos_token_id": 151643,
    "eos_token_id": 151645,
    "hidden_act": "silu",
    "hidden_size": 1536,
    "image_token_id": null,
    "initializer_range": 0.02,
    "intermediate_size": 8960,
    "max_position_embeddings": 32768,
    "max_window_layers": 28,
    "model_type": "qwen2_vl_text",
    "num_attention_heads": 12,
    "num_hidden_layers": 28,
    "num_key_value_heads": 2,
    "rms_norm_eps": 1e-06,
    "rope_scaling": {
      "mrope_section": [
        16,
        24,
        24
      ],
      "rope_type": "default",
      "type": "default"
    },
    "rope_theta": 1000000.0,
    "sliding_window": 32768,
    "tie_word_embeddings": true,
    "torch_dtype": "float32",
    "use_cache": false,
    "use_sliding_window": false,
    "video_token_id": null,
    "vision_end_token_id": 151653,
    "vision_start_token_id": 151652,
    "vision_token_id": 151654,
    "vocab_size": 151936
  },
  "torch_dtype": "bfloat16",
  "transformers_version": "4.52.4",
  "use_cache": false,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "depth": 32,
    "embed_dim": 1280,
    "hidden_act": "quick_gelu",
    "hidden_size": 1536,
    "in_channels": 3,
    "in_chans": 3,
    "initializer_range": 0.02,
    "mlp_ratio": 4,
    "model_type": "qwen2_vl",
    "num_heads": 16,
    "patch_size": 14,
    "spatial_merge_size": 2,
    "spatial_patch_size": 14,
    "temporal_patch_size": 2,
    "torch_dtype": "float32"
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 151936
}

INFO 06-30 23:31:12 [config.py:689] This model supports multiple tasks: {'classify', 'score', 'reward', 'generate', 'embed'}. Defaulting to 'generate'.
INFO 06-30 23:31:12 [config.py:1901] Chunked prefill is enabled with max_num_batched_tokens=8192.
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:31:13,472 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:31:13,472 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:31:13,472 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:31:13,472 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:31:13,472 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:31:13,472 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:31:13,472 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:31:13,810 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:1088] 2025-06-30 23:31:13,908 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63/generation_config.json
[INFO|configuration_utils.py:1135] 2025-06-30 23:31:13,909 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

WARNING 06-30 23:31:13 [utils.py:2304] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/getting_started/troubleshooting.html#python-multiprocessing for more information. Reason: CUDA is initialized
INFO 06-30 23:31:21 [__init__.py:239] Automatically detected platform cuda.
INFO 06-30 23:31:24 [core.py:61] Initializing a V1 LLM engine (v0.8.4) with config: model='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63', speculative_config=None, tokenizer='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-30 23:31:25 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f6df777e650>
INFO 06-30 23:31:25 [parallel_state.py:959] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-30 23:31:25 [cuda.py:221] Using Flash Attention backend on V1 engine.
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:31:28 [gpu_model_runner.py:1276] Starting to load model saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63...
WARNING 06-30 23:31:28 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-30 23:31:28 [config.py:3466] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
WARNING 06-30 23:31:28 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.12s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.12s/it]

INFO 06-30 23:31:36 [loader.py:458] Loading weights took 7.33 seconds
INFO 06-30 23:31:36 [gpu_model_runner.py:1291] Model loading took 4.1513 GiB and 7.606920 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:31:37 [gpu_model_runner.py:1560] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-30 23:31:51 [backends.py:416] Using cache directory: /root/.cache/vllm/torch_compile_cache/f76142d6b1/rank_0_0 for vLLM's torch.compile
INFO 06-30 23:31:51 [backends.py:426] Dynamo bytecode transform time: 7.42 s
INFO 06-30 23:31:52 [backends.py:115] Directly load the compiled graph for shape None from the cache
INFO 06-30 23:31:59 [monitor.py:33] torch.compile takes 7.42 s in total
INFO 06-30 23:31:59 [kv_cache_utils.py:634] GPU KV cache size: 1,006,016 tokens
INFO 06-30 23:31:59 [kv_cache_utils.py:637] Maximum concurrency for 6,144 tokens per request: 163.74x
INFO 06-30 23:32:20 [gpu_model_runner.py:1626] Graph capturing finished in 20 secs, took 0.47 GiB
INFO 06-30 23:32:20 [core.py:163] init engine (profile, create kv cache, warmup model) took 43.74 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:32:21 [core_client.py:435] Core engine process 0 ready.
[INFO|2025-06-30 23:32:21] llamafactory.data.loader:143 >> Loading dataset ./0_my_dataset/vindr/qwen2_vindr_input_test_len_2108.json...
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151653, 198, 5598, 30618, 14697, 315, 364, 47, 811, 372, 8767, 269, 706, 6, 5671, 438, 4718, 3561, 510, 73594, 2236, 198, 9640, 4913, 58456, 62, 17, 67, 788, 508, 87, 16, 11, 379, 16, 11, 856, 17, 11, 379, 17, 1125, 330, 1502, 788, 330, 1502, 7115, 9338, 921, 73594, 151645, 198, 151644, 77091, 198]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|vision_end|>
Return bounding boxes of 'Pneumothorax' areas as JSON format:
```json
[
{"bbox_2d": [x1, y1, x2, y2], "label": "label"},
...
]
```<|im_end|>
<|im_start|>assistant

label_ids:
[27, 9217, 397, 9640, 220, 341, 262, 330, 58456, 62, 17, 67, 788, 2278, 414, 220, 16, 22, 20, 345, 414, 220, 17, 22, 24, 345, 414, 220, 18, 15, 17, 345, 414, 220, 21, 23, 16, 198, 262, 3211, 262, 330, 1502, 788, 330, 47, 811, 372, 8767, 269, 706, 698, 220, 456, 921, 522, 9217, 29, 151645, 198]
labels:
<answer>
[
  {
    "bbox_2d": [
      175,
      279,
      302,
      681
    ],
    "label": "Pneumothorax"
  }
]
</answer><|im_end|>

Current file descriptor limits: soft=8192, hard=8192
Initial resource status:
Open files: 0
Memory usage: 924.20 MB
Using effective batch size: 16
Processing batched inference:   0%|          | 0/132 [00:00<?, ?it/s][INFO|image_processing_base.py:378] 2025-06-30 23:32:22,740 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:32:22,741 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|image_processing_base.py:378] 2025-06-30 23:32:22,741 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:32:22,742 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:32:22,742 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:32:22,742 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:32:22,742 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:32:22,742 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:32:22,742 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:32:22,742 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:32:22,742 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:32:23,551 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:32:23,551 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:32:23,552 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:32:24,042 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: CachedQwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-63', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='left', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}


Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 96.29it/s, est. speed input: 37892.53 toks/s, output: 5532.69 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.30it/s, est. speed input: 17028.25 toks/s, output: 2609.22 toks/s]
Processing batched inference:   1%|          | 1/132 [00:04<09:18,  4.26s/it]Resource status after batch 0:
Open files: 0
Memory usage: 1090.34 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 85.24it/s, est. speed input: 33457.24 toks/s, output: 5448.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.53it/s, est. speed input: 16705.97 toks/s, output: 2783.35 toks/s]
Processing batched inference:   2%|▏         | 2/132 [00:06<07:14,  3.34s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 78.50it/s, est. speed input: 30814.26 toks/s, output: 4435.24 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.26it/s, est. speed input: 15421.23 toks/s, output: 2346.33 toks/s]
Processing batched inference:   2%|▏         | 3/132 [00:09<06:26,  2.99s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 87.68it/s, est. speed input: 34435.00 toks/s, output: 4970.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.31it/s, est. speed input: 17405.83 toks/s, output: 2514.95 toks/s]
Processing batched inference:   3%|▎         | 4/132 [00:12<06:06,  2.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 85.73it/s, est. speed input: 33690.51 toks/s, output: 4880.40 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.08it/s, est. speed input: 17312.01 toks/s, output: 2499.04 toks/s]
Processing batched inference:   4%|▍         | 5/132 [00:14<05:53,  2.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 82.57it/s, est. speed input: 32479.22 toks/s, output: 4732.11 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.74it/s, est. speed input: 16415.14 toks/s, output: 2387.44 toks/s]
Processing batched inference:   5%|▍         | 6/132 [00:17<05:37,  2.68s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 96.34it/s, est. speed input: 37761.95 toks/s, output: 5721.21 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.94it/s, est. speed input: 12127.15 toks/s, output: 1901.49 toks/s]
Processing batched inference:   5%|▌         | 7/132 [00:20<05:38,  2.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 92.13it/s, est. speed input: 36198.30 toks/s, output: 5237.62 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.39it/s, est. speed input: 17053.36 toks/s, output: 2470.98 toks/s]
Processing batched inference:   6%|▌         | 8/132 [00:22<05:21,  2.59s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 71.49it/s, est. speed input: 28059.96 toks/s, output: 4035.43 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.73it/s, est. speed input: 8532.90 toks/s, output: 1490.28 toks/s]
Processing batched inference:   7%|▋         | 9/132 [00:25<05:22,  2.62s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 48.36it/s, est. speed input: 18989.60 toks/s, output: 3119.13 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.05it/s, est. speed input: 15338.82 toks/s, output: 2555.59 toks/s]
Processing batched inference:   8%|▊         | 10/132 [00:27<05:16,  2.60s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 87.45it/s, est. speed input: 34284.72 toks/s, output: 5255.14 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.61it/s, est. speed input: 11608.30 toks/s, output: 1824.86 toks/s]
Processing batched inference:   8%|▊         | 11/132 [00:30<05:12,  2.59s/it]Resource status after batch 10:
Open files: 0
Memory usage: 2802.13 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 67.48it/s, est. speed input: 26503.04 toks/s, output: 4122.88 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.26it/s, est. speed input: 15417.68 toks/s, output: 2454.17 toks/s]
Processing batched inference:   9%|▉         | 12/132 [00:32<05:07,  2.56s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 97.68it/s, est. speed input: 38397.79 toks/s, output: 5568.20 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.24it/s, est. speed input: 16987.00 toks/s, output: 2454.40 toks/s]
Processing batched inference:  10%|▉         | 13/132 [00:35<04:54,  2.47s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 93.67it/s, est. speed input: 36743.90 toks/s, output: 5686.00 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.79it/s, est. speed input: 16402.24 toks/s, output: 2593.86 toks/s]
Processing batched inference:  11%|█         | 14/132 [00:37<04:53,  2.49s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 80.02it/s, est. speed input: 31420.08 toks/s, output: 4807.49 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.21it/s, est. speed input: 16977.12 toks/s, output: 2576.87 toks/s]
Processing batched inference:  11%|█▏        | 15/132 [00:39<04:42,  2.41s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 75.66it/s, est. speed input: 29719.20 toks/s, output: 4293.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.96it/s, est. speed input: 17270.37 toks/s, output: 2495.38 toks/s]
Processing batched inference:  12%|█▏        | 16/132 [00:41<04:26,  2.30s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 73.38it/s, est. speed input: 28792.00 toks/s, output: 4133.71 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.54it/s, est. speed input: 16692.46 toks/s, output: 2517.84 toks/s]
Processing batched inference:  13%|█▎        | 17/132 [00:44<04:22,  2.29s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.14it/s, est. speed input: 2400.09 toks/s, output: 337.57 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 44.79it/s, est. speed input: 15016.78 toks/s, output: 2171.96 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.80it/s, est. speed input: 9393.54 toks/s, output: 1415.65 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.93it/s, est. speed input: 9393.54 toks/s, output: 1415.65 toks/s]
Processing batched inference:  14%|█▎        | 18/132 [00:45<04:06,  2.16s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 95.29it/s, est. speed input: 37422.90 toks/s, output: 5402.25 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.22it/s, est. speed input: 17369.77 toks/s, output: 2509.74 toks/s]
Processing batched inference:  14%|█▍        | 19/132 [00:48<04:18,  2.29s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 44.43it/s, est. speed input: 17467.72 toks/s, output: 2849.74 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 46.89it/s, est. speed input: 18231.26 toks/s, output: 2991.35 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.25it/s, est. speed input: 15408.39 toks/s, output: 2450.65 toks/s]
Processing batched inference:  15%|█▌        | 20/132 [00:50<04:08,  2.22s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 102.95it/s, est. speed input: 40372.04 toks/s, output: 6486.02 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.85it/s, est. speed input: 17581.17 toks/s, output: 2758.96 toks/s] 
Processing batched inference:  16%|█▌        | 21/132 [00:53<04:28,  2.42s/it]Resource status after batch 20:
Open files: 0
Memory usage: 4343.51 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 96.66it/s, est. speed input: 37978.43 toks/s, output: 5493.63 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.85it/s, est. speed input: 17223.41 toks/s, output: 2609.59 toks/s]
Processing batched inference:  17%|█▋        | 22/132 [00:55<04:23,  2.39s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 89.32it/s, est. speed input: 35055.08 toks/s, output: 5374.31 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.63it/s, est. speed input: 16750.23 toks/s, output: 2673.01 toks/s]
Processing batched inference:  17%|█▋        | 23/132 [00:58<04:17,  2.36s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 78.23it/s, est. speed input: 30768.77 toks/s, output: 4478.84 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.19it/s, est. speed input: 17035.23 toks/s, output: 2723.05 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.34it/s, est. speed input: 17035.23 toks/s, output: 2723.05 toks/s]
Processing batched inference:  18%|█▊        | 24/132 [01:00<04:12,  2.34s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 40.97it/s, est. speed input: 16118.86 toks/s, output: 2352.69 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 24.90it/s, est. speed input: 10508.96 toks/s, output: 1624.40 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.41it/s, est. speed input: 12351.18 toks/s, output: 1979.28 toks/s]
Processing batched inference:  19%|█▉        | 25/132 [01:02<04:05,  2.30s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 72.05it/s, est. speed input: 28266.29 toks/s, output: 4054.58 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.78it/s, est. speed input: 16797.22 toks/s, output: 2422.43 toks/s]
Processing batched inference:  20%|█▉        | 26/132 [01:04<03:57,  2.24s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 30.56it/s, est. speed input: 12022.97 toks/s, output: 1940.71 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 34.18it/s, est. speed input: 13137.05 toks/s, output: 2256.33 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.88it/s, est. speed input: 12505.10 toks/s, output: 2339.17 toks/s]
Processing batched inference:  20%|██        | 27/132 [01:06<03:47,  2.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 64.84it/s, est. speed input: 25448.78 toks/s, output: 3660.57 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.15it/s, est. speed input: 10651.23 toks/s, output: 1680.13 toks/s]
Processing batched inference:  21%|██        | 28/132 [01:09<04:01,  2.32s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 76.51it/s, est. speed input: 30027.09 toks/s, output: 4315.45 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.64it/s, est. speed input: 10461.55 toks/s, output: 1746.88 toks/s]
Processing batched inference:  22%|██▏       | 29/132 [01:11<03:54,  2.28s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 67.97it/s, est. speed input: 26671.96 toks/s, output: 3831.77 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 32.65it/s, est. speed input: 13982.83 toks/s, output: 2132.14 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.08it/s, est. speed input: 13376.54 toks/s, output: 2123.90 toks/s]
Processing batched inference:  23%|██▎       | 30/132 [01:13<03:50,  2.26s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 58.67it/s, est. speed input: 23112.55 toks/s, output: 3394.61 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 35.75it/s, est. speed input: 14982.41 toks/s, output: 2424.59 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.12it/s, est. speed input: 13011.94 toks/s, output: 2169.64 toks/s]
Processing batched inference:  23%|██▎       | 31/132 [01:15<03:44,  2.22s/it]Resource status after batch 30:
Open files: 0
Memory usage: 5640.61 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 65.04it/s, est. speed input: 25554.89 toks/s, output: 3699.92 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.10it/s, est. speed input: 10187.78 toks/s, output: 1709.27 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.91it/s, est. speed input: 10187.78 toks/s, output: 1709.27 toks/s]
Processing batched inference:  24%|██▍       | 32/132 [01:18<03:53,  2.34s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 35.00it/s, est. speed input: 13758.31 toks/s, output: 1995.32 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 20.99it/s, est. speed input: 8830.52 toks/s, output: 1272.18 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 37.70it/s, est. speed input: 14815.83 toks/s, output: 2144.73 toks/s]
Processing batched inference:  25%|██▌       | 33/132 [01:20<03:38,  2.21s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 90.38it/s, est. speed input: 35486.85 toks/s, output: 5116.83 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.17it/s, est. speed input: 16948.44 toks/s, output: 2439.61 toks/s]
Processing batched inference:  26%|██▌       | 34/132 [01:22<03:38,  2.23s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 49.90it/s, est. speed input: 19614.75 toks/s, output: 2844.53 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 46.47it/s, est. speed input: 18445.44 toks/s, output: 2668.47 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.07it/s, est. speed input: 14942.72 toks/s, output: 2255.92 toks/s]
Processing batched inference:  27%|██▋       | 35/132 [01:24<03:30,  2.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 49.45it/s, est. speed input: 19417.36 toks/s, output: 2800.21 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 27.93it/s, est. speed input: 11922.49 toks/s, output: 1717.18 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.35it/s, est. speed input: 14278.56 toks/s, output: 2063.12 toks/s]
Processing batched inference:  27%|██▋       | 36/132 [01:26<03:31,  2.20s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 52.86it/s, est. speed input: 20758.32 toks/s, output: 2993.39 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 30.62it/s, est. speed input: 12951.46 toks/s, output: 1970.36 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.93it/s, est. speed input: 13708.98 toks/s, output: 2166.12 toks/s]
Processing batched inference:  28%|██▊       | 37/132 [01:29<03:29,  2.21s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 52.24it/s, est. speed input: 20557.78 toks/s, output: 3003.79 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 39.64it/s, est. speed input: 16266.59 toks/s, output: 2516.45 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.65it/s, est. speed input: 15198.61 toks/s, output: 2328.89 toks/s]
Processing batched inference:  29%|██▉       | 38/132 [01:31<03:28,  2.22s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 39.88it/s, est. speed input: 15663.52 toks/s, output: 2263.04 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 53.11it/s, est. speed input: 20253.38 toks/s, output: 2937.38 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.59it/s, est. speed input: 13208.17 toks/s, output: 2022.12 toks/s]
Processing batched inference:  30%|██▉       | 39/132 [01:33<03:16,  2.12s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 48.02it/s, est. speed input: 18857.13 toks/s, output: 2718.29 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 28.51it/s, est. speed input: 11917.47 toks/s, output: 1715.38 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 37.34it/s, est. speed input: 14668.21 toks/s, output: 2121.41 toks/s]
Processing batched inference:  30%|███       | 40/132 [01:35<03:05,  2.01s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 17.01it/s, est. speed input: 6658.53 toks/s, output: 941.42 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 24.35it/s, est. speed input: 9058.62 toks/s, output: 1305.34 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 21.24it/s, est. speed input: 8341.74 toks/s, output: 1197.12 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.37it/s, est. speed input: 12714.72 toks/s, output: 1835.43 toks/s]
Processing batched inference:  31%|███       | 41/132 [01:36<02:59,  1.97s/it]Resource status after batch 40:
Open files: 0
Memory usage: 6856.26 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 58.17it/s, est. speed input: 22867.91 toks/s, output: 3579.98 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.53it/s, est. speed input: 16300.87 toks/s, output: 2473.60 toks/s]
Processing batched inference:  32%|███▏      | 42/132 [01:39<03:03,  2.04s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01,  9.55it/s, est. speed input: 3747.38 toks/s, output: 539.40 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 46.58it/s, est. speed input: 15510.82 toks/s, output: 2236.59 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.75it/s, est. speed input: 11670.03 toks/s, output: 1840.83 toks/s]
Processing batched inference:  33%|███▎      | 43/132 [01:41<02:57,  2.00s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 46.07it/s, est. speed input: 18096.94 toks/s, output: 2613.02 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 47.65it/s, est. speed input: 18628.42 toks/s, output: 2711.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.30it/s, est. speed input: 11126.19 toks/s, output: 1781.47 toks/s]
Processing batched inference:  33%|███▎      | 44/132 [01:43<02:59,  2.04s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 16.88it/s, est. speed input: 6621.55 toks/s, output: 950.69 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 46.50it/s, est. speed input: 16300.86 toks/s, output: 2369.61 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 40.00it/s, est. speed input: 15716.07 toks/s, output: 2385.48 toks/s]
Processing batched inference:  34%|███▍      | 45/132 [01:44<02:49,  1.95s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 55.31it/s, est. speed input: 21678.62 toks/s, output: 3089.59 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 32.60it/s, est. speed input: 13694.80 toks/s, output: 1958.25 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.32it/s, est. speed input: 11496.80 toks/s, output: 1815.91 toks/s]
Processing batched inference:  35%|███▍      | 46/132 [01:46<02:45,  1.92s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.41it/s, est. speed input: 1732.70 toks/s, output: 251.29 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 12.37it/s, est. speed input: 4279.21 toks/s, output: 618.30 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 30.10it/s, est. speed input: 9665.83 toks/s, output: 1541.18 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.53it/s, est. speed input: 9633.95 toks/s, output: 1603.81 toks/s]
Processing batched inference:  36%|███▌      | 47/132 [01:48<02:40,  1.89s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  9.22it/s, est. speed input: 3635.31 toks/s, output: 535.06 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 19.74it/s, est. speed input: 7129.34 toks/s, output: 1018.42 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 46.02it/s, est. speed input: 15329.01 toks/s, output: 2205.41 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.10it/s, est. speed input: 13378.32 toks/s, output: 2016.18 toks/s]
Processing batched inference:  36%|███▋      | 48/132 [01:50<02:39,  1.90s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 19.61it/s, est. speed input: 7689.28 toks/s, output: 1098.33 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 18.11it/s, est. speed input: 7177.42 toks/s, output: 1021.31 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 31.30it/s, est. speed input: 10939.19 toks/s, output: 1567.94 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 33.12it/s, est. speed input: 11749.61 toks/s, output: 1694.21 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.45it/s, est. speed input: 10773.65 toks/s, output: 1786.40 toks/s]
Processing batched inference:  37%|███▋      | 49/132 [01:52<02:34,  1.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 49.93it/s, est. speed input: 19625.69 toks/s, output: 2846.18 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 59.95it/s, est. speed input: 22960.76 toks/s, output: 3322.87 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.13it/s, est. speed input: 16552.73 toks/s, output: 2393.93 toks/s]
Processing batched inference:  38%|███▊      | 50/132 [01:54<02:31,  1.85s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.90it/s, est. speed input: 1526.10 toks/s, output: 214.65 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 47.85it/s, est. speed input: 15155.77 toks/s, output: 2202.79 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.96it/s, est. speed input: 14534.62 toks/s, output: 2115.91 toks/s]
Processing batched inference:  39%|███▊      | 51/132 [01:55<02:25,  1.79s/it]Resource status after batch 50:
Open files: 0
Memory usage: 7836.85 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 59.51it/s, est. speed input: 23331.45 toks/s, output: 3715.35 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 35.18it/s, est. speed input: 14794.26 toks/s, output: 2266.15 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.68it/s, est. speed input: 15589.64 toks/s, output: 2368.39 toks/s]
Processing batched inference:  39%|███▉      | 52/132 [01:57<02:31,  1.89s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.01it/s, est. speed input: 1973.88 toks/s, output: 290.55 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  9.61it/s, est. speed input: 3456.69 toks/s, output: 498.82 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 22.59it/s, est. speed input: 7617.18 toks/s, output: 1169.32 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.08it/s, est. speed input: 8666.68 toks/s, output: 1502.60 toks/s]
Processing batched inference:  40%|████      | 53/132 [01:59<02:28,  1.89s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 18.51it/s, est. speed input: 7272.06 toks/s, output: 1050.70 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 25.20it/s, est. speed input: 9394.37 toks/s, output: 1362.49 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 23.99it/s, est. speed input: 9203.34 toks/s, output: 1421.60 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.93it/s, est. speed input: 12536.39 toks/s, output: 1896.06 toks/s]
Processing batched inference:  41%|████      | 54/132 [02:01<02:23,  1.84s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 20.68it/s, est. speed input: 8127.28 toks/s, output: 1178.67 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 15.73it/s, est. speed input: 6409.68 toks/s, output: 927.29 toks/s] [A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 38.39it/s, est. speed input: 12585.66 toks/s, output: 1917.81 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.06it/s, est. speed input: 9054.55 toks/s, output: 1436.75 toks/s] 
Processing batched inference:  42%|████▏     | 55/132 [02:03<02:21,  1.84s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.46it/s, est. speed input: 2540.66 toks/s, output: 368.45 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 20.55it/s, est. speed input: 7283.88 toks/s, output: 1056.40 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.85it/s, est. speed input: 10227.08 toks/s, output: 1632.06 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.03it/s, est. speed input: 10227.08 toks/s, output: 1632.06 toks/s]
Processing batched inference:  42%|████▏     | 56/132 [02:05<02:21,  1.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:08,  1.78it/s, est. speed input: 697.14 toks/s, output: 98.06 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 21.08it/s, est. speed input: 6807.31 toks/s, output: 1040.94 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.82it/s, est. speed input: 7002.71 toks/s, output: 1122.91 toks/s]
Processing batched inference:  43%|████▎     | 57/132 [02:06<02:14,  1.79s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 14.04it/s, est. speed input: 5517.87 toks/s, output: 800.23 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 27.09it/s, est. speed input: 9856.98 toks/s, output: 1426.51 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 30.53it/s, est. speed input: 11039.32 toks/s, output: 1594.52 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.57it/s, est. speed input: 9224.55 toks/s, output: 1473.28 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.47it/s, est. speed input: 9224.55 toks/s, output: 1473.28 toks/s]
Processing batched inference:  44%|████▍     | 58/132 [02:08<02:17,  1.85s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.86it/s, est. speed input: 1901.29 toks/s, output: 267.42 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 26.51it/s, est. speed input: 8733.52 toks/s, output: 1253.05 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 38.64it/s, est. speed input: 12634.09 toks/s, output: 1914.27 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.76it/s, est. speed input: 12463.66 toks/s, output: 1967.67 toks/s]
Processing batched inference:  45%|████▍     | 59/132 [02:10<02:11,  1.80s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.66it/s, est. speed input: 1041.52 toks/s, output: 146.49 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 40.24it/s, est. speed input: 12339.40 toks/s, output: 1793.22 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.08it/s, est. speed input: 9071.37 toks/s, output: 1379.35 toks/s] 
Processing batched inference:  45%|████▌     | 60/132 [02:12<02:05,  1.74s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.57it/s, est. speed input: 1014.45 toks/s, output: 149.33 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 23.14it/s, est. speed input: 7158.15 toks/s, output: 1017.35 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 22.55it/s, est. speed input: 7685.47 toks/s, output: 1164.17 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.33it/s, est. speed input: 7973.53 toks/s, output: 1267.90 toks/s]
Processing batched inference:  46%|████▌     | 61/132 [02:13<02:01,  1.71s/it]Resource status after batch 60:
Open files: 0
Memory usage: 8379.40 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.68it/s, est. speed input: 2613.86 toks/s, output: 367.64 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 27.56it/s, est. speed input: 9538.35 toks/s, output: 1371.49 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 35.68it/s, est. speed input: 12219.15 toks/s, output: 1861.55 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.25it/s, est. speed input: 14232.89 toks/s, output: 2150.64 toks/s]
Processing batched inference:  47%|████▋     | 62/132 [02:15<01:56,  1.66s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.15it/s, est. speed input: 2026.10 toks/s, output: 293.84 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 29.25it/s, est. speed input: 9926.08 toks/s, output: 1422.78 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 34.77it/s, est. speed input: 11871.79 toks/s, output: 1783.31 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.55it/s, est. speed input: 10799.92 toks/s, output: 1704.64 toks/s]
Processing batched inference:  48%|████▊     | 63/132 [02:17<01:56,  1.69s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.75it/s, est. speed input: 1864.12 toks/s, output: 266.28 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 46.07it/s, est. speed input: 14868.88 toks/s, output: 2151.08 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.06it/s, est. speed input: 12201.28 toks/s, output: 1850.32 toks/s]
Processing batched inference:  48%|████▊     | 64/132 [02:18<01:50,  1.62s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 24.30it/s, est. speed input: 9552.58 toks/s, output: 1385.39 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 26.01it/s, est. speed input: 10095.79 toks/s, output: 1461.07 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 39.92it/s, est. speed input: 14091.28 toks/s, output: 2151.28 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.39it/s, est. speed input: 9193.95 toks/s, output: 1472.12 toks/s] 
Processing batched inference:  49%|████▉     | 65/132 [02:20<01:56,  1.73s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.00it/s, est. speed input: 1177.04 toks/s, output: 168.14 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 22.12it/s, est. speed input: 7009.95 toks/s, output: 1010.96 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 24.85it/s, est. speed input: 8387.07 toks/s, output: 1287.32 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.58it/s, est. speed input: 8877.08 toks/s, output: 1428.21 toks/s]
Processing batched inference:  50%|█████     | 66/132 [02:22<01:55,  1.75s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 36.62it/s, est. speed input: 14408.15 toks/s, output: 2102.08 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 55.46it/s, est. speed input: 20612.61 toks/s, output: 3020.41 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.50it/s, est. speed input: 16333.94 toks/s, output: 2388.93 toks/s]
Processing batched inference:  51%|█████     | 67/132 [02:24<01:55,  1.77s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 65.59it/s, est. speed input: 25781.83 toks/s, output: 3738.82 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 31.43it/s, est. speed input: 13380.41 toks/s, output: 1926.04 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.33it/s, est. speed input: 13080.13 toks/s, output: 1973.00 toks/s]
Processing batched inference:  52%|█████▏    | 68/132 [02:26<01:56,  1.83s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.79it/s, est. speed input: 1478.25 toks/s, output: 204.67 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 33.59it/s, est. speed input: 10637.18 toks/s, output: 1503.20 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 34.72it/s, est. speed input: 11743.05 toks/s, output: 1761.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.95it/s, est. speed input: 11743.05 toks/s, output: 1761.78 toks/s]
Processing batched inference:  52%|█████▏    | 69/132 [02:27<01:49,  1.74s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.62it/s, est. speed input: 1028.08 toks/s, output: 149.11 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 20.36it/s, est. speed input: 6370.81 toks/s, output: 917.03 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 28.46it/s, est. speed input: 8995.69 toks/s, output: 1364.20 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.90it/s, est. speed input: 8995.69 toks/s, output: 1364.20 toks/s]
Processing batched inference:  53%|█████▎    | 70/132 [02:29<01:45,  1.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.59it/s, est. speed input: 1010.13 toks/s, output: 139.86 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 28.10it/s, est. speed input: 9220.59 toks/s, output: 1403.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.62it/s, est. speed input: 9666.83 toks/s, output: 1532.61 toks/s]
Processing batched inference:  54%|█████▍    | 71/132 [02:30<01:40,  1.65s/it]Resource status after batch 70:
Open files: 0
Memory usage: 8886.00 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 27.11it/s, est. speed input: 10661.05 toks/s, output: 1550.79 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 34.17it/s, est. speed input: 12909.08 toks/s, output: 1858.18 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 31.02it/s, est. speed input: 12193.29 toks/s, output: 1755.18 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.19it/s, est. speed input: 11454.64 toks/s, output: 1729.38 toks/s]
Processing batched inference:  55%|█████▍    | 72/132 [02:32<01:42,  1.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.02it/s, est. speed input: 1175.92 toks/s, output: 162.81 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.31it/s, est. speed input: 15426.57 toks/s, output: 2218.47 toks/s]
Processing batched inference:  55%|█████▌    | 73/132 [02:34<01:36,  1.63s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.62it/s, est. speed input: 1414.43 toks/s, output: 198.95 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 25.80it/s, est. speed input: 8222.72 toks/s, output: 1174.64 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 27.51it/s, est. speed input: 9447.56 toks/s, output: 1427.38 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.02it/s, est. speed input: 9425.14 toks/s, output: 1495.26 toks/s]
Processing batched inference:  56%|█████▌    | 74/132 [02:35<01:35,  1.65s/it]ERROR 06-30 23:34:58 [core.py:387] EngineCore hit an exception: Traceback (most recent call last):
ERROR 06-30 23:34:58 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 68, in __getitem__
ERROR 06-30 23:34:58 [core.py:387]     return self.__data[key]
ERROR 06-30 23:34:58 [core.py:387]            ~~~~~~~~~~~^^^^^
ERROR 06-30 23:34:58 [core.py:387] KeyError: '482b884344b1b5c62507b19205547f3ab46fee03b8e442f1c81a13575db8c567'
ERROR 06-30 23:34:58 [core.py:387] 
ERROR 06-30 23:34:58 [core.py:387] During handling of the above exception, another exception occurred:
ERROR 06-30 23:34:58 [core.py:387] 
ERROR 06-30 23:34:58 [core.py:387] Traceback (most recent call last):
ERROR 06-30 23:34:58 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 380, in run_engine_core
ERROR 06-30 23:34:58 [core.py:387]     engine_core.run_busy_loop()
ERROR 06-30 23:34:58 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 400, in run_busy_loop
ERROR 06-30 23:34:58 [core.py:387]     self._process_input_queue()
ERROR 06-30 23:34:58 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 425, in _process_input_queue
ERROR 06-30 23:34:58 [core.py:387]     self._handle_client_request(*req)
ERROR 06-30 23:34:58 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 441, in _handle_client_request
ERROR 06-30 23:34:58 [core.py:387]     self.add_request(request)
ERROR 06-30 23:34:58 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 177, in add_request
ERROR 06-30 23:34:58 [core.py:387]     request.mm_inputs = self.mm_input_cache_server.get_and_update_p1(
ERROR 06-30 23:34:58 [core.py:387]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:34:58 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/mm_input_cache.py", line 76, in get_and_update_p1
ERROR 06-30 23:34:58 [core.py:387]     mm_input = self.mm_cache[mm_hash]
ERROR 06-30 23:34:58 [core.py:387]                ~~~~~~~~~~~~~^^^^^^^^^
ERROR 06-30 23:34:58 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 211, in __getitem__
ERROR 06-30 23:34:58 [core.py:387]     value = cache_getitem(self, key)
ERROR 06-30 23:34:58 [core.py:387]             ^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:34:58 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 70, in __getitem__
ERROR 06-30 23:34:58 [core.py:387]     return self.__missing__(key)
ERROR 06-30 23:34:58 [core.py:387]            ^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:34:58 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 97, in __missing__
ERROR 06-30 23:34:58 [core.py:387]     raise KeyError(key)
ERROR 06-30 23:34:58 [core.py:387] KeyError: '482b884344b1b5c62507b19205547f3ab46fee03b8e442f1c81a13575db8c567'
ERROR 06-30 23:34:58 [core.py:387] 
CRITICAL 06-30 23:34:58 [core_client.py:359] Got fatal signal from worker processes, shutting down. See stack trace above for root cause issue.
batch_inference.sh: line 23: 502465 Killed                  python scripts/vllm_infer_new.py --model_name_or_path "$ckpt" --dataset $EVAL_DATASET --template qwen2_vl --save_name "$save_path/generated_predictions.jsonl" --max_new_tokens 4096 --temperature 0.0 --top_p 1.0 --top_k -1 --repetition_penalty 1.0 --batch_size 16 --seed 42
Running inference on checkpoint: checkpoint-630
INFO 06-30 23:35:08 [__init__.py:239] Automatically detected platform cuda.
[INFO|training_args.py:2135] 2025-06-30 23:35:10,482 >> PyTorch: setting up devices
[INFO|training_args.py:1812] 2025-06-30 23:35:10,528 >> The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,545 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,545 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,545 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,545 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,546 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,546 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,546 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:35:10,934 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|image_processing_base.py:378] 2025-06-30 23:35:10,935 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630/preprocessor_config.json
[INFO|image_processing_base.py:378] 2025-06-30 23:35:10,940 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:35:10,946 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,947 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,947 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,947 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,947 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,947 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,947 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:10,947 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:35:11,323 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:35:11,324 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:35:11,520 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:35:11,963 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}

[INFO|configuration_utils.py:696] 2025-06-30 23:35:12,020 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630/config.json
[INFO|configuration_utils.py:696] 2025-06-30 23:35:12,020 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630/config.json
[INFO|configuration_utils.py:770] 2025-06-30 23:35:12,022 >> Model config Qwen2VLConfig {
  "architectures": [
    "Qwen2VLForConditionalGeneration"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "eos_token_id": 151645,
  "hidden_act": "silu",
  "hidden_size": 1536,
  "image_token_id": 151655,
  "initializer_range": 0.02,
  "intermediate_size": 8960,
  "max_position_embeddings": 32768,
  "max_window_layers": 28,
  "model_type": "qwen2_vl",
  "num_attention_heads": 12,
  "num_hidden_layers": 28,
  "num_key_value_heads": 2,
  "rms_norm_eps": 1e-06,
  "rope_scaling": {
    "mrope_section": [
      16,
      24,
      24
    ],
    "rope_type": "default",
    "type": "default"
  },
  "rope_theta": 1000000.0,
  "sliding_window": 32768,
  "text_config": {
    "architectures": [
      "Qwen2VLForConditionalGeneration"
    ],
    "attention_dropout": 0.0,
    "bos_token_id": 151643,
    "eos_token_id": 151645,
    "hidden_act": "silu",
    "hidden_size": 1536,
    "image_token_id": null,
    "initializer_range": 0.02,
    "intermediate_size": 8960,
    "max_position_embeddings": 32768,
    "max_window_layers": 28,
    "model_type": "qwen2_vl_text",
    "num_attention_heads": 12,
    "num_hidden_layers": 28,
    "num_key_value_heads": 2,
    "rms_norm_eps": 1e-06,
    "rope_scaling": {
      "mrope_section": [
        16,
        24,
        24
      ],
      "rope_type": "default",
      "type": "default"
    },
    "rope_theta": 1000000.0,
    "sliding_window": 32768,
    "tie_word_embeddings": true,
    "torch_dtype": "float32",
    "use_cache": false,
    "use_sliding_window": false,
    "video_token_id": null,
    "vision_end_token_id": 151653,
    "vision_start_token_id": 151652,
    "vision_token_id": 151654,
    "vocab_size": 151936
  },
  "torch_dtype": "bfloat16",
  "transformers_version": "4.52.4",
  "use_cache": false,
  "use_sliding_window": false,
  "video_token_id": 151656,
  "vision_config": {
    "depth": 32,
    "embed_dim": 1280,
    "hidden_act": "quick_gelu",
    "hidden_size": 1536,
    "in_channels": 3,
    "in_chans": 3,
    "initializer_range": 0.02,
    "mlp_ratio": 4,
    "model_type": "qwen2_vl",
    "num_heads": 16,
    "patch_size": 14,
    "spatial_merge_size": 2,
    "spatial_patch_size": 14,
    "temporal_patch_size": 2,
    "torch_dtype": "float32"
  },
  "vision_end_token_id": 151653,
  "vision_start_token_id": 151652,
  "vision_token_id": 151654,
  "vocab_size": 151936
}

INFO 06-30 23:35:23 [config.py:689] This model supports multiple tasks: {'embed', 'reward', 'score', 'generate', 'classify'}. Defaulting to 'generate'.
INFO 06-30 23:35:23 [config.py:1901] Chunked prefill is enabled with max_num_batched_tokens=8192.
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:24,555 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:24,555 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:24,555 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:24,555 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:24,555 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:24,555 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:35:24,555 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:35:24,915 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:1088] 2025-06-30 23:35:25,005 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630/generation_config.json
[INFO|configuration_utils.py:1135] 2025-06-30 23:35:25,005 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.01,
  "top_k": 1,
  "top_p": 0.001
}

WARNING 06-30 23:35:25 [utils.py:2304] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/getting_started/troubleshooting.html#python-multiprocessing for more information. Reason: CUDA is initialized
INFO 06-30 23:35:32 [__init__.py:239] Automatically detected platform cuda.
INFO 06-30 23:35:35 [core.py:61] Initializing a V1 LLM engine (v0.8.4) with config: model='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630', speculative_config=None, tokenizer='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=6144, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='auto', reasoning_backend=None), observability_config=ObservabilityConfig(show_hidden_metrics=False, otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=None, served_model_name=saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"level":3,"custom_ops":["none"],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output"],"use_inductor":true,"compile_sizes":[],"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[512,504,496,488,480,472,464,456,448,440,432,424,416,408,400,392,384,376,368,360,352,344,336,328,320,312,304,296,288,280,272,264,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":512}
WARNING 06-30 23:35:36 [utils.py:2444] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f8f0d9dce10>
INFO 06-30 23:35:36 [parallel_state.py:959] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0
INFO 06-30 23:35:36 [cuda.py:221] Using Flash Attention backend on V1 engine.
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:35:39 [gpu_model_runner.py:1276] Starting to load model saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630...
WARNING 06-30 23:35:39 [vision.py:93] Current `vllm-flash-attn` has a bug inside vision module, so we use xformers backend instead. You can run `pip install flash-attn` to use flash-attention backend.
INFO 06-30 23:35:40 [config.py:3466] cudagraph sizes specified by model runner [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 264, 272, 280, 288, 296, 304, 312, 320, 328, 336, 344, 352, 360, 368, 376, 384, 392, 400, 408, 416, 424, 432, 440, 448, 456, 464, 472, 480, 488, 496, 504, 512] is overridden by config [512, 384, 256, 128, 4, 2, 1, 392, 264, 136, 8, 400, 272, 144, 16, 408, 280, 152, 24, 416, 288, 160, 32, 424, 296, 168, 40, 432, 304, 176, 48, 440, 312, 184, 56, 448, 320, 192, 64, 456, 328, 200, 72, 464, 336, 208, 80, 472, 344, 216, 88, 120, 480, 352, 248, 224, 96, 488, 504, 360, 232, 104, 496, 368, 240, 112, 376]
WARNING 06-30 23:35:40 [topk_topp_sampler.py:69] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.13s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:07<00:00,  7.13s/it]

INFO 06-30 23:35:47 [loader.py:458] Loading weights took 7.33 seconds
INFO 06-30 23:35:47 [gpu_model_runner.py:1291] Model loading took 4.1513 GiB and 7.549355 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:35:48 [gpu_model_runner.py:1560] Encoder cache will be initialized with a budget of 16384 tokens, and profiled with 1 image items of the maximum feature size.
INFO 06-30 23:36:03 [backends.py:416] Using cache directory: /root/.cache/vllm/torch_compile_cache/700b140be9/rank_0_0 for vLLM's torch.compile
INFO 06-30 23:36:03 [backends.py:426] Dynamo bytecode transform time: 7.82 s
INFO 06-30 23:36:04 [backends.py:115] Directly load the compiled graph for shape None from the cache
INFO 06-30 23:36:11 [monitor.py:33] torch.compile takes 7.82 s in total
INFO 06-30 23:36:11 [kv_cache_utils.py:634] GPU KV cache size: 1,006,016 tokens
INFO 06-30 23:36:11 [kv_cache_utils.py:637] Maximum concurrency for 6,144 tokens per request: 163.74x
INFO 06-30 23:36:31 [gpu_model_runner.py:1626] Graph capturing finished in 20 secs, took 0.47 GiB
INFO 06-30 23:36:31 [core.py:163] init engine (profile, create kv cache, warmup model) took 44.07 seconds
Unused or unrecognized kwargs: return_tensors.
INFO 06-30 23:36:32 [core_client.py:435] Core engine process 0 ready.
[INFO|2025-06-30 23:36:32] llamafactory.data.loader:143 >> Loading dataset ./0_my_dataset/vindr/qwen2_vindr_input_test_len_2108.json...
training example:
input_ids:
[151644, 8948, 198, 2610, 525, 264, 10950, 17847, 13, 151645, 198, 151644, 872, 198, 151652, 151655, 151653, 198, 5598, 30618, 14697, 315, 364, 47, 811, 372, 8767, 269, 706, 6, 5671, 438, 4718, 3561, 510, 73594, 2236, 198, 9640, 4913, 58456, 62, 17, 67, 788, 508, 87, 16, 11, 379, 16, 11, 856, 17, 11, 379, 17, 1125, 330, 1502, 788, 330, 1502, 7115, 9338, 921, 73594, 151645, 198, 151644, 77091, 198]
inputs:
<|im_start|>system
You are a helpful assistant.<|im_end|>
<|im_start|>user
<|vision_start|><|image_pad|><|vision_end|>
Return bounding boxes of 'Pneumothorax' areas as JSON format:
```json
[
{"bbox_2d": [x1, y1, x2, y2], "label": "label"},
...
]
```<|im_end|>
<|im_start|>assistant

label_ids:
[27, 9217, 397, 9640, 220, 341, 262, 330, 58456, 62, 17, 67, 788, 2278, 414, 220, 16, 22, 20, 345, 414, 220, 17, 22, 24, 345, 414, 220, 18, 15, 17, 345, 414, 220, 21, 23, 16, 198, 262, 3211, 262, 330, 1502, 788, 330, 47, 811, 372, 8767, 269, 706, 698, 220, 456, 921, 522, 9217, 29, 151645, 198]
labels:
<answer>
[
  {
    "bbox_2d": [
      175,
      279,
      302,
      681
    ],
    "label": "Pneumothorax"
  }
]
</answer><|im_end|>

Current file descriptor limits: soft=8192, hard=8192
Initial resource status:
Open files: 0
Memory usage: 940.93 MB
Using effective batch size: 16
Processing batched inference:   0%|          | 0/132 [00:00<?, ?it/s][INFO|image_processing_base.py:378] 2025-06-30 23:36:34,228 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:36:34,228 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|image_processing_base.py:378] 2025-06-30 23:36:34,228 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630/preprocessor_config.json
[INFO|image_processing_base.py:433] 2025-06-30 23:36:34,229 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:36:34,229 >> loading file vocab.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:36:34,229 >> loading file merges.txt
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:36:34,229 >> loading file tokenizer.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:36:34,229 >> loading file added_tokens.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:36:34,229 >> loading file special_tokens_map.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:36:34,229 >> loading file tokenizer_config.json
[INFO|tokenization_utils_base.py:2021] 2025-06-30 23:36:34,230 >> loading file chat_template.jinja
[INFO|tokenization_utils_base.py:2299] 2025-06-30 23:36:35,052 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:627] 2025-06-30 23:36:35,052 >> loading configuration file saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630/video_preprocessor_config.json
[INFO|video_processing_utils.py:683] 2025-06-30 23:36:35,052 >> Video processor Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:990] 2025-06-30 23:36:35,547 >> Processor Qwen2VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: CachedQwen2TokenizerFast(name_or_path='saves/qwen2_vl-3b/vindr_sft_base/checkpoint-630', vocab_size=151643, model_max_length=32768, is_fast=True, padding_side='right', truncation_side='left', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "_valid_kwargs_names": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessor",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 12845056,
  "merge_size": 2,
  "min_pixels": 3136,
  "model_valid_processing_keys": [
    "do_convert_rgb",
    "do_resize",
    "size",
    "size_divisor",
    "default_to_square",
    "resample",
    "do_rescale",
    "rescale_factor",
    "do_normalize",
    "image_mean",
    "image_std",
    "do_pad",
    "do_center_crop",
    "crop_size",
    "data_format",
    "input_data_format",
    "device",
    "min_pixels",
    "max_pixels",
    "patch_size",
    "temporal_patch_size",
    "merge_size"
  ],
  "patch_size": 14,
  "processor_class": "Qwen2VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "size": {
    "longest_edge": 12845056,
    "shortest_edge": 3136
  },
  "size_divisor": null,
  "temporal_patch_size": 2,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2VLProcessor"
}


Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 79.54it/s, est. speed input: 31272.82 toks/s, output: 5249.86 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.43it/s, est. speed input: 17080.17 toks/s, output: 3149.31 toks/s]
Processing batched inference:   1%|          | 1/132 [00:04<09:59,  4.58s/it]Resource status after batch 0:
Open files: 0
Memory usage: 1070.79 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 95.00it/s, est. speed input: 37285.06 toks/s, output: 5716.09 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.86it/s, est. speed input: 9762.98 toks/s, output: 1707.39 toks/s] 
Processing batched inference:   2%|▏         | 2/132 [00:07<07:55,  3.66s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 64.53it/s, est. speed input: 25312.26 toks/s, output: 3930.15 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.40it/s, est. speed input: 15475.25 toks/s, output: 2588.59 toks/s]
Processing batched inference:   2%|▏         | 3/132 [00:10<06:53,  3.20s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 53.89it/s, est. speed input: 21171.53 toks/s, output: 3622.96 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 34.27it/s, est. speed input: 14400.02 toks/s, output: 2540.11 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.30it/s, est. speed input: 12685.98 toks/s, output: 2412.37 toks/s]
Processing batched inference:   3%|▎         | 4/132 [00:13<06:31,  3.06s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 73.52it/s, est. speed input: 28890.32 toks/s, output: 5133.29 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.93it/s, est. speed input: 11754.10 toks/s, output: 2319.70 toks/s]
Processing batched inference:   4%|▍         | 5/132 [00:15<06:12,  2.93s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 84.32it/s, est. speed input: 33181.04 toks/s, output: 6347.40 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 29.02it/s, est. speed input: 11409.47 toks/s, output: 2190.80 toks/s]
Processing batched inference:   5%|▍         | 6/132 [00:18<06:00,  2.86s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 88.76it/s, est. speed input: 34797.19 toks/s, output: 5636.32 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.68it/s, est. speed input: 12023.03 toks/s, output: 2147.95 toks/s]
Processing batched inference:   5%|▌         | 7/132 [00:21<05:46,  2.77s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 100.81it/s, est. speed input: 39607.10 toks/s, output: 6102.89 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.60it/s, est. speed input: 16742.03 toks/s, output: 2553.70 toks/s] 
Processing batched inference:   6%|▌         | 8/132 [00:23<05:30,  2.67s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 62.58it/s, est. speed input: 24560.38 toks/s, output: 3858.99 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.86it/s, est. speed input: 7550.23 toks/s, output: 1492.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.23it/s, est. speed input: 7550.23 toks/s, output: 1492.95 toks/s]
Processing batched inference:   7%|▋         | 9/132 [00:26<05:41,  2.77s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 98.13it/s, est. speed input: 38527.58 toks/s, output: 6918.78 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.29it/s, est. speed input: 9541.49 toks/s, output: 1879.71 toks/s] 
Processing batched inference:   8%|▊         | 10/132 [00:29<05:39,  2.78s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 81.21it/s, est. speed input: 31847.64 toks/s, output: 4909.88 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.62it/s, est. speed input: 13181.83 toks/s, output: 2372.74 toks/s]
Processing batched inference:   8%|▊         | 11/132 [00:31<05:24,  2.68s/it]Resource status after batch 10:
Open files: 0
Memory usage: 2793.85 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 45.04it/s, est. speed input: 17696.69 toks/s, output: 2555.32 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.48it/s, est. speed input: 14908.70 toks/s, output: 2361.30 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 37.95it/s, est. speed input: 14908.70 toks/s, output: 2361.30 toks/s]
Processing batched inference:   9%|▉         | 12/132 [00:34<05:17,  2.64s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 93.77it/s, est. speed input: 36827.27 toks/s, output: 6179.43 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 31.01it/s, est. speed input: 12179.67 toks/s, output: 2223.04 toks/s]
Processing batched inference:  10%|▉         | 13/132 [00:36<05:07,  2.58s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 100.32it/s, est. speed input: 39337.66 toks/s, output: 7061.14 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.35it/s, est. speed input: 16620.89 toks/s, output: 2882.55 toks/s] 
Processing batched inference:  11%|█         | 14/132 [00:39<05:11,  2.64s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 82.92it/s, est. speed input: 32571.36 toks/s, output: 5355.58 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.14it/s, est. speed input: 12624.37 toks/s, output: 2203.43 toks/s]
Processing batched inference:  11%|█▏        | 15/132 [00:42<05:04,  2.61s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 61.05it/s, est. speed input: 23994.73 toks/s, output: 4328.25 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.59it/s, est. speed input: 8088.67 toks/s, output: 1590.94 toks/s] 
Processing batched inference:  12%|█▏        | 16/132 [00:45<05:15,  2.72s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 79.72it/s, est. speed input: 31273.41 toks/s, output: 4932.61 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 39.35it/s, est. speed input: 16710.63 toks/s, output: 2637.71 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.56it/s, est. speed input: 16710.63 toks/s, output: 2637.71 toks/s]
Processing batched inference:  13%|█▎        | 17/132 [00:47<04:54,  2.56s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 21.53it/s, est. speed input: 8450.55 toks/s, output: 1214.54 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 22.47it/s, est. speed input: 8751.65 toks/s, output: 1791.46 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 17.57it/s, est. speed input: 7325.58 toks/s, output: 1498.98 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 15.96it/s, est. speed input: 6800.04 toks/s, output: 1519.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.15it/s, est. speed input: 6337.84 toks/s, output: 1530.68 toks/s]
Processing batched inference:  14%|█▎        | 18/132 [00:49<04:50,  2.55s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 72.47it/s, est. speed input: 28468.77 toks/s, output: 4413.93 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 42.55it/s, est. speed input: 16712.06 toks/s, output: 3034.35 toks/s]
Processing batched inference:  14%|█▍        | 19/132 [00:52<04:49,  2.57s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 21.78it/s, est. speed input: 8565.64 toks/s, output: 1236.02 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 21.33it/s, est. speed input: 8416.56 toks/s, output: 1516.88 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.70it/s, est. speed input: 9132.36 toks/s, output: 1587.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.26it/s, est. speed input: 9132.36 toks/s, output: 1587.70 toks/s]
Processing batched inference:  15%|█▌        | 20/132 [00:54<04:35,  2.46s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 84.81it/s, est. speed input: 33258.31 toks/s, output: 6352.49 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.28it/s, est. speed input: 9124.20 toks/s, output: 1984.85 toks/s] 
Processing batched inference:  16%|█▌        | 21/132 [00:57<04:48,  2.60s/it]Resource status after batch 20:
Open files: 0
Memory usage: 4323.63 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 88.23it/s, est. speed input: 34655.38 toks/s, output: 5775.37 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.59it/s, est. speed input: 17120.44 toks/s, output: 2988.99 toks/s]
Processing batched inference:  17%|█▋        | 22/132 [01:00<04:44,  2.58s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 72.63it/s, est. speed input: 28494.50 toks/s, output: 4384.43 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 36.01it/s, est. speed input: 14146.74 toks/s, output: 2475.88 toks/s]
Processing batched inference:  17%|█▋        | 23/132 [01:02<04:29,  2.47s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 54.12it/s, est. speed input: 21273.11 toks/s, output: 3085.08 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 27.12it/s, est. speed input: 11519.95 toks/s, output: 1790.41 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00,  8.67it/s, est. speed input: 4392.06 toks/s, output: 903.97 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 11.18it/s, est. speed input: 4392.06 toks/s, output: 903.97 toks/s]
Processing batched inference:  18%|█▊        | 24/132 [01:05<04:51,  2.70s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 28.02it/s, est. speed input: 11017.53 toks/s, output: 1602.65 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 26.76it/s, est. speed input: 10610.19 toks/s, output: 1707.01 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 25.76it/s, est. speed input: 10290.09 toks/s, output: 1804.43 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 17.45it/s, est. speed input: 7957.86 toks/s, output: 1480.58 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.43it/s, est. speed input: 8426.80 toks/s, output: 1612.99 toks/s]
Processing batched inference:  19%|█▉        | 25/132 [01:07<04:29,  2.52s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 61.70it/s, est. speed input: 24211.09 toks/s, output: 3833.01 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 33.04it/s, est. speed input: 14015.69 toks/s, output: 2129.98 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 38.05it/s, est. speed input: 14942.41 toks/s, output: 2264.33 toks/s]
Processing batched inference:  20%|█▉        | 26/132 [01:09<04:12,  2.38s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 33.25it/s, est. speed input: 13070.10 toks/s, output: 1895.47 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 21.91it/s, est. speed input: 9079.86 toks/s, output: 1460.81 toks/s] [A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 26.59it/s, est. speed input: 10266.89 toks/s, output: 1874.98 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 11.92it/s, est. speed input: 5916.60 toks/s, output: 1270.20 toks/s] [A
Processed prompts:  94%|█████████▍| 15/16 [00:19<00:00, 11.92it/s, est. speed input: 5916.60 toks/s, output: 1270.20 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.98s/it, est. speed input: 279.29 toks/s, output: 238.49 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.40s/it, est. speed input: 279.29 toks/s, output: 238.49 toks/s]
Processing batched inference:  20%|██        | 27/132 [01:33<15:28,  8.84s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 64.94it/s, est. speed input: 25475.43 toks/s, output: 4018.22 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 20.09it/s, est. speed input: 8857.80 toks/s, output: 1693.83 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:04<00:00,  3.48it/s, est. speed input: 1366.76 toks/s, output: 445.56 toks/s] 
Processing batched inference:  21%|██        | 28/132 [01:40<14:04,  8.12s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 24.80it/s, est. speed input: 9733.88 toks/s, output: 1401.08 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 31.67it/s, est. speed input: 11935.00 toks/s, output: 1885.15 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 28.32it/s, est. speed input: 11163.30 toks/s, output: 2165.31 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 21.21it/s, est. speed input: 9254.74 toks/s, output: 1922.25 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.91it/s, est. speed input: 9780.96 toks/s, output: 2147.00 toks/s]
Processing batched inference:  22%|██▏       | 29/132 [01:42<10:48,  6.29s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 50.78it/s, est. speed input: 19913.73 toks/s, output: 3103.36 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 24.63it/s, est. speed input: 10648.94 toks/s, output: 1869.18 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.02it/s, est. speed input: 9427.80 toks/s, output: 1711.66 toks/s] 
Processing batched inference:  23%|██▎       | 30/132 [01:44<08:40,  5.11s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 41.79it/s, est. speed input: 16440.17 toks/s, output: 2943.63 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 33.37it/s, est. speed input: 13585.70 toks/s, output: 2499.13 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.57it/s, est. speed input: 10424.39 toks/s, output: 1973.70 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.53it/s, est. speed input: 10424.39 toks/s, output: 1973.70 toks/s]
Processing batched inference:  23%|██▎       | 31/132 [01:46<07:10,  4.27s/it]Resource status after batch 30:
Open files: 0
Memory usage: 5609.09 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 76.78it/s, est. speed input: 30161.38 toks/s, output: 4348.03 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 41.26it/s, est. speed input: 17426.39 toks/s, output: 2793.45 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 44.32it/s, est. speed input: 17426.39 toks/s, output: 2793.45 toks/s]
Processing batched inference:  24%|██▍       | 32/132 [01:49<06:11,  3.71s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 28.71it/s, est. speed input: 11285.69 toks/s, output: 1625.25 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 17.39it/s, est. speed input: 7372.47 toks/s, output: 1056.19 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.39it/s, est. speed input: 8671.40 toks/s, output: 1318.73 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.06it/s, est. speed input: 8671.40 toks/s, output: 1318.73 toks/s]
Processing batched inference:  25%|██▌       | 33/132 [01:51<05:22,  3.26s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 71.28it/s, est. speed input: 27997.97 toks/s, output: 4341.98 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 43.52it/s, est. speed input: 17082.05 toks/s, output: 2836.94 toks/s]
Processing batched inference:  26%|██▌       | 34/132 [01:53<04:43,  2.89s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  7.29it/s, est. speed input: 2872.41 toks/s, output: 422.79 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 13.09it/s, est. speed input: 4768.45 toks/s, output: 695.03 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 15.78it/s, est. speed input: 5619.26 toks/s, output: 812.53 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 38.41it/s, est. speed input: 11399.35 toks/s, output: 1833.13 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.66it/s, est. speed input: 10069.00 toks/s, output: 1741.47 toks/s]
Processing batched inference:  27%|██▋       | 35/132 [01:55<04:15,  2.64s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 25.22it/s, est. speed input: 9898.12 toks/s, output: 1649.58 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 25.24it/s, est. speed input: 9901.74 toks/s, output: 1547.88 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 32.43it/s, est. speed input: 11829.74 toks/s, output: 2009.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.89it/s, est. speed input: 9776.41 toks/s, output: 1857.54 toks/s] 
Processing batched inference:  27%|██▋       | 36/132 [01:57<04:01,  2.52s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 68.58it/s, est. speed input: 26929.71 toks/s, output: 4303.54 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 32.73it/s, est. speed input: 14014.16 toks/s, output: 2236.02 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 37.14it/s, est. speed input: 14575.57 toks/s, output: 2312.33 toks/s]
Processing batched inference:  28%|██▊       | 37/132 [01:59<03:48,  2.40s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 44.71it/s, est. speed input: 17610.05 toks/s, output: 2584.27 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 42.53it/s, est. speed input: 16836.57 toks/s, output: 2444.58 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.83it/s, est. speed input: 9144.09 toks/s, output: 1613.38 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 23.25it/s, est. speed input: 9144.09 toks/s, output: 1613.38 toks/s]
Processing batched inference:  29%|██▉       | 38/132 [02:02<03:44,  2.39s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.19it/s, est. speed input: 2440.38 toks/s, output: 359.18 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01,  7.77it/s, est. speed input: 2942.95 toks/s, output: 426.80 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 37.51it/s, est. speed input: 11201.05 toks/s, output: 1617.83 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 27.80it/s, est. speed input: 9893.26 toks/s, output: 1599.04 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.60it/s, est. speed input: 10457.10 toks/s, output: 1762.20 toks/s]
Processing batched inference:  30%|██▉       | 39/132 [02:03<03:23,  2.19s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 35.92it/s, est. speed input: 14089.85 toks/s, output: 2020.33 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 24.63it/s, est. speed input: 10149.93 toks/s, output: 1615.59 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 32.00it/s, est. speed input: 12123.88 toks/s, output: 1865.89 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.55it/s, est. speed input: 6893.24 toks/s, output: 1309.53 toks/s] 
Processing batched inference:  30%|███       | 40/132 [02:06<03:26,  2.24s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 15.05it/s, est. speed input: 5901.55 toks/s, output: 843.00 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 29.11it/s, est. speed input: 10591.25 toks/s, output: 1532.70 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 35.26it/s, est. speed input: 12577.64 toks/s, output: 1815.05 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.39it/s, est. speed input: 8872.40 toks/s, output: 1409.28 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.59it/s, est. speed input: 8872.40 toks/s, output: 1409.28 toks/s]
Processing batched inference:  31%|███       | 41/132 [02:08<03:17,  2.17s/it]Resource status after batch 40:
Open files: 0
Memory usage: 6784.04 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 26.68it/s, est. speed input: 10504.40 toks/s, output: 1537.66 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 22.60it/s, est. speed input: 9181.38 toks/s, output: 1324.32 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 19.00it/s, est. speed input: 8053.22 toks/s, output: 1287.95 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.87it/s, est. speed input: 8584.91 toks/s, output: 1423.05 toks/s]
Processing batched inference:  32%|███▏      | 42/132 [02:10<03:24,  2.27s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 21.90it/s, est. speed input: 8608.44 toks/s, output: 1500.28 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 28.10it/s, est. speed input: 10628.30 toks/s, output: 1949.79 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 32.14it/s, est. speed input: 11937.04 toks/s, output: 2607.55 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.42it/s, est. speed input: 11937.04 toks/s, output: 2607.55 toks/s]
Processing batched inference:  33%|███▎      | 43/132 [02:13<03:25,  2.30s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:00, 18.80it/s, est. speed input: 7390.48 toks/s, output: 1071.74 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 24.39it/s, est. speed input: 9314.50 toks/s, output: 1354.26 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 26.12it/s, est. speed input: 9895.09 toks/s, output: 1581.54 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 30.48it/s, est. speed input: 11036.51 toks/s, output: 1913.15 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 25.00it/s, est. speed input: 9827.23 toks/s, output: 1950.10 toks/s] 
Processing batched inference:  33%|███▎      | 44/132 [02:15<03:21,  2.29s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  5.01it/s, est. speed input: 1965.14 toks/s, output: 280.71 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  7.46it/s, est. speed input: 2784.36 toks/s, output: 393.69 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 32.97it/s, est. speed input: 9649.46 toks/s, output: 1483.77 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.09it/s, est. speed input: 8285.45 toks/s, output: 1452.71 toks/s]
Processing batched inference:  34%|███▍      | 45/132 [02:17<03:15,  2.24s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.84it/s, est. speed input: 1892.77 toks/s, output: 266.23 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 43.38it/s, est. speed input: 13992.68 toks/s, output: 2015.49 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.20it/s, est. speed input: 9489.76 toks/s, output: 1560.93 toks/s] 
Processing batched inference:  35%|███▍      | 46/132 [02:19<03:04,  2.15s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.90it/s, est. speed input: 1132.59 toks/s, output: 156.81 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 21.35it/s, est. speed input: 7228.37 toks/s, output: 1106.96 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.91it/s, est. speed input: 8998.60 toks/s, output: 1639.86 toks/s]
Processing batched inference:  36%|███▌      | 47/132 [02:21<02:53,  2.04s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.19it/s, est. speed input: 1649.51 toks/s, output: 242.81 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  9.93it/s, est. speed input: 3426.74 toks/s, output: 492.01 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 19.82it/s, est. speed input: 6095.02 toks/s, output: 872.60 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 25.48it/s, est. speed input: 7842.63 toks/s, output: 1204.10 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 15.23it/s, est. speed input: 6090.81 toks/s, output: 1113.80 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:02<00:00,  6.90it/s, est. speed input: 2705.49 toks/s, output: 633.16 toks/s] 
Processing batched inference:  36%|███▋      | 48/132 [02:24<03:34,  2.55s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.91it/s, est. speed input: 1920.72 toks/s, output: 270.15 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01, 10.65it/s, est. speed input: 3741.29 toks/s, output: 537.17 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:01, 10.90it/s, est. speed input: 3971.08 toks/s, output: 570.75 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 26.04it/s, est. speed input: 7627.79 toks/s, output: 1178.71 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:01<00:00, 10.02it/s, est. speed input: 4409.83 toks/s, output: 845.99 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:06<00:00,  2.38it/s, est. speed input: 933.86 toks/s, output: 347.78 toks/s] 
Processing batched inference:  37%|███▋      | 49/132 [02:32<05:45,  4.16s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 28.39it/s, est. speed input: 11156.47 toks/s, output: 1618.00 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 29.09it/s, est. speed input: 11372.78 toks/s, output: 1643.23 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 36.91it/s, est. speed input: 13553.74 toks/s, output: 1959.43 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:15<00:00, 36.91it/s, est. speed input: 9388.94 toks/s, output: 1434.13 toks/s] [A
Processed prompts: 100%|██████████| 16/16 [00:22<00:00,  2.36s/it, est. speed input: 281.15 toks/s, output: 223.49 toks/s]  [AProcessed prompts: 100%|██████████| 16/16 [00:22<00:00,  1.40s/it, est. speed input: 281.15 toks/s, output: 223.49 toks/s]
Processing batched inference:  38%|███▊      | 50/132 [02:56<13:50, 10.13s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.50it/s, est. speed input: 1758.44 toks/s, output: 247.34 toks/s][A
Processed prompts:  69%|██████▉   | 11/16 [00:00<00:00, 37.20it/s, est. speed input: 12203.71 toks/s, output: 1772.35 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 33.71it/s, est. speed input: 12018.94 toks/s, output: 2026.68 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 30.55it/s, est. speed input: 12018.94 toks/s, output: 2026.68 toks/s]
Processing batched inference:  39%|███▊      | 51/132 [02:58<10:16,  7.61s/it]Resource status after batch 50:
Open files: 0
Memory usage: 7767.21 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:00, 21.03it/s, est. speed input: 8216.70 toks/s, output: 1149.68 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 19.48it/s, est. speed input: 7714.33 toks/s, output: 1093.09 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 30.65it/s, est. speed input: 10868.25 toks/s, output: 1566.04 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 15.29it/s, est. speed input: 6872.18 toks/s, output: 1205.83 toks/s] [AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.49it/s, est. speed input: 6872.18 toks/s, output: 1205.83 toks/s]
Processing batched inference:  39%|███▉      | 52/132 [03:01<08:10,  6.13s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:07,  2.09it/s, est. speed input: 822.02 toks/s, output: 121.00 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:02,  5.68it/s, est. speed input: 1903.32 toks/s, output: 274.67 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 20.20it/s, est. speed input: 5832.65 toks/s, output: 891.51 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 17.29it/s, est. speed input: 6786.58 toks/s, output: 1180.95 toks/s]
Processing batched inference:  40%|████      | 53/132 [03:03<06:25,  4.88s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.50it/s, est. speed input: 1774.58 toks/s, output: 261.21 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 20.14it/s, est. speed input: 6740.75 toks/s, output: 975.18 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 22.44it/s, est. speed input: 7642.03 toks/s, output: 1110.18 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 15.83it/s, est. speed input: 6305.10 toks/s, output: 1042.97 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.06it/s, est. speed input: 6305.10 toks/s, output: 1042.97 toks/s]
Processing batched inference:  41%|████      | 54/132 [03:05<05:15,  4.04s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:01, 12.38it/s, est. speed input: 4878.41 toks/s, output: 718.08 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:00, 12.39it/s, est. speed input: 4864.92 toks/s, output: 702.90 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 13.71it/s, est. speed input: 5239.60 toks/s, output: 761.82 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 21.06it/s, est. speed input: 7245.25 toks/s, output: 1175.10 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.32it/s, est. speed input: 7661.09 toks/s, output: 1391.24 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 19.51it/s, est. speed input: 7661.09 toks/s, output: 1391.24 toks/s]
Processing batched inference:  42%|████▏     | 55/132 [03:07<04:29,  3.50s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:01,  9.53it/s, est. speed input: 3746.88 toks/s, output: 543.37 toks/s][A
Processed prompts:  31%|███▏      | 5/16 [00:00<00:00, 20.53it/s, est. speed input: 7545.09 toks/s, output: 1267.05 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 44.91it/s, est. speed input: 14877.38 toks/s, output: 2264.49 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 27.44it/s, est. speed input: 10779.16 toks/s, output: 1715.02 toks/s]
Processing batched inference:  42%|████▏     | 56/132 [03:09<03:58,  3.14s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:08,  1.85it/s, est. speed input: 722.95 toks/s, output: 101.69 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 17.35it/s, est. speed input: 5632.08 toks/s, output: 868.94 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 11.72it/s, est. speed input: 4475.61 toks/s, output: 887.85 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 11.39it/s, est. speed input: 4475.61 toks/s, output: 887.85 toks/s]
Processing batched inference:  43%|████▎     | 57/132 [03:12<03:31,  2.82s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.39it/s, est. speed input: 1337.68 toks/s, output: 196.91 toks/s][A
Processed prompts:  19%|█▉        | 3/16 [00:00<00:01,  7.46it/s, est. speed input: 2615.20 toks/s, output: 377.40 toks/s][A
Processed prompts:  50%|█████     | 8/16 [00:00<00:00, 19.08it/s, est. speed input: 5630.42 toks/s, output: 813.54 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 24.27it/s, est. speed input: 7188.16 toks/s, output: 1099.89 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 13.80it/s, est. speed input: 5502.83 toks/s, output: 1050.48 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 14.00it/s, est. speed input: 5502.83 toks/s, output: 1050.48 toks/s]
Processing batched inference:  44%|████▍     | 58/132 [03:14<03:23,  2.75s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:02,  6.12it/s, est. speed input: 2392.52 toks/s, output: 336.51 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 26.20it/s, est. speed input: 8837.75 toks/s, output: 1271.58 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 30.12it/s, est. speed input: 10348.90 toks/s, output: 1493.81 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 31.75it/s, est. speed input: 11159.60 toks/s, output: 1774.25 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.17it/s, est. speed input: 10269.84 toks/s, output: 1693.30 toks/s]
Processing batched inference:  45%|████▍     | 59/132 [03:16<03:00,  2.47s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:07,  2.11it/s, est. speed input: 826.42 toks/s, output: 116.24 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 23.21it/s, est. speed input: 7604.64 toks/s, output: 1162.09 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 10.39it/s, est. speed input: 4083.14 toks/s, output: 740.37 toks/s] 
Processing batched inference:  45%|████▌     | 60/132 [03:18<02:58,  2.47s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.57it/s, est. speed input: 1013.92 toks/s, output: 149.25 toks/s][A
Processed prompts:  25%|██▌       | 4/16 [00:00<00:01,  9.68it/s, est. speed input: 3144.50 toks/s, output: 449.20 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 26.29it/s, est. speed input: 7868.54 toks/s, output: 1188.40 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.22it/s, est. speed input: 8323.88 toks/s, output: 1310.37 toks/s]
Processing batched inference:  46%|████▌     | 61/132 [03:20<02:37,  2.22s/it]Resource status after batch 60:
Open files: 0
Memory usage: 8405.22 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  4.34it/s, est. speed input: 1696.31 toks/s, output: 238.58 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 22.31it/s, est. speed input: 7433.97 toks/s, output: 1068.92 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 34.13it/s, est. speed input: 10799.71 toks/s, output: 1555.47 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.74it/s, est. speed input: 8533.06 toks/s, output: 1354.67 toks/s] 
Processing batched inference:  47%|████▋     | 62/132 [03:22<02:31,  2.17s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.74it/s, est. speed input: 1471.13 toks/s, output: 213.36 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 19.38it/s, est. speed input: 6290.21 toks/s, output: 903.15 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 30.63it/s, est. speed input: 9803.93 toks/s, output: 1480.92 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.67it/s, est. speed input: 10454.35 toks/s, output: 1725.14 toks/s]
Processing batched inference:  48%|████▊     | 63/132 [03:24<02:24,  2.09s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.94it/s, est. speed input: 1543.49 toks/s, output: 220.49 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 40.40it/s, est. speed input: 12876.43 toks/s, output: 1853.49 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.91it/s, est. speed input: 7428.75 toks/s, output: 1245.99 toks/s] 
Processing batched inference:  48%|████▊     | 64/132 [03:26<02:17,  2.02s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:03,  3.96it/s, est. speed input: 1552.78 toks/s, output: 221.81 toks/s][A
Processed prompts:  44%|████▍     | 7/16 [00:00<00:00, 21.75it/s, est. speed input: 7167.48 toks/s, output: 1039.49 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 31.29it/s, est. speed input: 10020.49 toks/s, output: 1541.58 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 16.27it/s, est. speed input: 6395.26 toks/s, output: 1171.45 toks/s] 
Processing batched inference:  49%|████▉     | 65/132 [03:28<02:21,  2.12s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.20it/s, est. speed input: 1256.02 toks/s, output: 179.42 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 33.53it/s, est. speed input: 10654.09 toks/s, output: 1543.28 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.06it/s, est. speed input: 8672.89 toks/s, output: 1524.97 toks/s] 
Processing batched inference:  50%|█████     | 66/132 [03:30<02:17,  2.09s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.06it/s, est. speed input: 1194.65 toks/s, output: 168.04 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:02,  5.08it/s, est. speed input: 1812.86 toks/s, output: 260.95 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 21.47it/s, est. speed input: 6557.85 toks/s, output: 1025.12 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:01<00:00, 16.76it/s, est. speed input: 5934.57 toks/s, output: 1145.05 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 15.08it/s, est. speed input: 5934.57 toks/s, output: 1145.05 toks/s]
Processing batched inference:  51%|█████     | 67/132 [03:33<02:22,  2.19s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.09it/s, est. speed input: 1207.04 toks/s, output: 169.77 toks/s][A
Processed prompts:  56%|█████▋    | 9/16 [00:00<00:00, 26.39it/s, est. speed input: 8282.17 toks/s, output: 1194.82 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 21.19it/s, est. speed input: 7636.05 toks/s, output: 1159.36 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 21.24it/s, est. speed input: 8333.03 toks/s, output: 1383.05 toks/s]
Processing batched inference:  52%|█████▏    | 68/132 [03:35<02:15,  2.12s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.84it/s, est. speed input: 1109.27 toks/s, output: 156.03 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 23.74it/s, est. speed input: 7864.71 toks/s, output: 1202.99 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 26.47it/s, est. speed input: 8782.36 toks/s, output: 1576.65 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 22.40it/s, est. speed input: 8782.36 toks/s, output: 1576.65 toks/s]
Processing batched inference:  52%|█████▏    | 69/132 [03:36<02:05,  1.99s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:04,  3.12it/s, est. speed input: 1225.33 toks/s, output: 177.70 toks/s][A
Processed prompts:  38%|███▊      | 6/16 [00:00<00:00, 14.21it/s, est. speed input: 4738.18 toks/s, output: 683.76 toks/s][A
Processed prompts: 100%|██████████| 16/16 [00:00<00:00, 24.62it/s, est. speed input: 8006.83 toks/s, output: 1395.18 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 20.38it/s, est. speed input: 8006.83 toks/s, output: 1395.18 toks/s]
Processing batched inference:  53%|█████▎    | 70/132 [03:38<02:01,  1.95s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:07,  1.90it/s, est. speed input: 740.29 toks/s, output: 102.50 toks/s][A
Processed prompts:  88%|████████▊ | 14/16 [00:00<00:00, 22.08it/s, est. speed input: 7057.54 toks/s, output: 1071.33 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 14.60it/s, est. speed input: 5732.33 toks/s, output: 1000.99 toks/s]
Processing batched inference:  54%|█████▍    | 71/132 [03:40<01:59,  1.96s/it]Resource status after batch 70:
Open files: 0
Memory usage: 8924.85 MB

Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:  12%|█▎        | 2/16 [00:00<00:02,  6.34it/s, est. speed input: 2490.25 toks/s, output: 358.45 toks/s][A
Processed prompts:  62%|██████▎   | 10/16 [00:00<00:00, 29.24it/s, est. speed input: 9424.19 toks/s, output: 1348.33 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 23.13it/s, est. speed input: 8509.25 toks/s, output: 1292.63 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 14.50it/s, est. speed input: 5691.83 toks/s, output: 996.22 toks/s] 
Processing batched inference:  55%|█████▍    | 72/132 [03:42<02:04,  2.07s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:05,  2.68it/s, est. speed input: 1043.40 toks/s, output: 144.46 toks/s][A
Processed prompts:  75%|███████▌  | 12/16 [00:00<00:00, 21.78it/s, est. speed input: 7251.52 toks/s, output: 1108.96 toks/s][A
Processed prompts:  94%|█████████▍| 15/16 [00:00<00:00, 15.93it/s, est. speed input: 6034.80 toks/s, output: 1111.19 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:01<00:00, 13.30it/s, est. speed input: 5219.94 toks/s, output: 1064.92 toks/s]
Processing batched inference:  55%|█████▌    | 73/132 [03:45<02:05,  2.12s/it]
Processed prompts:   0%|          | 0/16 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s][A
Processed prompts:   6%|▋         | 1/16 [00:00<00:08,  1.80it/s, est. speed input: 703.09 toks/s, output: 98.90 toks/s][A
Processed prompts:  81%|████████▏ | 13/16 [00:00<00:00, 19.35it/s, est. speed input: 6192.32 toks/s, output: 941.34 toks/s][AProcessed prompts: 100%|██████████| 16/16 [00:00<00:00, 18.27it/s, est. speed input: 7170.67 toks/s, output: 1246.11 toks/s]
Processing batched inference:  56%|█████▌    | 74/132 [03:46<01:54,  1.98s/it]ERROR 06-30 23:40:21 [core.py:387] EngineCore hit an exception: Traceback (most recent call last):
ERROR 06-30 23:40:21 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 68, in __getitem__
ERROR 06-30 23:40:21 [core.py:387]     return self.__data[key]
ERROR 06-30 23:40:21 [core.py:387]            ~~~~~~~~~~~^^^^^
ERROR 06-30 23:40:21 [core.py:387] KeyError: '4683e9b18e3829a699deac0c439a081e6d4e63ac3705d8f8a639932c27f12884'
ERROR 06-30 23:40:21 [core.py:387] 
ERROR 06-30 23:40:21 [core.py:387] During handling of the above exception, another exception occurred:
ERROR 06-30 23:40:21 [core.py:387] 
ERROR 06-30 23:40:21 [core.py:387] Traceback (most recent call last):
ERROR 06-30 23:40:21 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 380, in run_engine_core
ERROR 06-30 23:40:21 [core.py:387]     engine_core.run_busy_loop()
ERROR 06-30 23:40:21 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 400, in run_busy_loop
ERROR 06-30 23:40:21 [core.py:387]     self._process_input_queue()
ERROR 06-30 23:40:21 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 425, in _process_input_queue
ERROR 06-30 23:40:21 [core.py:387]     self._handle_client_request(*req)
ERROR 06-30 23:40:21 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 441, in _handle_client_request
ERROR 06-30 23:40:21 [core.py:387]     self.add_request(request)
ERROR 06-30 23:40:21 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/core.py", line 177, in add_request
ERROR 06-30 23:40:21 [core.py:387]     request.mm_inputs = self.mm_input_cache_server.get_and_update_p1(
ERROR 06-30 23:40:21 [core.py:387]                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:40:21 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/vllm/v1/engine/mm_input_cache.py", line 76, in get_and_update_p1
ERROR 06-30 23:40:21 [core.py:387]     mm_input = self.mm_cache[mm_hash]
ERROR 06-30 23:40:21 [core.py:387]                ~~~~~~~~~~~~~^^^^^^^^^
ERROR 06-30 23:40:21 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 211, in __getitem__
ERROR 06-30 23:40:21 [core.py:387]     value = cache_getitem(self, key)
ERROR 06-30 23:40:21 [core.py:387]             ^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:40:21 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 70, in __getitem__
ERROR 06-30 23:40:21 [core.py:387]     return self.__missing__(key)
ERROR 06-30 23:40:21 [core.py:387]            ^^^^^^^^^^^^^^^^^^^^^
ERROR 06-30 23:40:21 [core.py:387]   File "/root/miniconda3/envs/llamafactory/lib/python3.11/site-packages/cachetools/__init__.py", line 97, in __missing__
ERROR 06-30 23:40:21 [core.py:387]     raise KeyError(key)
ERROR 06-30 23:40:21 [core.py:387] KeyError: '4683e9b18e3829a699deac0c439a081e6d4e63ac3705d8f8a639932c27f12884'
ERROR 06-30 23:40:21 [core.py:387] 
CRITICAL 06-30 23:40:21 [core_client.py:359] Got fatal signal from worker processes, shutting down. See stack trace above for root cause issue.
batch_inference.sh: line 23: 506819 Killed                  python scripts/vllm_infer_new.py --model_name_or_path "$ckpt" --dataset $EVAL_DATASET --template qwen2_vl --save_name "$save_path/generated_predictions.jsonl" --max_new_tokens 4096 --temperature 0.0 --top_p 1.0 --top_k -1 --repetition_penalty 1.0 --batch_size 16 --seed 42
